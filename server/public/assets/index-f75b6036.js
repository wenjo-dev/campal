(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();const app="";function noop(){}function assign(o,t){for(const e in t)o[e]=t[e];return o}function is_promise(o){return!!o&&(typeof o=="object"||typeof o=="function")&&typeof o.then=="function"}function run(o){return o()}function blank_object(){return Object.create(null)}function run_all(o){o.forEach(run)}function is_function(o){return typeof o=="function"}function safe_not_equal(o,t){return o!=o?t==t:o!==t||o&&typeof o=="object"||typeof o=="function"}let src_url_equal_anchor;function src_url_equal(o,t){return src_url_equal_anchor||(src_url_equal_anchor=document.createElement("a")),src_url_equal_anchor.href=t,o===src_url_equal_anchor.href}function is_empty(o){return Object.keys(o).length===0}function subscribe(o,...t){if(o==null)return noop;const e=o.subscribe(...t);return e.unsubscribe?()=>e.unsubscribe():e}function get_store_value(o){let t;return subscribe(o,e=>t=e)(),t}function component_subscribe(o,t,e){o.$$.on_destroy.push(subscribe(t,e))}function create_slot(o,t,e,i){if(o){const r=get_slot_context(o,t,e,i);return o[0](r)}}function get_slot_context(o,t,e,i){return o[1]&&i?assign(e.ctx.slice(),o[1](i(t))):e.ctx}function get_slot_changes(o,t,e,i){if(o[2]&&i){const r=o[2](i(e));if(t.dirty===void 0)return r;if(typeof r=="object"){const s=[],c=Math.max(t.dirty.length,r.length);for(let a=0;a<c;a+=1)s[a]=t.dirty[a]|r[a];return s}return t.dirty|r}return t.dirty}function update_slot_base(o,t,e,i,r,s){if(r){const c=get_slot_context(t,e,i,s);o.p(c,r)}}function get_all_dirty_from_scope(o){if(o.ctx.length>32){const t=[],e=o.ctx.length/32;for(let i=0;i<e;i++)t[i]=-1;return t}return-1}function set_store_value(o,t,e){return o.set(e),t}function action_destroyer(o){return o&&is_function(o.destroy)?o.destroy:noop}const globals=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function append(o,t){o.appendChild(t)}function insert(o,t,e){o.insertBefore(t,e||null)}function detach(o){o.parentNode&&o.parentNode.removeChild(o)}function destroy_each(o,t){for(let e=0;e<o.length;e+=1)o[e]&&o[e].d(t)}function element(o){return document.createElement(o)}function svg_element(o){return document.createElementNS("http://www.w3.org/2000/svg",o)}function text(o){return document.createTextNode(o)}function space(){return text(" ")}function empty(){return text("")}function listen(o,t,e,i){return o.addEventListener(t,e,i),()=>o.removeEventListener(t,e,i)}function attr(o,t,e){e==null?o.removeAttribute(t):o.getAttribute(t)!==e&&o.setAttribute(t,e)}function children(o){return Array.from(o.childNodes)}function set_data(o,t){t=""+t,o.data!==t&&(o.data=t)}function set_input_value(o,t){o.value=t??""}function set_style(o,t,e,i){e==null?o.style.removeProperty(t):o.style.setProperty(t,e,i?"important":"")}function select_option(o,t,e){for(let i=0;i<o.options.length;i+=1){const r=o.options[i];if(r.__value===t){r.selected=!0;return}}(!e||t!==void 0)&&(o.selectedIndex=-1)}function select_value(o){const t=o.querySelector(":checked");return t&&t.__value}function custom_event(o,t,{bubbles:e=!1,cancelable:i=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(o,e,i,t),r}function construct_svelte_component(o,t){return new o(t)}let current_component;function set_current_component(o){current_component=o}function get_current_component(){if(!current_component)throw new Error("Function called outside component initialization");return current_component}function onMount(o){get_current_component().$$.on_mount.push(o)}function afterUpdate(o){get_current_component().$$.after_update.push(o)}function onDestroy(o){get_current_component().$$.on_destroy.push(o)}function createEventDispatcher(){const o=get_current_component();return(t,e,{cancelable:i=!1}={})=>{const r=o.$$.callbacks[t];if(r){const s=custom_event(t,e,{cancelable:i});return r.slice().forEach(c=>{c.call(o,s)}),!s.defaultPrevented}return!0}}function bubble(o,t){const e=o.$$.callbacks[t.type];e&&e.slice().forEach(i=>i.call(this,t))}const dirty_components=[],binding_callbacks=[];let render_callbacks=[];const flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush))}function tick(){return schedule_update(),resolved_promise}function add_render_callback(o){render_callbacks.push(o)}function add_flush_callback(o){flush_callbacks.push(o)}const seen_callbacks=new Set;let flushidx=0;function flush(){if(flushidx!==0)return;const o=current_component;do{try{for(;flushidx<dirty_components.length;){const t=dirty_components[flushidx];flushidx++,set_current_component(t),update(t.$$)}}catch(t){throw dirty_components.length=0,flushidx=0,t}for(set_current_component(null),dirty_components.length=0,flushidx=0;binding_callbacks.length;)binding_callbacks.pop()();for(let t=0;t<render_callbacks.length;t+=1){const e=render_callbacks[t];seen_callbacks.has(e)||(seen_callbacks.add(e),e())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,seen_callbacks.clear(),set_current_component(o)}function update(o){if(o.fragment!==null){o.update(),run_all(o.before_update);const t=o.dirty;o.dirty=[-1],o.fragment&&o.fragment.p(o.ctx,t),o.after_update.forEach(add_render_callback)}}function flush_render_callbacks(o){const t=[],e=[];render_callbacks.forEach(i=>o.indexOf(i)===-1?t.push(i):e.push(i)),e.forEach(i=>i()),render_callbacks=t}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(o,t){o&&o.i&&(outroing.delete(o),o.i(t))}function transition_out(o,t,e,i){if(o&&o.o){if(outroing.has(o))return;outroing.add(o),outros.c.push(()=>{outroing.delete(o),i&&(e&&o.d(1),i())}),o.o(t)}else i&&i()}function handle_promise(o,t){const e=t.token={};function i(r,s,c,a){if(t.token!==e)return;t.resolved=a;let u=t.ctx;c!==void 0&&(u=u.slice(),u[c]=a);const f=r&&(t.current=r)(u);let p=!1;t.block&&(t.blocks?t.blocks.forEach((d,m)=>{m!==s&&d&&(group_outros(),transition_out(d,1,1,()=>{t.blocks[m]===d&&(t.blocks[m]=null)}),check_outros())}):t.block.d(1),f.c(),transition_in(f,1),f.m(t.mount(),t.anchor),p=!0),t.block=f,t.blocks&&(t.blocks[s]=f),p&&flush()}if(is_promise(o)){const r=get_current_component();if(o.then(s=>{set_current_component(r),i(t.then,1,t.value,s),set_current_component(null)},s=>{if(set_current_component(r),i(t.catch,2,t.error,s),set_current_component(null),!t.hasCatch)throw s}),t.current!==t.pending)return i(t.pending,0),!0}else{if(t.current!==t.then)return i(t.then,1,t.value,o),!0;t.resolved=o}}function update_await_block_branch(o,t,e){const i=t.slice(),{resolved:r}=o;o.current===o.then&&(i[o.value]=r),o.current===o.catch&&(i[o.error]=r),o.block.p(i,e)}function destroy_block(o,t){o.d(1),t.delete(o.key)}function outro_and_destroy_block(o,t){transition_out(o,1,1,()=>{t.delete(o.key)})}function update_keyed_each(o,t,e,i,r,s,c,a,u,f,p,d){let m=o.length,g=s.length,h=m;const v={};for(;h--;)v[o[h].key]=h;const w=[],k=new Map,$=new Map,T=[];for(h=g;h--;){const S=d(r,s,h),M=e(S);let O=c.get(M);O?i&&T.push(()=>O.p(S,t)):(O=f(M,S),O.c()),k.set(M,w[h]=O),M in v&&$.set(M,Math.abs(h-v[M]))}const P=new Set,E=new Set;function x(S){transition_in(S,1),S.m(a,p),c.set(S.key,S),p=S.first,g--}for(;m&&g;){const S=w[g-1],M=o[m-1],O=S.key,q=M.key;S===M?(p=S.first,m--,g--):k.has(q)?!c.has(O)||P.has(O)?x(S):E.has(q)?m--:$.get(O)>$.get(q)?(E.add(O),x(S)):(P.add(q),m--):(u(M,c),m--)}for(;m--;){const S=o[m];k.has(S.key)||u(S,c)}for(;g;)x(w[g-1]);return run_all(T),w}function get_spread_update(o,t){const e={},i={},r={$$scope:1};let s=o.length;for(;s--;){const c=o[s],a=t[s];if(a){for(const u in c)u in a||(i[u]=1);for(const u in a)r[u]||(e[u]=a[u],r[u]=1);o[s]=a}else for(const u in c)r[u]=1}for(const c in i)c in e||(e[c]=void 0);return e}function get_spread_object(o){return typeof o=="object"&&o!==null?o:{}}function bind(o,t,e){const i=o.$$.props[t];i!==void 0&&(o.$$.bound[i]=e,e(o.$$.ctx[i]))}function create_component(o){o&&o.c()}function mount_component(o,t,e,i){const{fragment:r,after_update:s}=o.$$;r&&r.m(t,e),i||add_render_callback(()=>{const c=o.$$.on_mount.map(run).filter(is_function);o.$$.on_destroy?o.$$.on_destroy.push(...c):run_all(c),o.$$.on_mount=[]}),s.forEach(add_render_callback)}function destroy_component(o,t){const e=o.$$;e.fragment!==null&&(flush_render_callbacks(e.after_update),run_all(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function make_dirty(o,t){o.$$.dirty[0]===-1&&(dirty_components.push(o),schedule_update(),o.$$.dirty.fill(0)),o.$$.dirty[t/31|0]|=1<<t%31}function init(o,t,e,i,r,s,c,a=[-1]){const u=current_component;set_current_component(o);const f=o.$$={fragment:null,ctx:[],props:s,update:noop,not_equal:r,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(u?u.$$.context:[])),callbacks:blank_object(),dirty:a,skip_bound:!1,root:t.target||u.$$.root};c&&c(f.root);let p=!1;if(f.ctx=e?e(o,t.props||{},(d,m,...g)=>{const h=g.length?g[0]:m;return f.ctx&&r(f.ctx[d],f.ctx[d]=h)&&(!f.skip_bound&&f.bound[d]&&f.bound[d](h),p&&make_dirty(o,d)),m}):[],f.update(),p=!0,run_all(f.before_update),f.fragment=i?i(f.ctx):!1,t.target){if(t.hydrate){const d=children(t.target);f.fragment&&f.fragment.l(d),d.forEach(detach)}else f.fragment&&f.fragment.c();t.intro&&transition_in(o.$$.fragment),mount_component(o,t.target,t.anchor,t.customElement),flush()}set_current_component(u)}class SvelteComponent{$destroy(){destroy_component(this,1),this.$destroy=noop}$on(t,e){if(!is_function(e))return noop;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(e),()=>{const r=i.indexOf(e);r!==-1&&i.splice(r,1)}}$set(t){this.$$set&&!is_empty(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const subscriber_queue=[];function readable(o,t){return{subscribe:writable(o,t).subscribe}}function writable(o,t=noop){let e;const i=new Set;function r(a){if(safe_not_equal(o,a)&&(o=a,e)){const u=!subscriber_queue.length;for(const f of i)f[1](),subscriber_queue.push(f,o);if(u){for(let f=0;f<subscriber_queue.length;f+=2)subscriber_queue[f][0](subscriber_queue[f+1]);subscriber_queue.length=0}}}function s(a){r(a(o))}function c(a,u=noop){const f=[a,u];return i.add(f),i.size===1&&(e=t(r)||noop),a(o),()=>{i.delete(f),i.size===0&&e&&(e(),e=null)}}return{set:r,update:s,subscribe:c}}function derived(o,t,e){const i=!Array.isArray(o),r=i?[o]:o,s=t.length<2;return readable(e,c=>{let a=!1;const u=[];let f=0,p=noop;const d=()=>{if(f)return;p();const g=t(i?u[0]:u,c);s?c(g):p=is_function(g)?g:noop},m=r.map((g,h)=>subscribe(g,v=>{u[h]=v,f&=~(1<<h),a&&d()},()=>{f|=1<<h}));return a=!0,d(),function(){run_all(m),p(),a=!1}})}function parse(o,t){if(o instanceof RegExp)return{keys:!1,pattern:o};var e,i,r,s,c=[],a="",u=o.split("/");for(u[0]||u.shift();r=u.shift();)e=r[0],e==="*"?(c.push("wild"),a+="/(.*)"):e===":"?(i=r.indexOf("?",1),s=r.indexOf(".",1),c.push(r.substring(1,~i?i:~s?s:r.length)),a+=~i&&!~s?"(?:/([^/]+?))?":"/([^/]+?)",~s&&(a+=(~i?"?":"")+"\\"+r.substring(s))):a+="/"+r;return{keys:c,pattern:new RegExp("^"+a+(t?"(?=$|/)":"/?$"),"i")}}function create_else_block$e(o){let t,e,i;const r=[o[2]];var s=o[0];function c(a){let u={};for(let f=0;f<r.length;f+=1)u=assign(u,r[f]);return{props:u}}return s&&(t=construct_svelte_component(s,c()),t.$on("routeEvent",o[7])),{c(){t&&create_component(t.$$.fragment),e=empty()},m(a,u){t&&mount_component(t,a,u),insert(a,e,u),i=!0},p(a,u){const f=u&4?get_spread_update(r,[get_spread_object(a[2])]):{};if(u&1&&s!==(s=a[0])){if(t){group_outros();const p=t;transition_out(p.$$.fragment,1,0,()=>{destroy_component(p,1)}),check_outros()}s?(t=construct_svelte_component(s,c()),t.$on("routeEvent",a[7]),create_component(t.$$.fragment),transition_in(t.$$.fragment,1),mount_component(t,e.parentNode,e)):t=null}else s&&t.$set(f)},i(a){i||(t&&transition_in(t.$$.fragment,a),i=!0)},o(a){t&&transition_out(t.$$.fragment,a),i=!1},d(a){a&&detach(e),t&&destroy_component(t,a)}}}function create_if_block$s(o){let t,e,i;const r=[{params:o[1]},o[2]];var s=o[0];function c(a){let u={};for(let f=0;f<r.length;f+=1)u=assign(u,r[f]);return{props:u}}return s&&(t=construct_svelte_component(s,c()),t.$on("routeEvent",o[6])),{c(){t&&create_component(t.$$.fragment),e=empty()},m(a,u){t&&mount_component(t,a,u),insert(a,e,u),i=!0},p(a,u){const f=u&6?get_spread_update(r,[u&2&&{params:a[1]},u&4&&get_spread_object(a[2])]):{};if(u&1&&s!==(s=a[0])){if(t){group_outros();const p=t;transition_out(p.$$.fragment,1,0,()=>{destroy_component(p,1)}),check_outros()}s?(t=construct_svelte_component(s,c()),t.$on("routeEvent",a[6]),create_component(t.$$.fragment),transition_in(t.$$.fragment,1),mount_component(t,e.parentNode,e)):t=null}else s&&t.$set(f)},i(a){i||(t&&transition_in(t.$$.fragment,a),i=!0)},o(a){t&&transition_out(t.$$.fragment,a),i=!1},d(a){a&&detach(e),t&&destroy_component(t,a)}}}function create_fragment$C(o){let t,e,i,r;const s=[create_if_block$s,create_else_block$e],c=[];function a(u,f){return u[1]?0:1}return t=a(o),e=c[t]=s[t](o),{c(){e.c(),i=empty()},m(u,f){c[t].m(u,f),insert(u,i,f),r=!0},p(u,[f]){let p=t;t=a(u),t===p?c[t].p(u,f):(group_outros(),transition_out(c[p],1,1,()=>{c[p]=null}),check_outros(),e=c[t],e?e.p(u,f):(e=c[t]=s[t](u),e.c()),transition_in(e,1),e.m(i.parentNode,i))},i(u){r||(transition_in(e),r=!0)},o(u){transition_out(e),r=!1},d(u){c[t].d(u),u&&detach(i)}}}function getLocation(){const o=window.location.href.indexOf("#/");let t=o>-1?window.location.href.substr(o+1):"/";const e=t.indexOf("?");let i="";return e>-1&&(i=t.substr(e+1),t=t.substr(0,e)),{location:t,querystring:i}}const loc=readable(null,function(t){t(getLocation());const e=()=>{t(getLocation())};return window.addEventListener("hashchange",e,!1),function(){window.removeEventListener("hashchange",e,!1)}}),location=derived(loc,o=>o.location);derived(loc,o=>o.querystring);const params=writable(void 0);async function push(o){if(!o||o.length<1||o.charAt(0)!="/"&&o.indexOf("#/")!==0)throw Error("Invalid parameter location");await tick(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0),window.location.hash=(o.charAt(0)=="#"?"":"#")+o}async function replace(o){if(!o||o.length<1||o.charAt(0)!="/"&&o.indexOf("#/")!==0)throw Error("Invalid parameter location");await tick();const t=(o.charAt(0)=="#"?"":"#")+o;try{const e={...history.state};delete e.__svelte_spa_router_scrollX,delete e.__svelte_spa_router_scrollY,window.history.replaceState(e,void 0,t)}catch{console.warn("Caught exception while replacing the current page. If you're running this in the Svelte REPL, please note that the `replace` method might not work in this environment.")}window.dispatchEvent(new Event("hashchange"))}function restoreScroll(o){o?window.scrollTo(o.__svelte_spa_router_scrollX,o.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function instance$E(o,t,e){let{routes:i={}}=t,{prefix:r=""}=t,{restoreScrollState:s=!1}=t;class c{constructor(E,x){if(!x||typeof x!="function"&&(typeof x!="object"||x._sveltesparouter!==!0))throw Error("Invalid component object");if(!E||typeof E=="string"&&(E.length<1||E.charAt(0)!="/"&&E.charAt(0)!="*")||typeof E=="object"&&!(E instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:S,keys:M}=parse(E);this.path=E,typeof x=="object"&&x._sveltesparouter===!0?(this.component=x.component,this.conditions=x.conditions||[],this.userData=x.userData,this.props=x.props||{}):(this.component=()=>Promise.resolve(x),this.conditions=[],this.props={}),this._pattern=S,this._keys=M}match(E){if(r){if(typeof r=="string")if(E.startsWith(r))E=E.substr(r.length)||"/";else return null;else if(r instanceof RegExp){const O=E.match(r);if(O&&O[0])E=E.substr(O[0].length)||"/";else return null}}const x=this._pattern.exec(E);if(x===null)return null;if(this._keys===!1)return x;const S={};let M=0;for(;M<this._keys.length;){try{S[this._keys[M]]=decodeURIComponent(x[M+1]||"")||null}catch{S[this._keys[M]]=null}M++}return S}async checkConditions(E){for(let x=0;x<this.conditions.length;x++)if(!await this.conditions[x](E))return!1;return!0}}const a=[];i instanceof Map?i.forEach((P,E)=>{a.push(new c(E,P))}):Object.keys(i).forEach(P=>{a.push(new c(P,i[P]))});let u=null,f=null,p={};const d=createEventDispatcher();async function m(P,E){await tick(),d(P,E)}let g=null,h=null;s&&(h=P=>{P.state&&(P.state.__svelte_spa_router_scrollY||P.state.__svelte_spa_router_scrollX)?g=P.state:g=null},window.addEventListener("popstate",h),afterUpdate(()=>{restoreScroll(g)}));let v=null,w=null;const k=loc.subscribe(async P=>{v=P;let E=0;for(;E<a.length;){const x=a[E].match(P.location);if(!x){E++;continue}const S={route:a[E].path,location:P.location,querystring:P.querystring,userData:a[E].userData,params:x&&typeof x=="object"&&Object.keys(x).length?x:null};if(!await a[E].checkConditions(S)){e(0,u=null),w=null,m("conditionsFailed",S);return}m("routeLoading",Object.assign({},S));const M=a[E].component;if(w!=M){M.loading?(e(0,u=M.loading),w=M,e(1,f=M.loadingParams),e(2,p={}),m("routeLoaded",Object.assign({},S,{component:u,name:u.name,params:f}))):(e(0,u=null),w=null);const O=await M();if(P!=v)return;e(0,u=O&&O.default||O),w=M}x&&typeof x=="object"&&Object.keys(x).length?e(1,f=x):e(1,f=null),e(2,p=a[E].props),m("routeLoaded",Object.assign({},S,{component:u,name:u.name,params:f})).then(()=>{params.set(f)});return}e(0,u=null),w=null,params.set(void 0)});onDestroy(()=>{k(),h&&window.removeEventListener("popstate",h)});function $(P){bubble.call(this,o,P)}function T(P){bubble.call(this,o,P)}return o.$$set=P=>{"routes"in P&&e(3,i=P.routes),"prefix"in P&&e(4,r=P.prefix),"restoreScrollState"in P&&e(5,s=P.restoreScrollState)},o.$$.update=()=>{o.$$.dirty&32&&(history.scrollRestoration=s?"manual":"auto")},[u,f,p,i,r,s,$,T]}class Router extends SvelteComponent{constructor(t){super(),init(this,t,instance$E,create_fragment$C,safe_not_equal,{routes:3,prefix:4,restoreScrollState:5})}}function compare(o,t,e){let i=e?1:-1;return typeof o=="number"&&typeof t=="number"?(o<t?-1:t<o?1:0)*i:String(o).localeCompare(String(t))*i}async function request(o,t,e){let i={method:t?t.toUpperCase():"GET",credentials:"include",redirect:"follow"};return!t||!["POST","PUT"].includes(t.toUpperCase())?fetch("/api/"+o,i):fetch("/api/"+o,Object.assign(i,{cache:"no-cache",referrerPolicy:"no-referrer",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}))}async function bloburl(o,t){return await request(`file/preview/${o}/${t}`).then(e=>e.blob()).then(e=>URL.createObjectURL(e))}function timePickPresets(o){let t=new Date;t.setDate(t.getDate()+o),t.setHours(0,0,0,0),t=new Date(t.getTime()-t.getTimezoneOffset()*6e4),t=t.toISOString().slice(0,16);let e=new Date;return e=new Date(e.getTime()-e.getTimezoneOffset()*6e4),e=e.toISOString().slice(0,16),{preset:t,minimum:e}}function timeToShortLocaleISO(o){let t=new Date(o);return t=new Date(t.getTime()-t.getTimezoneOffset()*6e4),t.toISOString().slice(0,16)}function urlEncode(o){try{return encodeURIComponent(JSON.stringify(o))}catch{return""}}function urlDecode(o){try{return JSON.parse(decodeURIComponent(o))}catch{return null}}function getCurrentPage(){return get_store_value(location).split("/").filter(o=>o!="")[0]}function goToPage$1(o,t=!1){t?replace("/"+o):push("/"+o)}function disableDocScroll(){document.documentElement.style.overflow="hidden",document.body.scroll="no"}function enableDocScroll(){document.documentElement.style.overflow="auto",document.body.scroll="yes"}const stores={notify:writable({}),menus:{left:writable(!1),right:writable(!1),theme:writable(!1),download:writable(!1)},options:{download:writable(!1),downloadSelect:writable(!1),share:writable(!1),editShare:writable(!1),listView:writable(!1),excluded:writable(!1),changeView:writable(!1),sort:writable(!1)},pages:{folders:writable(!1),myshares:writable(!1),shared:writable(!1),admin:writable(!1)},selected:{files:writable([]),folders:writable([])},cache:{small:writable([]),medium:writable([]),large:writable([])}};function create_else_block$d(o){return{c:noop,m:noop,p:noop,d:noop}}function create_if_block$r(o){let t;function e(s,c){if(s[0]=="users")return create_if_block_1$l;if(s[0]=="user")return create_if_block_2$i;if(s[0]=="key")return create_if_block_3$e;if(s[0]=="theme")return create_if_block_4$d;if(s[0]=="check")return create_if_block_5$b;if(s[0]=="x")return create_if_block_6$7;if(s[0]=="adduser")return create_if_block_7$6;if(s[0]=="edit")return create_if_block_8$3;if(s[0]=="trash")return create_if_block_9$3;if(s[0]=="folder")return create_if_block_10$3;if(s[0]=="addfolder")return create_if_block_11$1;if(s[0]=="album")return create_if_block_12$1;if(s[0]=="back")return create_if_block_13;if(s[0]=="burger")return create_if_block_14;if(s[0]=="gear")return create_if_block_15;if(s[0]=="share")return create_if_block_16;if(s[0]=="share2")return create_if_block_17;if(s[0]=="pc")return create_if_block_18;if(s[0]=="logout")return create_if_block_19;if(s[0]=="multiselect")return create_if_block_20;if(s[0]=="video")return create_if_block_21;if(s[0]=="download")return create_if_block_22;if(s[0]=="sort")return create_if_block_23;if(s[0]=="dots")return create_if_block_24;if(s[0]=="filter")return create_if_block_25;if(s[0]=="list")return create_if_block_26;if(s[0]=="grid")return create_if_block_27;if(s[0]=="arrow_up")return create_if_block_28;if(s[0]=="arrow_down")return create_if_block_29;if(s[0]=="arrow_left")return create_if_block_30;if(s[0]=="arrow_right")return create_if_block_31;if(s[0]=="file")return create_if_block_32;if(s[0]=="house")return create_if_block_33;if(s[0]=="reload")return create_if_block_34;if(s[0]=="info")return create_if_block_35;if(s[0]=="play")return create_if_block_36;if(s[0]=="pause")return create_if_block_37;if(s[0]=="minimize")return create_if_block_38;if(s[0]=="maximize")return create_if_block_39;if(s[0]=="moon")return create_if_block_40;if(s[0]=="sun")return create_if_block_41;if(s[0]=="search")return create_if_block_42;if(s[0]=="plusfile")return create_if_block_43;if(s[0]=="plus")return create_if_block_44;if(s[0]=="dots_horizontal")return create_if_block_45;if(s[0]=="world")return create_if_block_46;if(s[0]=="calendar")return create_if_block_47;if(s[0]=="save")return create_if_block_48;if(s[0]=="clock")return create_if_block_49;if(s[0]=="emoji_sad")return create_if_block_50;if(s[0]=="camera")return create_if_block_51;if(s[0]=="database")return create_if_block_52}let i=e(o),r=i&&i(o);return{c(){t=svg_element("svg"),r&&r.c(),set_style(t,"width",o[1]*.25+"rem"),set_style(t,"height",o[1]*.25+"rem"),attr(t,"width","24"),attr(t,"height","24"),attr(t,"viewBox","0 0 24 24"),attr(t,"stroke-width","2"),attr(t,"stroke","currentColor"),attr(t,"fill","none"),attr(t,"stroke-linecap","round"),attr(t,"stroke-linejoin","round")},m(s,c){insert(s,t,c),r&&r.m(t,null)},p(s,c){i!==(i=e(s))&&(r&&r.d(1),r=i&&i(s),r&&(r.c(),r.m(t,null))),c&2&&set_style(t,"width",s[1]*.25+"rem"),c&2&&set_style(t,"height",s[1]*.25+"rem")},d(s){s&&detach(t),r&&r.d()}}}function create_if_block_52(o){let t,e,i;return{c(){t=svg_element("ellipse"),e=svg_element("path"),i=svg_element("path"),attr(t,"cx","12"),attr(t,"cy","5"),attr(t,"rx","9"),attr(t,"ry","3"),attr(e,"d","M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"),attr(i,"d","M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5")},m(r,s){insert(r,t,s),insert(r,e,s),insert(r,i,s)},d(r){r&&detach(t),r&&detach(e),r&&detach(i)}}}function create_if_block_51(o){let t,e;return{c(){t=svg_element("path"),e=svg_element("circle"),attr(t,"d","M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"),attr(e,"cx","12"),attr(e,"cy","13"),attr(e,"r","4")},m(i,r){insert(i,t,r),insert(i,e,r)},d(i){i&&detach(t),i&&detach(e)}}}function create_if_block_50(o){let t;return{c(){t=svg_element("path"),attr(t,"stroke-linecap","round"),attr(t,"stroke-linejoin","round"),attr(t,"stroke-width","2"),attr(t,"d","M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_49(o){let t;return{c(){t=svg_element("path"),attr(t,"stroke-linecap","round"),attr(t,"stroke-linejoin","round"),attr(t,"stroke-width","2"),attr(t,"d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_48(o){let t,e,i;return{c(){t=svg_element("path"),e=svg_element("polyline"),i=svg_element("polyline"),attr(t,"d","M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"),attr(e,"points","17 21 17 13 7 13 7 21"),attr(i,"points","7 3 7 8 15 8")},m(r,s){insert(r,t,s),insert(r,e,s),insert(r,i,s)},d(r){r&&detach(t),r&&detach(e),r&&detach(i)}}}function create_if_block_47(o){let t,e,i,r,s,c,a;return{c(){t=svg_element("path"),e=svg_element("rect"),i=svg_element("line"),r=svg_element("line"),s=svg_element("line"),c=svg_element("line"),a=svg_element("line"),attr(t,"stroke","none"),attr(t,"d","M0 0h24v24H0z"),attr(e,"x","4"),attr(e,"y","5"),attr(e,"width","16"),attr(e,"height","16"),attr(e,"rx","2"),attr(i,"x1","16"),attr(i,"y1","3"),attr(i,"x2","16"),attr(i,"y2","7"),attr(r,"x1","8"),attr(r,"y1","3"),attr(r,"x2","8"),attr(r,"y2","7"),attr(s,"x1","4"),attr(s,"y1","11"),attr(s,"x2","20"),attr(s,"y2","11"),attr(c,"x1","11"),attr(c,"y1","15"),attr(c,"x2","12"),attr(c,"y2","15"),attr(a,"x1","12"),attr(a,"y1","15"),attr(a,"x2","12"),attr(a,"y2","18")},m(u,f){insert(u,t,f),insert(u,e,f),insert(u,i,f),insert(u,r,f),insert(u,s,f),insert(u,c,f),insert(u,a,f)},d(u){u&&detach(t),u&&detach(e),u&&detach(i),u&&detach(r),u&&detach(s),u&&detach(c),u&&detach(a)}}}function create_if_block_46(o){let t,e,i,r,s,c;return{c(){t=svg_element("path"),e=svg_element("circle"),i=svg_element("line"),r=svg_element("line"),s=svg_element("path"),c=svg_element("path"),attr(t,"stroke","none"),attr(t,"d","M0 0h24v24H0z"),attr(e,"cx","12"),attr(e,"cy","12"),attr(e,"r","9"),attr(i,"x1","3.6"),attr(i,"y1","9"),attr(i,"x2","20.4"),attr(i,"y2","9"),attr(r,"x1","3.6"),attr(r,"y1","15"),attr(r,"x2","20.4"),attr(r,"y2","15"),attr(s,"d","M11.5 3a17 17 0 0 0 0 18"),attr(c,"d","M12.5 3a17 17 0 0 1 0 18")},m(a,u){insert(a,t,u),insert(a,e,u),insert(a,i,u),insert(a,r,u),insert(a,s,u),insert(a,c,u)},d(a){a&&detach(t),a&&detach(e),a&&detach(i),a&&detach(r),a&&detach(s),a&&detach(c)}}}function create_if_block_45(o){let t;return{c(){t=svg_element("path"),attr(t,"stroke-linecap","round"),attr(t,"stroke-linejoin","round"),attr(t,"stroke-width","2"),attr(t,"d","M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_44(o){let t,e,i;return{c(){t=svg_element("path"),e=svg_element("line"),i=svg_element("line"),attr(t,"stroke","none"),attr(t,"d","M0 0h24v24H0z"),attr(e,"x1","12"),attr(e,"y1","5"),attr(e,"x2","12"),attr(e,"y2","19"),attr(i,"x1","5"),attr(i,"y1","12"),attr(i,"x2","19"),attr(i,"y2","12")},m(r,s){insert(r,t,s),insert(r,e,s),insert(r,i,s)},d(r){r&&detach(t),r&&detach(e),r&&detach(i)}}}function create_if_block_43(o){let t,e,i,r,s;return{c(){t=svg_element("path"),e=svg_element("path"),i=svg_element("path"),r=svg_element("line"),s=svg_element("line"),attr(t,"stroke","none"),attr(t,"d","M0 0h24v24H0z"),attr(e,"d","M14 3v4a1 1 0 0 0 1 1h4"),attr(i,"d","M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"),attr(r,"x1","12"),attr(r,"y1","11"),attr(r,"x2","12"),attr(r,"y2","17"),attr(s,"x1","9"),attr(s,"y1","14"),attr(s,"x2","15"),attr(s,"y2","14")},m(c,a){insert(c,t,a),insert(c,e,a),insert(c,i,a),insert(c,r,a),insert(c,s,a)},d(c){c&&detach(t),c&&detach(e),c&&detach(i),c&&detach(r),c&&detach(s)}}}function create_if_block_42(o){let t;return{c(){t=svg_element("path"),attr(t,"stroke-linecap","round"),attr(t,"stroke-linejoin","round"),attr(t,"stroke-width","2"),attr(t,"d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_41(o){let t;return{c(){t=svg_element("path"),attr(t,"stroke-linecap","round"),attr(t,"stroke-linejoin","round"),attr(t,"stroke-width","2"),attr(t,"d","M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_40(o){let t;return{c(){t=svg_element("path"),attr(t,"d","M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_39(o){let t;return{c(){t=svg_element("path"),attr(t,"d","M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_38(o){let t;return{c(){t=svg_element("path"),attr(t,"d","M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_37(o){let t,e;return{c(){t=svg_element("rect"),e=svg_element("rect"),attr(t,"x","6"),attr(t,"y","4"),attr(t,"width","4"),attr(t,"height","16"),attr(e,"x","14"),attr(e,"y","4"),attr(e,"width","4"),attr(e,"height","16")},m(i,r){insert(i,t,r),insert(i,e,r)},d(i){i&&detach(t),i&&detach(e)}}}function create_if_block_36(o){let t;return{c(){t=svg_element("polygon"),attr(t,"points","5 3 19 12 5 21 5 3")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_35(o){let t;return{c(){t=svg_element("path"),attr(t,"stroke-linecap","round"),attr(t,"stroke-linejoin","round"),attr(t,"stroke-width","2"),attr(t,"d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_34(o){let t,e,i;return{c(){t=svg_element("path"),e=svg_element("path"),i=svg_element("path"),attr(t,"stroke","none"),attr(t,"d","M0 0h24v24H0z"),attr(e,"d","M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -5v5h5"),attr(i,"d","M4 13a8.1 8.1 0 0 0 15.5 2m.5 5v-5h-5")},m(r,s){insert(r,t,s),insert(r,e,s),insert(r,i,s)},d(r){r&&detach(t),r&&detach(e),r&&detach(i)}}}function create_if_block_33(o){let t;return{c(){t=svg_element("path"),attr(t,"stroke-linecap","round"),attr(t,"stroke-linejoin","round"),attr(t,"stroke-width","2"),attr(t,"d","M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_32(o){let t,e;return{c(){t=svg_element("path"),e=svg_element("polyline"),attr(t,"d","M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"),attr(e,"points","13 2 13 9 20 9")},m(i,r){insert(i,t,r),insert(i,e,r)},d(i){i&&detach(t),i&&detach(e)}}}function create_if_block_31(o){let t,e;return{c(){t=svg_element("polyline"),e=svg_element("line"),attr(t,"points","12 16 16 12 12 8"),attr(e,"x1","8"),attr(e,"y1","12"),attr(e,"x2","16"),attr(e,"y2","12")},m(i,r){insert(i,t,r),insert(i,e,r)},d(i){i&&detach(t),i&&detach(e)}}}function create_if_block_30(o){let t,e;return{c(){t=svg_element("polyline"),e=svg_element("line"),attr(t,"points","12 8 8 12 12 16"),attr(e,"x1","16"),attr(e,"y1","12"),attr(e,"x2","8"),attr(e,"y2","12")},m(i,r){insert(i,t,r),insert(i,e,r)},d(i){i&&detach(t),i&&detach(e)}}}function create_if_block_29(o){let t,e,i,r;return{c(){t=svg_element("path"),e=svg_element("line"),i=svg_element("line"),r=svg_element("line"),attr(t,"stroke","none"),attr(t,"d","M0 0h24v24H0z"),attr(e,"x1","12"),attr(e,"y1","5"),attr(e,"x2","12"),attr(e,"y2","19"),attr(i,"x1","18"),attr(i,"y1","13"),attr(i,"x2","12"),attr(i,"y2","19"),attr(r,"x1","6"),attr(r,"y1","13"),attr(r,"x2","12"),attr(r,"y2","19")},m(s,c){insert(s,t,c),insert(s,e,c),insert(s,i,c),insert(s,r,c)},d(s){s&&detach(t),s&&detach(e),s&&detach(i),s&&detach(r)}}}function create_if_block_28(o){let t,e,i,r;return{c(){t=svg_element("path"),e=svg_element("line"),i=svg_element("line"),r=svg_element("line"),attr(t,"stroke","none"),attr(t,"d","M0 0h24v24H0z"),attr(e,"x1","12"),attr(e,"y1","5"),attr(e,"x2","12"),attr(e,"y2","19"),attr(i,"x1","18"),attr(i,"y1","11"),attr(i,"x2","12"),attr(i,"y2","5"),attr(r,"x1","6"),attr(r,"y1","11"),attr(r,"x2","12"),attr(r,"y2","5")},m(s,c){insert(s,t,c),insert(s,e,c),insert(s,i,c),insert(s,r,c)},d(s){s&&detach(t),s&&detach(e),s&&detach(i),s&&detach(r)}}}function create_if_block_27(o){let t,e,i,r,s;return{c(){t=svg_element("path"),e=svg_element("rect"),i=svg_element("rect"),r=svg_element("rect"),s=svg_element("rect"),attr(t,"stroke","none"),attr(t,"d","M0 0h24v24H0z"),attr(e,"x","4"),attr(e,"y","4"),attr(e,"width","6"),attr(e,"height","6"),attr(e,"rx","1"),attr(i,"x","14"),attr(i,"y","4"),attr(i,"width","6"),attr(i,"height","6"),attr(i,"rx","1"),attr(r,"x","4"),attr(r,"y","14"),attr(r,"width","6"),attr(r,"height","6"),attr(r,"rx","1"),attr(s,"x","14"),attr(s,"y","14"),attr(s,"width","6"),attr(s,"height","6"),attr(s,"rx","1")},m(c,a){insert(c,t,a),insert(c,e,a),insert(c,i,a),insert(c,r,a),insert(c,s,a)},d(c){c&&detach(t),c&&detach(e),c&&detach(i),c&&detach(r),c&&detach(s)}}}function create_if_block_26(o){let t,e,i,r,s,c;return{c(){t=svg_element("line"),e=svg_element("line"),i=svg_element("line"),r=svg_element("line"),s=svg_element("line"),c=svg_element("line"),attr(t,"x1","8"),attr(t,"y1","6"),attr(t,"x2","21"),attr(t,"y2","6"),attr(e,"x1","8"),attr(e,"y1","12"),attr(e,"x2","21"),attr(e,"y2","12"),attr(i,"x1","8"),attr(i,"y1","18"),attr(i,"x2","21"),attr(i,"y2","18"),attr(r,"x1","3"),attr(r,"y1","6"),attr(r,"x2","3.01"),attr(r,"y2","6"),attr(s,"x1","3"),attr(s,"y1","12"),attr(s,"x2","3.01"),attr(s,"y2","12"),attr(c,"x1","3"),attr(c,"y1","18"),attr(c,"x2","3.01"),attr(c,"y2","18")},m(a,u){insert(a,t,u),insert(a,e,u),insert(a,i,u),insert(a,r,u),insert(a,s,u),insert(a,c,u)},d(a){a&&detach(t),a&&detach(e),a&&detach(i),a&&detach(r),a&&detach(s),a&&detach(c)}}}function create_if_block_25(o){let t;return{c(){t=svg_element("path"),attr(t,"stroke-linecap","round"),attr(t,"stroke-linejoin","round"),attr(t,"stroke-width","2"),attr(t,"d","M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_24(o){let t,e,i;return{c(){t=svg_element("circle"),e=svg_element("circle"),i=svg_element("circle"),attr(t,"cx","12"),attr(t,"cy","12"),attr(t,"r","1"),attr(e,"cx","19"),attr(e,"cy","12"),attr(e,"r","1"),attr(i,"cx","5"),attr(i,"cy","12"),attr(i,"r","1")},m(r,s){insert(r,t,s),insert(r,e,s),insert(r,i,s)},d(r){r&&detach(t),r&&detach(e),r&&detach(i)}}}function create_if_block_23(o){let t,e,i;return{c(){t=svg_element("path"),e=svg_element("path"),i=svg_element("path"),attr(t,"stroke","none"),attr(t,"d","M0 0h24v24H0z"),attr(e,"d","M3 9l4-4l4 4m-4 -4v14"),attr(i,"d","M21 15l-4 4l-4-4m4 4v-14")},m(r,s){insert(r,t,s),insert(r,e,s),insert(r,i,s)},d(r){r&&detach(t),r&&detach(e),r&&detach(i)}}}function create_if_block_22(o){let t,e,i;return{c(){t=svg_element("path"),e=svg_element("polyline"),i=svg_element("line"),attr(t,"d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"),attr(e,"points","7 10 12 15 17 10"),attr(i,"x1","12"),attr(i,"y1","15"),attr(i,"x2","12"),attr(i,"y2","3")},m(r,s){insert(r,t,s),insert(r,e,s),insert(r,i,s)},d(r){r&&detach(t),r&&detach(e),r&&detach(i)}}}function create_if_block_21(o){let t,e,i,r,s,c,a,u,f;return{c(){t=svg_element("path"),e=svg_element("rect"),i=svg_element("line"),r=svg_element("line"),s=svg_element("line"),c=svg_element("line"),a=svg_element("line"),u=svg_element("line"),f=svg_element("line"),attr(t,"stroke","none"),attr(t,"d","M0 0h24v24H0z"),attr(e,"x","4"),attr(e,"y","4"),attr(e,"width","16"),attr(e,"height","16"),attr(e,"rx","2"),attr(i,"x1","8"),attr(i,"y1","4"),attr(i,"x2","8"),attr(i,"y2","20"),attr(r,"x1","16"),attr(r,"y1","4"),attr(r,"x2","16"),attr(r,"y2","20"),attr(s,"x1","4"),attr(s,"y1","8"),attr(s,"x2","8"),attr(s,"y2","8"),attr(c,"x1","4"),attr(c,"y1","16"),attr(c,"x2","8"),attr(c,"y2","16"),attr(a,"x1","4"),attr(a,"y1","12"),attr(a,"x2","20"),attr(a,"y2","12"),attr(u,"x1","16"),attr(u,"y1","8"),attr(u,"x2","20"),attr(u,"y2","8"),attr(f,"x1","16"),attr(f,"y1","16"),attr(f,"x2","20"),attr(f,"y2","16")},m(p,d){insert(p,t,d),insert(p,e,d),insert(p,i,d),insert(p,r,d),insert(p,s,d),insert(p,c,d),insert(p,a,d),insert(p,u,d),insert(p,f,d)},d(p){p&&detach(t),p&&detach(e),p&&detach(i),p&&detach(r),p&&detach(s),p&&detach(c),p&&detach(a),p&&detach(u),p&&detach(f)}}}function create_if_block_20(o){let t;return{c(){t=svg_element("path"),attr(t,"stroke-linecap","round"),attr(t,"stroke-linejoin","round"),attr(t,"stroke-width","2"),attr(t,"d","M17 14v6m-3-3h6M6 10h2a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2zm10 0h2a2 2 0 002-2V6a2 2 0 00-2-2h-2a2 2 0 00-2 2v2a2 2 0 002 2zM6 20h2a2 2 0 002-2v-2a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2z")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_19(o){let t,e,i;return{c(){t=svg_element("path"),e=svg_element("path"),i=svg_element("path"),attr(t,"stroke","none"),attr(t,"d","M0 0h24v24H0z"),attr(e,"d","M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2"),attr(i,"d","M7 12h14l-3 -3m0 6l3 -3")},m(r,s){insert(r,t,s),insert(r,e,s),insert(r,i,s)},d(r){r&&detach(t),r&&detach(e),r&&detach(i)}}}function create_if_block_18(o){let t;return{c(){t=svg_element("path"),attr(t,"stroke-linecap","round"),attr(t,"stroke-linejoin","round"),attr(t,"stroke-width","2"),attr(t,"d","M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_17(o){let t,e,i;return{c(){t=svg_element("path"),e=svg_element("polyline"),i=svg_element("line"),attr(t,"d","M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"),attr(e,"points","16 6 12 2 8 6"),attr(i,"x1","12"),attr(i,"y1","2"),attr(i,"x2","12"),attr(i,"y2","15")},m(r,s){insert(r,t,s),insert(r,e,s),insert(r,i,s)},d(r){r&&detach(t),r&&detach(e),r&&detach(i)}}}function create_if_block_16(o){let t,e,i,r,s,c;return{c(){t=svg_element("path"),e=svg_element("circle"),i=svg_element("circle"),r=svg_element("circle"),s=svg_element("line"),c=svg_element("line"),attr(t,"stroke","none"),attr(t,"d","M0 0h24v24H0z"),attr(e,"cx","6"),attr(e,"cy","12"),attr(e,"r","3"),attr(i,"cx","18"),attr(i,"cy","6"),attr(i,"r","3"),attr(r,"cx","18"),attr(r,"cy","18"),attr(r,"r","3"),attr(s,"x1","8.7"),attr(s,"y1","10.7"),attr(s,"x2","15.3"),attr(s,"y2","7.3"),attr(c,"x1","8.7"),attr(c,"y1","13.3"),attr(c,"x2","15.3"),attr(c,"y2","16.7")},m(a,u){insert(a,t,u),insert(a,e,u),insert(a,i,u),insert(a,r,u),insert(a,s,u),insert(a,c,u)},d(a){a&&detach(t),a&&detach(e),a&&detach(i),a&&detach(r),a&&detach(s),a&&detach(c)}}}function create_if_block_15(o){let t,e;return{c(){t=svg_element("circle"),e=svg_element("path"),attr(t,"cx","12"),attr(t,"cy","12"),attr(t,"r","3"),attr(e,"d","M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z")},m(i,r){insert(i,t,r),insert(i,e,r)},d(i){i&&detach(t),i&&detach(e)}}}function create_if_block_14(o){let t,e,i;return{c(){t=svg_element("line"),e=svg_element("line"),i=svg_element("line"),attr(t,"x1","3"),attr(t,"y1","12"),attr(t,"x2","21"),attr(t,"y2","12"),attr(e,"x1","3"),attr(e,"y1","6"),attr(e,"x2","21"),attr(e,"y2","6"),attr(i,"x1","3"),attr(i,"y1","18"),attr(i,"x2","21"),attr(i,"y2","18")},m(r,s){insert(r,t,s),insert(r,e,s),insert(r,i,s)},d(r){r&&detach(t),r&&detach(e),r&&detach(i)}}}function create_if_block_13(o){let t,e;return{c(){t=svg_element("path"),e=svg_element("path"),attr(t,"stroke","none"),attr(t,"d","M0 0h24v24H0z"),attr(e,"d","M9 11l-4 4l4 4m-4 -4h11a4 4 0 0 0 0 -8h-1")},m(i,r){insert(i,t,r),insert(i,e,r)},d(i){i&&detach(t),i&&detach(e)}}}function create_if_block_12$1(o){let t,e,i,r,s;return{c(){t=svg_element("path"),e=svg_element("line"),i=svg_element("rect"),r=svg_element("path"),s=svg_element("path"),attr(t,"stroke","none"),attr(t,"d","M0 0h24v24H0z"),attr(e,"x1","15"),attr(e,"y1","8"),attr(e,"x2","15.01"),attr(e,"y2","8"),attr(i,"x","4"),attr(i,"y","4"),attr(i,"width","16"),attr(i,"height","16"),attr(i,"rx","3"),attr(r,"d","M4 15l4 -4a3 5 0 0 1 3 0l 5 5"),attr(s,"d","M14 14l1 -1a3 5 0 0 1 3 0l 2 2")},m(c,a){insert(c,t,a),insert(c,e,a),insert(c,i,a),insert(c,r,a),insert(c,s,a)},d(c){c&&detach(t),c&&detach(e),c&&detach(i),c&&detach(r),c&&detach(s)}}}function create_if_block_11$1(o){let t,e,i;return{c(){t=svg_element("path"),e=svg_element("line"),i=svg_element("line"),attr(t,"d","M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"),attr(e,"x1","12"),attr(e,"y1","11"),attr(e,"x2","12"),attr(e,"y2","17"),attr(i,"x1","9"),attr(i,"y1","14"),attr(i,"x2","15"),attr(i,"y2","14")},m(r,s){insert(r,t,s),insert(r,e,s),insert(r,i,s)},d(r){r&&detach(t),r&&detach(e),r&&detach(i)}}}function create_if_block_10$3(o){let t;return{c(){t=svg_element("path"),attr(t,"stroke-linecap","round"),attr(t,"stroke-linejoin","round"),attr(t,"stroke-width","2"),attr(t,"d","M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_9$3(o){let t,e,i,r;return{c(){t=svg_element("polyline"),e=svg_element("path"),i=svg_element("line"),r=svg_element("line"),attr(t,"points","3 6 5 6 21 6"),attr(e,"d","M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"),attr(i,"x1","10"),attr(i,"y1","11"),attr(i,"x2","10"),attr(i,"y2","17"),attr(r,"x1","14"),attr(r,"y1","11"),attr(r,"x2","14"),attr(r,"y2","17")},m(s,c){insert(s,t,c),insert(s,e,c),insert(s,i,c),insert(s,r,c)},d(s){s&&detach(t),s&&detach(e),s&&detach(i),s&&detach(r)}}}function create_if_block_8$3(o){let t,e;return{c(){t=svg_element("path"),e=svg_element("path"),attr(t,"d","M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"),attr(e,"d","M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z")},m(i,r){insert(i,t,r),insert(i,e,r)},d(i){i&&detach(t),i&&detach(e)}}}function create_if_block_7$6(o){let t,e,i,r;return{c(){t=svg_element("path"),e=svg_element("circle"),i=svg_element("line"),r=svg_element("line"),attr(t,"d","M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"),attr(e,"cx","8.5"),attr(e,"cy","7"),attr(e,"r","4"),attr(i,"x1","20"),attr(i,"y1","8"),attr(i,"x2","20"),attr(i,"y2","14"),attr(r,"x1","23"),attr(r,"y1","11"),attr(r,"x2","17"),attr(r,"y2","11")},m(s,c){insert(s,t,c),insert(s,e,c),insert(s,i,c),insert(s,r,c)},d(s){s&&detach(t),s&&detach(e),s&&detach(i),s&&detach(r)}}}function create_if_block_6$7(o){let t;return{c(){t=svg_element("path"),attr(t,"stroke-linecap","round"),attr(t,"stroke-linejoin","round"),attr(t,"stroke-width","2"),attr(t,"d","M6 18L18 6M6 6l12 12")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_5$b(o){let t;return{c(){t=svg_element("polyline"),attr(t,"points","20 6 9 17 4 12")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_4$d(o){let t;return{c(){t=svg_element("path"),attr(t,"stroke-linecap","round"),attr(t,"stroke-linejoin","round"),attr(t,"stroke-width","2"),attr(t,"d","M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_3$e(o){let t,e,i,r,s;return{c(){t=svg_element("path"),e=svg_element("circle"),i=svg_element("line"),r=svg_element("line"),s=svg_element("line"),attr(t,"stroke","none"),attr(t,"d","M0 0h24v24H0z"),attr(e,"cx","8"),attr(e,"cy","15"),attr(e,"r","4"),attr(i,"x1","10.85"),attr(i,"y1","12.15"),attr(i,"x2","19"),attr(i,"y2","4"),attr(r,"x1","18"),attr(r,"y1","5"),attr(r,"x2","20"),attr(r,"y2","7"),attr(s,"x1","15"),attr(s,"y1","8"),attr(s,"x2","17"),attr(s,"y2","10")},m(c,a){insert(c,t,a),insert(c,e,a),insert(c,i,a),insert(c,r,a),insert(c,s,a)},d(c){c&&detach(t),c&&detach(e),c&&detach(i),c&&detach(r),c&&detach(s)}}}function create_if_block_2$i(o){let t,e;return{c(){t=svg_element("path"),e=svg_element("circle"),attr(t,"d","M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"),attr(e,"cx","12"),attr(e,"cy","7"),attr(e,"r","4")},m(i,r){insert(i,t,r),insert(i,e,r)},d(i){i&&detach(t),i&&detach(e)}}}function create_if_block_1$l(o){let t,e,i,r,s;return{c(){t=svg_element("path"),e=svg_element("circle"),i=svg_element("path"),r=svg_element("path"),s=svg_element("path"),attr(t,"stroke","none"),attr(t,"d","M0 0h24v24H0z"),attr(e,"cx","9"),attr(e,"cy","7"),attr(e,"r","4"),attr(i,"d","M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"),attr(r,"d","M16 3.13a4 4 0 0 1 0 7.75"),attr(s,"d","M21 21v-2a4 4 0 0 0 -3 -3.85")},m(c,a){insert(c,t,a),insert(c,e,a),insert(c,i,a),insert(c,r,a),insert(c,s,a)},d(c){c&&detach(t),c&&detach(e),c&&detach(i),c&&detach(r),c&&detach(s)}}}function create_fragment$B(o){let t;function e(s,c){return s[2]?create_else_block$d:create_if_block$r}let i=e(o),r=i(o);return{c(){r.c(),t=empty()},m(s,c){r.m(s,c),insert(s,t,c)},p(s,[c]){i===(i=e(s))&&r?r.p(s,c):(r.d(1),r=i(s),r&&(r.c(),r.m(t.parentNode,t)))},i:noop,o:noop,d(s){r.d(s),s&&detach(t)}}}function instance$D(o,t,e){let{icon:i}=t,{size:r=5}=t,{custom:s=!1}=t;return o.$$set=c=>{"icon"in c&&e(0,i=c.icon),"size"in c&&e(1,r=c.size),"custom"in c&&e(2,s=c.custom)},[i,r,s]}class Icons extends SvelteComponent{constructor(t){super(),init(this,t,instance$D,create_fragment$B,safe_not_equal,{icon:0,size:1,custom:2})}}function create_fragment$A(o){let t,e,i,r,s,c,a,u,f,p,d;return s=new Icons({props:{icon:o[2]}}),u=new Icons({props:{icon:o[1]}}),{c(){t=element("label"),e=element("input"),i=space(),r=element("div"),create_component(s.$$.fragment),c=space(),a=element("div"),create_component(u.$$.fragment),e.disabled=o[3],attr(e,"type","checkbox"),attr(e,"class","hidden"),attr(r,"class","swap-off"),attr(a,"class","swap-on"),attr(t,"class","swap swap-rotate")},m(m,g){insert(m,t,g),append(t,e),e.checked=o[0],append(t,i),append(t,r),mount_component(s,r,null),append(t,c),append(t,a),mount_component(u,a,null),f=!0,p||(d=listen(e,"change",o[4]),p=!0)},p(m,[g]){(!f||g&8)&&(e.disabled=m[3]),g&1&&(e.checked=m[0]);const h={};g&4&&(h.icon=m[2]),s.$set(h);const v={};g&2&&(v.icon=m[1]),u.$set(v)},i(m){f||(transition_in(s.$$.fragment,m),transition_in(u.$$.fragment,m),f=!0)},o(m){transition_out(s.$$.fragment,m),transition_out(u.$$.fragment,m),f=!1},d(m){m&&detach(t),destroy_component(s),destroy_component(u),p=!1,d()}}}function instance$C(o,t,e){let{iconon:i,iconoff:r,bind:s,disabled:c}=t;function a(){s=this.checked,e(0,s)}return o.$$set=u=>{"iconon"in u&&e(1,i=u.iconon),"iconoff"in u&&e(2,r=u.iconoff),"bind"in u&&e(0,s=u.bind),"disabled"in u&&e(3,c=u.disabled)},[s,i,r,c,a]}class SwapLogo extends SvelteComponent{constructor(t){super(),init(this,t,instance$C,create_fragment$A,safe_not_equal,{iconon:1,iconoff:2,bind:0,disabled:3})}}function create_if_block$q(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v,w,k,$,T,P,E,x,S;function M(I){o[20](I)}let O={iconoff:"x",iconon:o[19](),disabled:!0};o[1]!==void 0&&(O.bind=o[1]),i=new SwapLogo({props:O}),binding_callbacks.push(()=>bind(i,"bind",M));let q=o[5]&&create_if_block_4$c(o),F=o[4]&&create_if_block_3$d(o),A=o[3]&&create_if_block_2$h(o);m=new Icons({props:{icon:"gear"}});let Z=o[2]&&create_if_block_1$k(o);return $=new Icons({props:{icon:"logout"}}),{c(){t=element("div"),e=element("button"),create_component(i.$$.fragment),s=space(),c=element("ul"),q&&q.c(),a=space(),F&&F.c(),u=space(),A&&A.c(),f=space(),p=element("li"),d=element("a"),create_component(m.$$.fragment),g=text(`
                Settings`),h=space(),Z&&Z.c(),v=space(),w=element("li"),k=element("a"),create_component($.$$.fragment),T=text(`
                Logout`),attr(e,"class","btn btn-ghost btn-circle"),attr(k,"class","text-error"),attr(c,"class",P=`p-2 shadow-xl menu menu-lg font-normal text-base bg-base-100 z-30 absolute right-0 top-20 rounded-box w-64 transition-transform ease-in-out duration-500 transform-gpu will-change-transform origin-top-right ${o[1]?"-rotate-180 -translate-y-20":"rotate-0 translate-y-0"}`),attr(t,"class","relative")},m(I,D){insert(I,t,D),append(t,e),mount_component(i,e,null),append(t,s),append(t,c),q&&q.m(c,null),append(c,a),F&&F.m(c,null),append(c,u),A&&A.m(c,null),append(c,f),append(c,p),append(p,d),mount_component(m,d,null),append(d,g),append(c,h),Z&&Z.m(c,null),append(c,v),append(c,w),append(w,k),mount_component($,k,null),append(k,T),E=!0,x||(S=[listen(e,"click",o[21]),listen(d,"click",o[25]),listen(k,"click",o[14])],x=!0)},p(I,D){const X={};D&1&&(X.iconon=I[19]()),!r&&D&2&&(r=!0,X.bind=I[1],add_flush_callback(()=>r=!1)),i.$set(X),I[5]?q?(q.p(I,D),D&32&&transition_in(q,1)):(q=create_if_block_4$c(I),q.c(),transition_in(q,1),q.m(c,a)):q&&(group_outros(),transition_out(q,1,1,()=>{q=null}),check_outros()),I[4]?F?(F.p(I,D),D&16&&transition_in(F,1)):(F=create_if_block_3$d(I),F.c(),transition_in(F,1),F.m(c,u)):F&&(group_outros(),transition_out(F,1,1,()=>{F=null}),check_outros()),I[3]?A?(A.p(I,D),D&8&&transition_in(A,1)):(A=create_if_block_2$h(I),A.c(),transition_in(A,1),A.m(c,f)):A&&(group_outros(),transition_out(A,1,1,()=>{A=null}),check_outros()),I[2]?Z?(Z.p(I,D),D&4&&transition_in(Z,1)):(Z=create_if_block_1$k(I),Z.c(),transition_in(Z,1),Z.m(c,v)):Z&&(group_outros(),transition_out(Z,1,1,()=>{Z=null}),check_outros()),(!E||D&2&&P!==(P=`p-2 shadow-xl menu menu-lg font-normal text-base bg-base-100 z-30 absolute right-0 top-20 rounded-box w-64 transition-transform ease-in-out duration-500 transform-gpu will-change-transform origin-top-right ${I[1]?"-rotate-180 -translate-y-20":"rotate-0 translate-y-0"}`))&&attr(c,"class",P)},i(I){E||(transition_in(i.$$.fragment,I),transition_in(q),transition_in(F),transition_in(A),transition_in(m.$$.fragment,I),transition_in(Z),transition_in($.$$.fragment,I),E=!0)},o(I){transition_out(i.$$.fragment,I),transition_out(q),transition_out(F),transition_out(A),transition_out(m.$$.fragment,I),transition_out(Z),transition_out($.$$.fragment,I),E=!1},d(I){I&&detach(t),destroy_component(i),q&&q.d(),F&&F.d(),A&&A.d(),destroy_component(m),Z&&Z.d(),destroy_component($),x=!1,run_all(S)}}}function create_if_block_4$c(o){let t,e,i,r,s,c,a;return i=new Icons({props:{icon:"folder"}}),{c(){t=element("li"),e=element("a"),create_component(i.$$.fragment),r=text(`
                Folders`)},m(u,f){insert(u,t,f),append(t,e),mount_component(i,e,null),append(e,r),s=!0,c||(a=listen(e,"click",o[22]),c=!0)},p:noop,i(u){s||(transition_in(i.$$.fragment,u),s=!0)},o(u){transition_out(i.$$.fragment,u),s=!1},d(u){u&&detach(t),destroy_component(i),c=!1,a()}}}function create_if_block_3$d(o){let t,e,i,r,s,c,a;return i=new Icons({props:{icon:"share2"}}),{c(){t=element("li"),e=element("a"),create_component(i.$$.fragment),r=text(`
                My Shares`)},m(u,f){insert(u,t,f),append(t,e),mount_component(i,e,null),append(e,r),s=!0,c||(a=listen(e,"click",o[23]),c=!0)},p:noop,i(u){s||(transition_in(i.$$.fragment,u),s=!0)},o(u){transition_out(i.$$.fragment,u),s=!1},d(u){u&&detach(t),destroy_component(i),c=!1,a()}}}function create_if_block_2$h(o){let t,e,i,r,s,c,a;return i=new Icons({props:{icon:"share"}}),{c(){t=element("li"),e=element("a"),create_component(i.$$.fragment),r=text(`
                Shared with me`)},m(u,f){insert(u,t,f),append(t,e),mount_component(i,e,null),append(e,r),s=!0,c||(a=listen(e,"click",o[24]),c=!0)},p:noop,i(u){s||(transition_in(i.$$.fragment,u),s=!0)},o(u){transition_out(i.$$.fragment,u),s=!1},d(u){u&&detach(t),destroy_component(i),c=!1,a()}}}function create_if_block_1$k(o){let t,e,i,r,s,c,a;return i=new Icons({props:{icon:"pc"}}),{c(){t=element("li"),e=element("a"),create_component(i.$$.fragment),r=text(`
                Admin`)},m(u,f){insert(u,t,f),append(t,e),mount_component(i,e,null),append(e,r),s=!0,c||(a=listen(e,"click",o[26]),c=!0)},p:noop,i(u){s||(transition_in(i.$$.fragment,u),s=!0)},o(u){transition_out(i.$$.fragment,u),s=!1},d(u){u&&detach(t),destroy_component(i),c=!1,a()}}}function create_fragment$z(o){let t=["folders","myshares","shared","settings","admin"].includes(o[0]),e,i,r=t&&create_if_block$q(o);return{c(){r&&r.c(),e=empty()},m(s,c){r&&r.m(s,c),insert(s,e,c),i=!0},p(s,[c]){c&1&&(t=["folders","myshares","shared","settings","admin"].includes(s[0])),t?r?(r.p(s,c),c&1&&transition_in(r,1)):(r=create_if_block$q(s),r.c(),transition_in(r,1),r.m(e.parentNode,e)):r&&(group_outros(),transition_out(r,1,1,()=>{r=null}),check_outros())},i(s){i||(transition_in(r),i=!0)},o(s){transition_out(r),i=!1},d(s){r&&r.d(s),s&&detach(e)}}}function instance$B(o,t,e){let i,r,s,c,a,u,f,p,d;component_subscribe(o,location,N=>e(18,r=N));const m=stores.notify;component_subscribe(o,m,N=>e(17,i=N));let g;const h=stores.menus.right;component_subscribe(o,h,N=>e(1,s=N));const v=stores.menus.left;component_subscribe(o,v,N=>e(28,a=N));const w=stores.menus.theme;component_subscribe(o,w,N=>e(27,c=N));const k=stores.pages.folders;component_subscribe(o,k,N=>e(5,d=N));const $=stores.pages.myshares;component_subscribe(o,$,N=>e(4,p=N));const T=stores.pages.shared;component_subscribe(o,T,N=>e(3,f=N));const P=stores.pages.admin;component_subscribe(o,P,N=>e(2,u=N));async function E(){(await request("user/logout")).ok&&goToPage$1("login",!0)}async function x(){await request("basedirs").then(async N=>{N.ok&&set_store_value(k,d=await N.json().then(W=>W.length>0),d)}),await request("shares").then(async N=>{N.ok&&await N.json().then(W=>{set_store_value($,p=W.my.length>0,p),set_store_value(T,f=W.shared.length>0,f)})}),await request("user").then(async N=>{N.ok&&set_store_value(P,u=await N.json().then(W=>W.admin),u)})}function S(){set_store_value(v,a=!1,a),set_store_value(w,c=!1,c)}function M(){setTimeout(()=>set_store_value(h,s=!0,s),50)}x(),set_store_value(h,s=!0,s);const O=()=>{switch(g){case"folders":return"folder";case"myshares":return"share2";case"shared":return"users";case"settings":return"gear";case"admin":return"pc"}};function q(N){s=N,h.set(s)}const F=()=>{set_store_value(h,s=!s,s),S()},A=()=>{goToPage$1("folders"),M()},Z=()=>{goToPage$1("myshares"),M()},I=()=>{goToPage$1("shared"),M()},D=()=>{goToPage$1("settings"),M()},X=()=>{goToPage$1("admin"),M()};return o.$$.update=()=>{o.$$.dirty&262144&&(e(0,g=getCurrentPage()),x()),o.$$.dirty&131072&&((i==null?void 0:i.kind)=="basedir"||(i==null?void 0:i.kind)=="share")&&x()},[g,s,u,f,p,d,m,h,v,w,k,$,T,P,E,S,M,i,r,O,q,F,A,Z,I,D,X]}class RightMenu extends SvelteComponent{constructor(t){super(),init(this,t,instance$B,create_fragment$z,safe_not_equal,{})}}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var themeChange={exports:{}};(function(o,t){function e(){var c=document.querySelector("[data-toggle-theme]"),a=c?c.getAttribute("data-key"):null;(function(u=localStorage.getItem(a||"theme")){localStorage.getItem(a||"theme")&&(document.documentElement.setAttribute("data-theme",u),c&&[...document.querySelectorAll("[data-toggle-theme]")].forEach(f=>{f.classList.add(c.getAttribute("data-act-class"))}))})(),c&&[...document.querySelectorAll("[data-toggle-theme]")].forEach(u=>{u.addEventListener("click",function(){var f=u.getAttribute("data-toggle-theme");if(f){var p=f.split(",");document.documentElement.getAttribute("data-theme")==p[0]?p.length==1?(document.documentElement.removeAttribute("data-theme"),localStorage.removeItem(a||"theme")):(document.documentElement.setAttribute("data-theme",p[1]),localStorage.setItem(a||"theme",p[1])):(document.documentElement.setAttribute("data-theme",p[0]),localStorage.setItem(a||"theme",p[0]))}[...document.querySelectorAll("[data-toggle-theme]")].forEach(d=>{d.classList.toggle(this.getAttribute("data-act-class"))})})})}function i(){var c=document.querySelector("[data-set-theme='']"),a=c?c.getAttribute("data-key"):null;(function(u=localStorage.getItem(a||"theme")){if(u!=null&&u!="")if(localStorage.getItem(a||"theme")&&localStorage.getItem(a||"theme")!=""){document.documentElement.setAttribute("data-theme",u);var f=document.querySelector("[data-set-theme='"+u.toString()+"']");f&&([...document.querySelectorAll("[data-set-theme]")].forEach(p=>{p.classList.remove(p.getAttribute("data-act-class"))}),f.getAttribute("data-act-class")&&f.classList.add(f.getAttribute("data-act-class")))}else{var f=document.querySelector("[data-set-theme='']");f.getAttribute("data-act-class")&&f.classList.add(f.getAttribute("data-act-class"))}})(),[...document.querySelectorAll("[data-set-theme]")].forEach(u=>{u.addEventListener("click",function(){document.documentElement.setAttribute("data-theme",this.getAttribute("data-set-theme")),localStorage.setItem(a||"theme",document.documentElement.getAttribute("data-theme")),[...document.querySelectorAll("[data-set-theme]")].forEach(f=>{f.classList.remove(f.getAttribute("data-act-class"))}),u.getAttribute("data-act-class")&&u.classList.add(u.getAttribute("data-act-class"))})})}function r(){var c=document.querySelector("select[data-choose-theme]"),a=c?c.getAttribute("data-key"):null;(function(u=localStorage.getItem(a||"theme")){if(localStorage.getItem(a||"theme")){document.documentElement.setAttribute("data-theme",u);var f=document.querySelector("select[data-choose-theme] [value='"+u.toString()+"']");f&&[...document.querySelectorAll("select[data-choose-theme] [value='"+u.toString()+"']")].forEach(p=>{p.selected=!0})}})(),c&&[...document.querySelectorAll("select[data-choose-theme]")].forEach(u=>{u.addEventListener("change",function(){document.documentElement.setAttribute("data-theme",this.value),localStorage.setItem(a||"theme",document.documentElement.getAttribute("data-theme")),[...document.querySelectorAll("select[data-choose-theme] [value='"+localStorage.getItem(a||"theme")+"']")].forEach(f=>{f.selected=!0})})})}function s(c=!0){c===!0?document.addEventListener("DOMContentLoaded",function(a){e(),r(),i()}):(e(),r(),i())}o.exports={themeChange:s}})(themeChange);var themeChangeExports=themeChange.exports;function get_each_context$c(o,t,e){const i=o.slice();return i[9]=t[e],i}function create_each_block$c(o){let t,e,i,r,s;return{c(){t=element("li"),e=element("button"),i=text(o[9]),attr(e,"data-set-theme",o[9]),attr(e,"data-act-class","ACTIVECLASS")},m(c,a){insert(c,t,a),append(t,e),append(e,i),r||(s=listen(e,"click",o[7]),r=!0)},p:noop,d(c){c&&detach(t),r=!1,s()}}}function create_fragment$y(o){let t,e,i,r,s,c,a,u,f;i=new Icons({props:{icon:"theme"}});let p=["auto light/dark","bumblebee","garden","pastel","retro","lofi","black","dracula","wireframe"],d=[];for(let m=0;m<9;m+=1)d[m]=create_each_block$c(get_each_context$c(o,p,m));return{c(){t=element("div"),e=element("button"),create_component(i.$$.fragment),r=space(),s=element("ul");for(let m=0;m<9;m+=1)d[m].c();attr(e,"class","btn btn-ghost btn-circle"),attr(s,"class",c=`p-2 shadow-xl menu menu-md bg-base-100 -z-10 absolute right-0 top-20 rounded-box w-52 transition-transform ease-in-out duration-500 transform-gpu will-change-transform origin-top ${o[0]?"scale-y-100":"scale-y-0"}`),attr(t,"class","relative")},m(m,g){insert(m,t,g),append(t,e),mount_component(i,e,null),append(t,r),append(t,s);for(let h=0;h<9;h+=1)d[h]&&d[h].m(s,null);a=!0,u||(f=listen(e,"click",o[6]),u=!0)},p(m,[g]){if(g&1){p=["auto light/dark","bumblebee","garden","pastel","retro","lofi","black","dracula","wireframe"];let h;for(h=0;h<9;h+=1){const v=get_each_context$c(m,p,h);d[h]?d[h].p(v,g):(d[h]=create_each_block$c(v),d[h].c(),d[h].m(s,null))}for(;h<9;h+=1)d[h].d(1)}(!a||g&1&&c!==(c=`p-2 shadow-xl menu menu-md bg-base-100 -z-10 absolute right-0 top-20 rounded-box w-52 transition-transform ease-in-out duration-500 transform-gpu will-change-transform origin-top ${m[0]?"scale-y-100":"scale-y-0"}`))&&attr(s,"class",c)},i(m){a||(transition_in(i.$$.fragment,m),a=!0)},o(m){transition_out(i.$$.fragment,m),a=!1},d(m){m&&detach(t),destroy_component(i),destroy_each(d,m),u=!1,f()}}}function instance$A(o,t,e){let i,r,s;onMount(()=>themeChangeExports.themeChange(!1));const c=stores.menus.theme;component_subscribe(o,c,m=>e(0,i=m));const a=stores.menus.right;component_subscribe(o,a,m=>e(1,r=m));const u=stores.menus.download;component_subscribe(o,u,m=>e(2,s=m)),set_store_value(c,i=!1,i);let f=!i;const p=()=>{set_store_value(c,i=!i,i),set_store_value(a,r=!0,r),set_store_value(u,s=!1,s)},d=()=>set_store_value(c,i=!1,i);return set_store_value(c,i=!f,i),[i,r,s,c,a,u,p,d]}class ThemeMenu extends SvelteComponent{constructor(t){super(),init(this,t,instance$A,create_fragment$y,safe_not_equal,{})}}function create_if_block_2$g(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v,w,k,$,T,P,E,x,S,M,O,q;return i=new Icons({props:{icon:"download"}}),a=new Icons({props:{icon:"download"}}),{c(){t=element("div"),e=element("button"),create_component(i.$$.fragment),r=space(),s=element("div"),c=element("button"),create_component(a.$$.fragment),u=text(`
                download`),f=space(),p=element("label"),d=element("span"),m=element("span"),g=text("all"),v=text(` / 
                        `),w=element("span"),k=text("selected"),T=space(),P=element("span"),P.textContent="files",E=space(),x=element("input"),attr(e,"class","btn btn-ghost btn-circle"),attr(c,"class","btn btn-secondary w-full"),attr(m,"class",h=o[1]?"opacity-50":"opacity-100"),attr(w,"class",$=o[1]?"opacity-100":"opacity-50"),attr(P,"class","opacity-50"),attr(d,"class","label-text text-xs font-semibold"),attr(x,"type","checkbox"),attr(x,"class","toggle ml-2"),attr(p,"class","label cursor-pointer w-full flex items-center justify-end"),attr(s,"class",S=`p-2 shadow-xl bg-base-100 -z-10 absolute left-0 top-20 rounded-box w-52 transition-transform ease-in-out duration-500 transform-gpu will-change-transform origin-top ${o[3]?"scale-y-100":"scale-y-0"}`),attr(t,"class","relative")},m(F,A){insert(F,t,A),append(t,e),mount_component(i,e,null),append(t,r),append(t,s),append(s,c),mount_component(a,c,null),append(c,u),append(s,f),append(s,p),append(p,d),append(d,m),append(m,g),append(d,v),append(d,w),append(w,k),append(d,T),append(d,P),append(p,E),append(p,x),x.checked=o[1],M=!0,O||(q=[listen(e,"click",o[20]),listen(c,"click",o[21]),listen(x,"change",o[22])],O=!0)},p(F,A){(!M||A&2&&h!==(h=F[1]?"opacity-50":"opacity-100"))&&attr(m,"class",h),(!M||A&2&&$!==($=F[1]?"opacity-100":"opacity-50"))&&attr(w,"class",$),A&2&&(x.checked=F[1]),(!M||A&8&&S!==(S=`p-2 shadow-xl bg-base-100 -z-10 absolute left-0 top-20 rounded-box w-52 transition-transform ease-in-out duration-500 transform-gpu will-change-transform origin-top ${F[3]?"scale-y-100":"scale-y-0"}`))&&attr(s,"class",S)},i(F){M||(transition_in(i.$$.fragment,F),transition_in(a.$$.fragment,F),M=!0)},o(F){transition_out(i.$$.fragment,F),transition_out(a.$$.fragment,F),M=!1},d(F){F&&detach(t),destroy_component(i),destroy_component(a),O=!1,run_all(q)}}}function create_if_block_1$j(o){let t,e,i,r,s;return e=new Icons({props:{icon:"share"}}),{c(){t=element("button"),create_component(e.$$.fragment),attr(t,"class","btn btn-ghost btn-circle")},m(c,a){insert(c,t,a),mount_component(e,t,null),i=!0,r||(s=listen(t,"click",o[23]),r=!0)},p:noop,i(c){i||(transition_in(e.$$.fragment,c),i=!0)},o(c){transition_out(e.$$.fragment,c),i=!1},d(c){c&&detach(t),destroy_component(e),r=!1,s()}}}function create_if_block$p(o){let t,e,i,r,s,c;function a(f){o[24](f)}let u={iconon:"grid",iconoff:"list",disabled:!0};return o[8]!==void 0&&(u.bind=o[8]),e=new SwapLogo({props:u}),binding_callbacks.push(()=>bind(e,"bind",a)),{c(){t=element("button"),create_component(e.$$.fragment),attr(t,"class","btn btn-ghost btn-circle")},m(f,p){insert(f,t,p),mount_component(e,t,null),r=!0,s||(c=listen(t,"click",o[25]),s=!0)},p(f,p){const d={};!i&&p&256&&(i=!0,d.bind=f[8],add_flush_callback(()=>i=!1)),e.$set(d)},i(f){r||(transition_in(e.$$.fragment,f),r=!0)},o(f){transition_out(e.$$.fragment,f),r=!1},d(f){f&&detach(t),destroy_component(e),s=!1,c()}}}function create_fragment$x(o){let t,e,i,r,s,c,a=o[2]&&create_if_block_2$g(o),u=o[6]&&create_if_block_1$j(o),f=o[7]&&create_if_block$p(o);return s=new ThemeMenu({}),{c(){t=element("div"),a&&a.c(),e=space(),u&&u.c(),i=space(),f&&f.c(),r=space(),create_component(s.$$.fragment),attr(t,"class","rounded-xl bg-base-200 p-2 flex items-center justify-center")},m(p,d){insert(p,t,d),a&&a.m(t,null),append(t,e),u&&u.m(t,null),append(t,i),f&&f.m(t,null),append(t,r),mount_component(s,t,null),c=!0},p(p,[d]){p[2]?a?(a.p(p,d),d&4&&transition_in(a,1)):(a=create_if_block_2$g(p),a.c(),transition_in(a,1),a.m(t,e)):a&&(group_outros(),transition_out(a,1,1,()=>{a=null}),check_outros()),p[6]?u?(u.p(p,d),d&64&&transition_in(u,1)):(u=create_if_block_1$j(p),u.c(),transition_in(u,1),u.m(t,i)):u&&(group_outros(),transition_out(u,1,1,()=>{u=null}),check_outros()),p[7]?f?(f.p(p,d),d&128&&transition_in(f,1)):(f=create_if_block$p(p),f.c(),transition_in(f,1),f.m(t,r)):f&&(group_outros(),transition_out(f,1,1,()=>{f=null}),check_outros())},i(p){c||(transition_in(a),transition_in(u),transition_in(f),transition_in(s.$$.fragment,p),c=!0)},o(p){transition_out(a),transition_out(u),transition_out(f),transition_out(s.$$.fragment,p),c=!1},d(p){p&&detach(t),a&&a.d(),u&&u.d(),f&&f.d(),destroy_component(s)}}}function instance$z(o,t,e){let i,r,s,c,a,u,f,p,d,m,g;component_subscribe(o,location,D=>e(19,s=D));const h=stores.menus.left;component_subscribe(o,h,D=>e(27,c=D));const v=stores.menus.right;component_subscribe(o,v,D=>e(5,p=D));const w=stores.menus.theme;component_subscribe(o,w,D=>e(4,f=D));const k=stores.menus.download;component_subscribe(o,k,D=>e(3,u=D));const $=stores.notify;component_subscribe(o,$,D=>e(0,r=D));const T=stores.options.listView;component_subscribe(o,T,D=>e(8,g=D));const P=stores.options.share;component_subscribe(o,P,D=>e(6,d=D));const E=stores.options.download;component_subscribe(o,E,D=>e(2,a=D));const x=stores.options.downloadSelect;component_subscribe(o,x,D=>e(1,i=D));const S=stores.options.changeView;component_subscribe(o,S,D=>e(7,m=D));function M(){setTimeout(()=>set_store_value(h,c=!1,c),50)}set_store_value(h,c=!1,c),set_store_value(x,i=!1,i);const O=()=>{set_store_value(k,u=!u,u),set_store_value(w,f=!1,f),set_store_value(v,p=!0,p)},q=()=>{setTimeout(()=>set_store_value(k,u=!1,u),50),set_store_value($,r={action:"download",kind:i?"selected":"all"},r)};function F(){i=this.checked,x.set(i)}const A=()=>{set_store_value($,r={action:"addShare"},r)};function Z(D){g=D,T.set(g)}const I=()=>{set_store_value(T,g=!g,g)};return o.$$.update=()=>{o.$$.dirty&524288&&getCurrentPage(),o.$$.dirty&1&&(r==null?void 0:r.action)=="download"&&(r==null?void 0:r.kind)=="start"&&(set_store_value(x,i=!1,i),M())},[r,i,a,u,f,p,d,m,g,h,v,w,k,$,T,P,E,x,S,s,O,q,F,A,Z,I]}class ToolMenu extends SvelteComponent{constructor(t){super(),init(this,t,instance$z,create_fragment$x,safe_not_equal,{})}}function create_fragment$w(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v,w,k,$,T,P,E;return u=new ToolMenu({}),h=new ToolMenu({}),k=new RightMenu({}),{c(){t=element("div"),e=element("div"),i=element("div"),r=element("a"),r.textContent="CP",s=space(),c=element("div"),a=element("div"),create_component(u.$$.fragment),f=space(),p=element("a"),p.textContent="CamPal",d=space(),m=element("div"),g=element("div"),create_component(h.$$.fragment),v=space(),w=element("div"),create_component(k.$$.fragment),attr(r,"class","text-lg font-bold cursor-pointer md:hidden ml-2 p-2 text-secondary"),attr(i,"class","flex items-center justify-start"),attr(a,"class","md:hidden"),attr(p,"class","text-xl font-bold cursor-pointer hidden md:flex"),attr(c,"class","flex justify-center items-center h-16"),attr(g,"class","hidden md:block"),attr(w,"class","ml-2"),attr(m,"class","flex items-center justify-end md:row-span-5"),attr(e,"class","grid grid-cols-3 w-full"),attr(t,"class",$=`sticky w-full -top-px z-30 p-2 touch-none bg-base-100 transition-all duration-500 ease-in-out ${o[0]?"shadow-xl":"shadow-none"} ${o[1]||!o[2]||o[3]?"opacity-100":"opacity-95"}`)},m(x,S){insert(x,t,S),append(t,e),append(e,i),append(i,r),append(e,s),append(e,c),append(c,a),mount_component(u,a,null),append(c,f),append(c,p),append(e,d),append(e,m),append(m,g),mount_component(h,g,null),append(m,v),append(m,w),mount_component(k,w,null),T=!0,P||(E=[listen(r,"click",o[8]),listen(p,"click",o[9])],P=!0)},p(x,[S]){(!T||S&15&&$!==($=`sticky w-full -top-px z-30 p-2 touch-none bg-base-100 transition-all duration-500 ease-in-out ${x[0]?"shadow-xl":"shadow-none"} ${x[1]||!x[2]||x[3]?"opacity-100":"opacity-95"}`))&&attr(t,"class",$)},i(x){T||(transition_in(u.$$.fragment,x),transition_in(h.$$.fragment,x),transition_in(k.$$.fragment,x),T=!0)},o(x){transition_out(u.$$.fragment,x),transition_out(h.$$.fragment,x),transition_out(k.$$.fragment,x),T=!1},d(x){x&&detach(t),destroy_component(u),destroy_component(h),destroy_component(k),P=!1,run_all(E)}}}function scrollToTop$4(){window.scrollTo({top:0,behavior:"smooth"})}function instance$y(o,t,e){let i,r,s,c;component_subscribe(o,location,g=>e(7,i=g));const a=stores.menus.download;component_subscribe(o,a,g=>e(1,r=g));const u=stores.menus.right;component_subscribe(o,u,g=>e(2,s=g));const f=stores.menus.theme;component_subscribe(o,f,g=>e(3,c=g));let p=!1;window.addEventListener("scroll",g=>{e(0,p=window.scrollY>100)});const d=()=>{set_store_value(a,r=!1,r),set_store_value(u,s=!0,s),scrollToTop$4()},m=()=>{set_store_value(a,r=!1,r),set_store_value(u,s=!0,s),scrollToTop$4()};return o.$$.update=()=>{o.$$.dirty&128&&getCurrentPage()},[p,r,s,c,a,u,f,i,d,m]}class Navbar extends SvelteComponent{constructor(t){super(),init(this,t,instance$y,create_fragment$w,safe_not_equal,{})}}function instance$x(o){return goToPage$1("login",!0),[]}class NotFound extends SvelteComponent{constructor(t){super(),init(this,t,instance$x,null,safe_not_equal,{})}}const get_default_slot_changes=o=>({intersecting:o&1,entry:o&2,observer:o&4}),get_default_slot_context=o=>({intersecting:o[0],entry:o[1],observer:o[2]});function create_fragment$v(o){let t;const e=o[9].default,i=create_slot(e,o,o[8],get_default_slot_context);return{c(){i&&i.c()},m(r,s){i&&i.m(r,s),t=!0},p(r,[s]){i&&i.p&&(!t||s&263)&&update_slot_base(i,e,r,r[8],t?get_slot_changes(e,r[8],s,get_default_slot_changes):get_all_dirty_from_scope(r[8]),get_default_slot_context)},i(r){t||(transition_in(i,r),t=!0)},o(r){transition_out(i,r),t=!1},d(r){i&&i.d(r)}}}function instance$w(o,t,e){let{$$slots:i={},$$scope:r}=t,{element:s=null}=t,{once:c=!1}=t,{intersecting:a=!1}=t,{root:u=null}=t,{rootMargin:f="0px"}=t,{threshold:p=0}=t,{entry:d=null}=t,{observer:m=null}=t;const g=createEventDispatcher();let h=null,v=null;const w=()=>{e(2,m=new IntersectionObserver(k=>{k.forEach($=>{e(1,d=$),e(0,a=$.isIntersecting)})},{root:u,rootMargin:f,threshold:p}))};return onMount(()=>(w(),()=>{m&&(m.disconnect(),e(2,m=null))})),afterUpdate(async()=>{d!==null&&(g("observe",d),d.isIntersecting&&(g("intersect",d),c&&m.unobserve(s))),await tick(),s!==null&&s!==v&&(m.observe(s),v!==null&&m.unobserve(v),v=s),h&&f!==h&&(m.disconnect(),v=null,w()),h=f}),o.$$set=k=>{"element"in k&&e(3,s=k.element),"once"in k&&e(4,c=k.once),"intersecting"in k&&e(0,a=k.intersecting),"root"in k&&e(5,u=k.root),"rootMargin"in k&&e(6,f=k.rootMargin),"threshold"in k&&e(7,p=k.threshold),"entry"in k&&e(1,d=k.entry),"observer"in k&&e(2,m=k.observer),"$$scope"in k&&e(8,r=k.$$scope)},[a,d,m,s,c,u,f,p,r,i]}class IntersectionObserver_1 extends SvelteComponent{constructor(t){super(),init(this,t,instance$w,create_fragment$v,safe_not_equal,{element:3,once:4,intersecting:0,root:5,rootMargin:6,threshold:7,entry:1,observer:2})}}function create_if_block_5$a(o){let t,e,i,r,s,c,a,u,f=o[0].name+"",p,d,m,g,h,v,w,k,$=o[1]=="file"&&o[0].type=="video"&&create_if_block_12();const T=[create_if_block_10$2,create_else_block_3$1],P=[];function E(O,q){return O[5]?1:0}s=E(o),c=P[s]=T[s](o);const x=[create_if_block_6$6,create_if_block_9$2],S=[];function M(O,q){return O[1]=="share"?0:O[1]=="file"?1:-1}return~(m=M(o))&&(g=S[m]=x[m](o)),{c(){t=element("tr"),e=element("td"),i=element("div"),$&&$.c(),r=space(),c.c(),a=space(),u=element("td"),p=text(f),d=space(),g&&g.c(),attr(i,"class","flex items-center justify-center h-16 w-16 rounded-lg shadow-lg relative overflow-hidden"),attr(e,"class","w-24"),attr(u,"class","font-bold"),attr(t,"class",h="transition-all ease-in-out md:hover:bg-base-200 "+(o[9]&&o[6]?"bg-error text-error-content":"")+" "+(o[8]&&o[6]?"bg-accent text-accent-content":""))},m(O,q){insert(O,t,q),append(t,e),append(e,i),$&&$.m(i,null),append(i,r),P[s].m(i,null),append(t,a),append(t,u),append(u,p),append(t,d),~m&&S[m].m(t,null),o[21](t),v=!0,w||(k=listen(t,"click",o[16]),w=!0)},p(O,q){O[1]=="file"&&O[0].type=="video"?$?q&3&&transition_in($,1):($=create_if_block_12(),$.c(),transition_in($,1),$.m(i,r)):$&&(group_outros(),transition_out($,1,1,()=>{$=null}),check_outros());let F=s;s=E(O),s===F?P[s].p(O,q):(group_outros(),transition_out(P[F],1,1,()=>{P[F]=null}),check_outros(),c=P[s],c?c.p(O,q):(c=P[s]=T[s](O),c.c()),transition_in(c,1),c.m(i,null)),(!v||q&1)&&f!==(f=O[0].name+"")&&set_data(p,f);let A=m;m=M(O),m===A?~m&&S[m].p(O,q):(g&&(group_outros(),transition_out(S[A],1,1,()=>{S[A]=null}),check_outros()),~m?(g=S[m],g?g.p(O,q):(g=S[m]=x[m](O),g.c()),transition_in(g,1),g.m(t,null)):g=null),(!v||q&832&&h!==(h="transition-all ease-in-out md:hover:bg-base-200 "+(O[9]&&O[6]?"bg-error text-error-content":"")+" "+(O[8]&&O[6]?"bg-accent text-accent-content":"")))&&attr(t,"class",h)},i(O){v||(transition_in($),transition_in(c),transition_in(g),v=!0)},o(O){transition_out($),transition_out(c),transition_out(g),v=!1},d(O){O&&detach(t),$&&$.d(),P[s].d(),~m&&S[m].d(),o[21](null),w=!1,k()}}}function create_if_block$o(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h;i=new Icons({props:{icon:o[9]?"x":"download",size:"12"}});const v=[create_if_block_3$c,create_if_block_4$b],w=[];function k(E,x){return E[1]=="share"||E[1]=="folder"?0:E[1]=="file"&&E[0].type=="video"?1:-1}~(c=k(o))&&(a=w[c]=v[c](o));const $=[create_if_block_1$i,create_else_block$c],T=[];function P(E,x){return E[5]?1:0}return p=P(o),d=T[p]=$[p](o),{c(){t=element("div"),e=element("div"),create_component(i.$$.fragment),s=space(),a&&a.c(),u=space(),f=element("div"),d.c(),attr(e,"class",r="w-full h-full flex items-center justify-center transition-all ease-in-out absolute z-10 "+(o[9]?"bg-error":o[8]?"bg-accent":"")+" "+(o[6]?"opacity-80":"opacity-0")),attr(f,"class","flex items-center justify-center h-full w-full -z-0"),attr(t,"class","transition-all ease-in-out duration-300 md:hover:scale-105 md:hover:z-10 card card-compact bg-base-100 shadow-xl aspect-square overflow-hidden m-1")},m(E,x){insert(E,t,x),append(t,e),mount_component(i,e,null),append(t,s),~c&&w[c].m(t,null),append(t,u),append(t,f),T[p].m(f,null),o[20](t),m=!0,g||(h=listen(t,"click",o[16]),g=!0)},p(E,x){const S={};x&512&&(S.icon=E[9]?"x":"download"),i.$set(S),(!m||x&832&&r!==(r="w-full h-full flex items-center justify-center transition-all ease-in-out absolute z-10 "+(E[9]?"bg-error":E[8]?"bg-accent":"")+" "+(E[6]?"opacity-80":"opacity-0")))&&attr(e,"class",r);let M=c;c=k(E),c===M?~c&&w[c].p(E,x):(a&&(group_outros(),transition_out(w[M],1,1,()=>{w[M]=null}),check_outros()),~c?(a=w[c],a?a.p(E,x):(a=w[c]=v[c](E),a.c()),transition_in(a,1),a.m(t,u)):a=null);let O=p;p=P(E),p===O?T[p].p(E,x):(group_outros(),transition_out(T[O],1,1,()=>{T[O]=null}),check_outros(),d=T[p],d?d.p(E,x):(d=T[p]=$[p](E),d.c()),transition_in(d,1),d.m(f,null))},i(E){m||(transition_in(i.$$.fragment,E),transition_in(a),transition_in(d),m=!0)},o(E){transition_out(i.$$.fragment,E),transition_out(a),transition_out(d),m=!1},d(E){E&&detach(t),destroy_component(i),~c&&w[c].d(),T[p].d(),o[20](null),g=!1,h()}}}function create_if_block_12(o){let t,e,i;return e=new Icons({props:{icon:"video"}}),{c(){t=element("div"),create_component(e.$$.fragment),attr(t,"class","absolute -bottom-1 -right-1 w-8 h-8 flex items-start justify-start p-1 rounded-lg bg-base-200 bg-opacity-80 z-10 overflow-hidden")},m(r,s){insert(r,t,s),mount_component(e,t,null),i=!0},i(r){i||(transition_in(e.$$.fragment,r),i=!0)},o(r){transition_out(e.$$.fragment,r),i=!1},d(r){r&&detach(t),destroy_component(e)}}}function create_else_block_3$1(o){let t,e,i,r;const s=[create_if_block_11,create_else_block_4],c=[];function a(u,f){return u[0].thumbnailBlob?0:1}return t=a(o),e=c[t]=s[t](o),{c(){e.c(),i=empty()},m(u,f){c[t].m(u,f),insert(u,i,f),r=!0},p(u,f){let p=t;t=a(u),t===p?c[t].p(u,f):(group_outros(),transition_out(c[p],1,1,()=>{c[p]=null}),check_outros(),e=c[t],e?e.p(u,f):(e=c[t]=s[t](u),e.c()),transition_in(e,1),e.m(i.parentNode,i))},i(u){r||(transition_in(e),r=!0)},o(u){transition_out(e),r=!1},d(u){c[t].d(u),u&&detach(i)}}}function create_if_block_10$2(o){let t;return{c(){t=element("span"),attr(t,"class","loading loading-spinner loading-lg")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_else_block_4(o){let t,e;return t=new Icons({props:{icon:o[1]}}),{c(){create_component(t.$$.fragment)},m(i,r){mount_component(t,i,r),e=!0},p(i,r){const s={};r&2&&(s.icon=i[1]),t.$set(s)},i(i){e||(transition_in(t.$$.fragment,i),e=!0)},o(i){transition_out(t.$$.fragment,i),e=!1},d(i){destroy_component(t,i)}}}function create_if_block_11(o){let t,e;return{c(){t=element("img"),attr(t,"draggable","false"),attr(t,"class","h-full w-full object-cover"),src_url_equal(t.src,e=o[0].thumbnailBlob)||attr(t,"src",e)},m(i,r){insert(i,t,r)},p(i,r){r&1&&!src_url_equal(t.src,e=i[0].thumbnailBlob)&&attr(t,"src",e)},i:noop,o:noop,d(i){i&&detach(t)}}}function create_if_block_9$2(o){let t,e=(o[0].datetimeoriginal?new Date(o[0].datetimeoriginal).toLocaleString():"")+"",i,r,s,c=(o[0].camera_manufacturer||"")+"",a,u,f=(o[0].camera_model||"")+"",p;return{c(){t=element("td"),i=text(e),r=space(),s=element("td"),a=text(c),u=space(),p=text(f),attr(t,"class","hidden sm:table-cell"),attr(s,"class","hidden sm:table-cell")},m(d,m){insert(d,t,m),append(t,i),insert(d,r,m),insert(d,s,m),append(s,a),append(s,u),append(s,p)},p(d,m){m&1&&e!==(e=(d[0].datetimeoriginal?new Date(d[0].datetimeoriginal).toLocaleString():"")+"")&&set_data(i,e),m&1&&c!==(c=(d[0].camera_manufacturer||"")+"")&&set_data(a,c),m&1&&f!==(f=(d[0].camera_model||"")+"")&&set_data(p,f)},i:noop,o:noop,d(d){d&&detach(t),d&&detach(r),d&&detach(s)}}}function create_if_block_6$6(o){let t,e=new Date(o[0].timestamp).toLocaleDateString()+"",i,r,s,c,a,u;const f=[create_if_block_7$5,create_else_block_2$3],p=[];function d(m,g){return m[3]?1:0}return s=d(o),c=p[s]=f[s](o),{c(){t=element("td"),i=text(e),r=space(),c.c(),a=empty()},m(m,g){insert(m,t,g),append(t,i),insert(m,r,g),p[s].m(m,g),insert(m,a,g),u=!0},p(m,g){(!u||g&1)&&e!==(e=new Date(m[0].timestamp).toLocaleDateString()+"")&&set_data(i,e);let h=s;s=d(m),s===h?p[s].p(m,g):(group_outros(),transition_out(p[h],1,1,()=>{p[h]=null}),check_outros(),c=p[s],c?c.p(m,g):(c=p[s]=f[s](m),c.c()),transition_in(c,1),c.m(a.parentNode,a))},i(m){u||(transition_in(c),u=!0)},o(m){transition_out(c),u=!1},d(m){m&&detach(t),m&&detach(r),p[s].d(m),m&&detach(a)}}}function create_else_block_2$3(o){let t,e=(o[0].username?o[0].username:"")+"",i;return{c(){t=element("td"),i=text(e),attr(t,"class","hidden sm:table-cell")},m(r,s){insert(r,t,s),append(t,i)},p(r,s){s&1&&e!==(e=(r[0].username?r[0].username:"")+"")&&set_data(i,e)},i:noop,o:noop,d(r){r&&detach(t)}}}function create_if_block_7$5(o){let t,e=(o[0].url?o[0].url:"")+"",i,r,s,c,a,u=(o[0].users.length>0?o[0].users.length:"")+"",f,p,d=o[0].pw&&create_if_block_8$2();return{c(){t=element("td"),i=text(e),r=space(),s=element("td"),d&&d.c(),c=space(),a=element("td"),f=text(u),attr(t,"class","hidden sm:table-cell"),attr(s,"class","hidden sm:table-cell"),attr(a,"class","hidden sm:table-cell")},m(m,g){insert(m,t,g),append(t,i),insert(m,r,g),insert(m,s,g),d&&d.m(s,null),insert(m,c,g),insert(m,a,g),append(a,f),p=!0},p(m,g){(!p||g&1)&&e!==(e=(m[0].url?m[0].url:"")+"")&&set_data(i,e),m[0].pw?d?g&1&&transition_in(d,1):(d=create_if_block_8$2(),d.c(),transition_in(d,1),d.m(s,null)):d&&(group_outros(),transition_out(d,1,1,()=>{d=null}),check_outros()),(!p||g&1)&&u!==(u=(m[0].users.length>0?m[0].users.length:"")+"")&&set_data(f,u)},i(m){p||(transition_in(d),p=!0)},o(m){transition_out(d),p=!1},d(m){m&&detach(t),m&&detach(r),m&&detach(s),d&&d.d(),m&&detach(c),m&&detach(a)}}}function create_if_block_8$2(o){let t,e;return t=new Icons({props:{icon:"key"}}),{c(){create_component(t.$$.fragment)},m(i,r){mount_component(t,i,r),e=!0},i(i){e||(transition_in(t.$$.fragment,i),e=!0)},o(i){transition_out(t.$$.fragment,i),e=!1},d(i){destroy_component(t,i)}}}function create_if_block_4$b(o){let t,e,i;return e=new Icons({props:{icon:"video"}}),{c(){t=element("div"),create_component(e.$$.fragment),attr(t,"class","absolute -bottom-1 -right-1 w-10 h-10 flex items-start justify-start rounded-lg p-2 bg-base-200 bg-opacity-80 z-10")},m(r,s){insert(r,t,s),mount_component(e,t,null),i=!0},p:noop,i(r){i||(transition_in(e.$$.fragment,r),i=!0)},o(r){transition_out(e.$$.fragment,r),i=!1},d(r){r&&detach(t),destroy_component(e)}}}function create_if_block_3$c(o){let t,e,i=o[0].name+"",r,s,c,a,u;return a=new Icons({props:{icon:o[1]}}),{c(){t=element("div"),e=element("div"),r=text(i),s=space(),c=element("div"),create_component(a.$$.fragment),attr(e,"class","p-1 break-all"),attr(t,"class","absolute top-0 w-full flex items-center justify-center bg-base-200 bg-opacity-80 z-10"),attr(c,"class","absolute -bottom-1 -right-1 w-10 h-10 flex items-start justify-start rounded-lg p-2 bg-base-200 bg-opacity-80 z-10")},m(f,p){insert(f,t,p),append(t,e),append(e,r),insert(f,s,p),insert(f,c,p),mount_component(a,c,null),u=!0},p(f,p){(!u||p&1)&&i!==(i=f[0].name+"")&&set_data(r,i);const d={};p&2&&(d.icon=f[1]),a.$set(d)},i(f){u||(transition_in(a.$$.fragment,f),u=!0)},o(f){transition_out(a.$$.fragment,f),u=!1},d(f){f&&detach(t),f&&detach(s),f&&detach(c),destroy_component(a)}}}function create_else_block$c(o){let t,e,i,r;const s=[create_if_block_2$f,create_else_block_1$4],c=[];function a(u,f){return u[0].thumbnailBlob?0:1}return t=a(o),e=c[t]=s[t](o),{c(){e.c(),i=empty()},m(u,f){c[t].m(u,f),insert(u,i,f),r=!0},p(u,f){let p=t;t=a(u),t===p?c[t].p(u,f):(group_outros(),transition_out(c[p],1,1,()=>{c[p]=null}),check_outros(),e=c[t],e?e.p(u,f):(e=c[t]=s[t](u),e.c()),transition_in(e,1),e.m(i.parentNode,i))},i(u){r||(transition_in(e),r=!0)},o(u){transition_out(e),r=!1},d(u){c[t].d(u),u&&detach(i)}}}function create_if_block_1$i(o){let t;return{c(){t=element("span"),attr(t,"class","loading loading-spinner loading-lg")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_else_block_1$4(o){let t,e,i;return e=new Icons({props:{icon:o[1],size:"8"}}),{c(){t=element("div"),create_component(e.$$.fragment),attr(t,"class","w-full h-full flex items-center justify-center opacity-50")},m(r,s){insert(r,t,s),mount_component(e,t,null),i=!0},p(r,s){const c={};s&2&&(c.icon=r[1]),e.$set(c)},i(r){i||(transition_in(e.$$.fragment,r),i=!0)},o(r){transition_out(e.$$.fragment,r),i=!1},d(r){r&&detach(t),destroy_component(e)}}}function create_if_block_2$f(o){let t,e;return{c(){t=element("img"),attr(t,"draggable","false"),attr(t,"class","w-full h-full object-cover"),src_url_equal(t.src,e=o[0].thumbnailBlob)||attr(t,"src",e)},m(i,r){insert(i,t,r)},p(i,r){r&1&&!src_url_equal(t.src,e=i[0].thumbnailBlob)&&attr(t,"src",e)},i:noop,o:noop,d(i){i&&detach(t)}}}function create_fragment$u(o){let t,e,i,r,s,c,a;function u(g){o[19](g)}let f={once:!0,element:o[7]};o[4]!==void 0&&(f.intersecting=o[4]),t=new IntersectionObserver_1({props:f}),binding_callbacks.push(()=>bind(t,"intersecting",u));const p=[create_if_block$o,create_if_block_5$a],d=[];function m(g,h){return g[2]=="grid"?0:g[2]=="list"?1:-1}return~(r=m(o))&&(s=d[r]=p[r](o)),{c(){create_component(t.$$.fragment),i=space(),s&&s.c(),c=empty()},m(g,h){mount_component(t,g,h),insert(g,i,h),~r&&d[r].m(g,h),insert(g,c,h),a=!0},p(g,[h]){const v={};h&128&&(v.element=g[7]),!e&&h&16&&(e=!0,v.intersecting=g[4],add_flush_callback(()=>e=!1)),t.$set(v);let w=r;r=m(g),r===w?~r&&d[r].p(g,h):(s&&(group_outros(),transition_out(d[w],1,1,()=>{d[w]=null}),check_outros()),~r?(s=d[r],s?s.p(g,h):(s=d[r]=p[r](g),s.c()),transition_in(s,1),s.m(c.parentNode,c)):s=null)},i(g){a||(transition_in(t.$$.fragment,g),transition_in(s),a=!0)},o(g){transition_out(t.$$.fragment,g),transition_out(s),a=!1},d(g){destroy_component(t,g),g&&detach(i),~r&&d[r].d(g),g&&detach(c)}}}function instance$v(o,t,e){let i,r,s,c,a,u;const f=stores.cache.small;component_subscribe(o,f,D=>e(23,u=D));const p=stores.notify;component_subscribe(o,p,D=>e(22,a=D));const d=stores.selected.files;component_subscribe(o,d,D=>e(18,r=D));const m=stores.selected.folders;component_subscribe(o,m,D=>e(17,i=D));const g=stores.options.excluded;component_subscribe(o,g,D=>e(9,c=D));const h=stores.options.downloadSelect;component_subscribe(o,h,D=>e(8,s=D));let{element:v,kind:w,view:k,shared:$}=t,T=!1,P=E();function E(){if(w=="file")return r.includes(v.id);if(w=="folder")return i.includes(v.id)}function x(){w=="file"&&!E()?set_store_value(d,r=[...r,v.id],r):w=="folder"&&set_store_value(m,i=[...i,v.id],i)}function S(){w=="file"?set_store_value(d,r=r.filter(D=>D!=v.id),r):w=="folder"&&set_store_value(m,i=i.filter(D=>D!=v.id),i)}async function M(){if(!F||T)return;let D=w=="file"?v.id:v.thumbnail,X=u.find(N=>N.id==D);if(X)e(0,v.thumbnailBlob=X.url,v);else if(D){let N=await bloburl(D,240);e(0,v.thumbnailBlob=N,v),set_store_value(f,u=[...u,{id:D,url:N}],u)}if(w=="share"&&$){let N=await request(`share/info/${v.id}`);if(!N.ok){goToPage("login",!0);return}e(0,v.username=await N.json().then(W=>W.username),v),e(0,v)}e(5,T=!0)}function O(){if((c||s)&&(w=="file"||w=="folder")){if(s&&w=="folder")return;E()?S():x()}set_store_value(p,a={action:c||s?P?"deselected":"selected":"clicked",kind:w,element:v},a)}let q,F;function A(D){F=D,e(4,F)}function Z(D){binding_callbacks[D?"unshift":"push"](()=>{q=D,e(7,q)})}function I(D){binding_callbacks[D?"unshift":"push"](()=>{q=D,e(7,q)})}return o.$$set=D=>{"element"in D&&e(0,v=D.element),"kind"in D&&e(1,w=D.kind),"view"in D&&e(2,k=D.view),"shared"in D&&e(3,$=D.shared)},o.$$.update=()=>{o.$$.dirty&262144&&e(6,P=E()),o.$$.dirty&131072&&e(6,P=E()),o.$$.dirty&16&&M()},[v,w,k,$,F,T,P,q,s,c,f,p,d,m,g,h,O,i,r,A,Z,I]}class Preview extends SvelteComponent{constructor(t){super(),init(this,t,instance$v,create_fragment$u,safe_not_equal,{element:0,kind:1,view:2,shared:3})}}function get_each_context_1$5(o,t,e){const i=o.slice();return i[7]=t[e],i}function get_each_context$b(o,t,e){const i=o.slice();return i[7]=t[e],i}function create_if_block$n(o){let t,e=o[0].length+"",i,r,s,c,a,u,f,p=o[0].length>1&&create_if_block_4$a();const d=[create_if_block_1$h,create_if_block_2$e],m=[];function g(h,v){return h[1]=="grid"?0:h[1]=="list"?1:-1}return~(c=g(o))&&(a=m[c]=d[c](o)),{c(){t=element("div"),i=text(e),r=text(" FOLDER"),p&&p.c(),s=space(),a&&a.c(),u=empty(),attr(t,"class","divider mx-2")},m(h,v){insert(h,t,v),append(t,i),append(t,r),p&&p.m(t,null),insert(h,s,v),~c&&m[c].m(h,v),insert(h,u,v),f=!0},p(h,v){(!f||v&1)&&e!==(e=h[0].length+"")&&set_data(i,e),h[0].length>1?p||(p=create_if_block_4$a(),p.c(),p.m(t,null)):p&&(p.d(1),p=null);let w=c;c=g(h),c===w?~c&&m[c].p(h,v):(a&&(group_outros(),transition_out(m[w],1,1,()=>{m[w]=null}),check_outros()),~c?(a=m[c],a?a.p(h,v):(a=m[c]=d[c](h),a.c()),transition_in(a,1),a.m(u.parentNode,u)):a=null)},i(h){f||(transition_in(a),f=!0)},o(h){transition_out(a),f=!1},d(h){h&&detach(t),p&&p.d(),h&&detach(s),~c&&m[c].d(h),h&&detach(u)}}}function create_if_block_4$a(o){let t;return{c(){t=text("S")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_2$e(o){let t,e,i,r,s,c,a,u,f,p,d=[],m=new Map,g,h,v,w=o[2]=="name"&&create_if_block_3$b(o),k=o[0];const $=T=>T[7];for(let T=0;T<k.length;T+=1){let P=get_each_context_1$5(o,k,T),E=$(P);m.set(E,d[T]=create_each_block_1$5(E,P))}return{c(){t=element("table"),e=element("thead"),i=element("tr"),r=element("th"),s=space(),c=element("th"),a=element("div"),u=text("name "),w&&w.c(),f=space(),p=element("tbody");for(let T=0;T<d.length;T+=1)d[T].c();attr(a,"class","flex justify-start items-center"),attr(e,"class","shadow-sm bg-base-100"),attr(t,"class","table cursor-pointer")},m(T,P){insert(T,t,P),append(t,e),append(e,i),append(i,r),append(i,s),append(i,c),append(c,a),append(a,u),w&&w.m(a,null),append(t,f),append(t,p);for(let E=0;E<d.length;E+=1)d[E]&&d[E].m(p,null);g=!0,h||(v=listen(c,"click",o[6]),h=!0)},p(T,P){T[2]=="name"?w?(w.p(T,P),P&4&&transition_in(w,1)):(w=create_if_block_3$b(T),w.c(),transition_in(w,1),w.m(a,null)):w&&(group_outros(),transition_out(w,1,1,()=>{w=null}),check_outros()),P&1&&(k=T[0],group_outros(),d=update_keyed_each(d,P,$,1,T,k,m,p,outro_and_destroy_block,create_each_block_1$5,null,get_each_context_1$5),check_outros())},i(T){if(!g){transition_in(w);for(let P=0;P<k.length;P+=1)transition_in(d[P]);g=!0}},o(T){transition_out(w);for(let P=0;P<d.length;P+=1)transition_out(d[P]);g=!1},d(T){T&&detach(t),w&&w.d();for(let P=0;P<d.length;P+=1)d[P].d();h=!1,v()}}}function create_if_block_1$h(o){let t,e=[],i=new Map,r,s=o[0];const c=a=>a[7];for(let a=0;a<s.length;a+=1){let u=get_each_context$b(o,s,a),f=c(u);i.set(f,e[a]=create_each_block$b(f,u))}return{c(){t=element("div");for(let a=0;a<e.length;a+=1)e[a].c();attr(t,"class","grid grid-cols-3 sm:grid-cols-5 lg:grid-cols-7 xl:grid-cols-9 2xl:grid-cols-11 mb-12 mx-1")},m(a,u){insert(a,t,u);for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(t,null);r=!0},p(a,u){u&1&&(s=a[0],group_outros(),e=update_keyed_each(e,u,c,1,a,s,i,t,outro_and_destroy_block,create_each_block$b,null,get_each_context$b),check_outros())},i(a){if(!r){for(let u=0;u<s.length;u+=1)transition_in(e[u]);r=!0}},o(a){for(let u=0;u<e.length;u+=1)transition_out(e[u]);r=!1},d(a){a&&detach(t);for(let u=0;u<e.length;u+=1)e[u].d()}}}function create_if_block_3$b(o){let t,e,i,r;function s(a){o[5](a)}let c={iconon:"arrow_up",iconoff:"arrow_down",disabled:!0};return o[3]!==void 0&&(c.bind=o[3]),e=new SwapLogo({props:c}),binding_callbacks.push(()=>bind(e,"bind",s)),{c(){t=element("span"),create_component(e.$$.fragment),attr(t,"class","ml-2")},m(a,u){insert(a,t,u),mount_component(e,t,null),r=!0},p(a,u){const f={};!i&&u&8&&(i=!0,f.bind=a[3],add_flush_callback(()=>i=!1)),e.$set(f)},i(a){r||(transition_in(e.$$.fragment,a),r=!0)},o(a){transition_out(e.$$.fragment,a),r=!1},d(a){a&&detach(t),destroy_component(e)}}}function create_each_block_1$5(o,t){let e,i,r;return i=new Preview({props:{element:t[7],kind:"folder",view:"list",shared:!1}}),{key:o,first:null,c(){e=empty(),create_component(i.$$.fragment),this.first=e},m(s,c){insert(s,e,c),mount_component(i,s,c),r=!0},p(s,c){t=s;const a={};c&1&&(a.element=t[7]),i.$set(a)},i(s){r||(transition_in(i.$$.fragment,s),r=!0)},o(s){transition_out(i.$$.fragment,s),r=!1},d(s){s&&detach(e),destroy_component(i,s)}}}function create_each_block$b(o,t){let e,i,r;return i=new Preview({props:{element:t[7],kind:"folder",view:"grid",shared:!1}}),{key:o,first:null,c(){e=empty(),create_component(i.$$.fragment),this.first=e},m(s,c){insert(s,e,c),mount_component(i,s,c),r=!0},p(s,c){t=s;const a={};c&1&&(a.element=t[7]),i.$set(a)},i(s){r||(transition_in(i.$$.fragment,s),r=!0)},o(s){transition_out(i.$$.fragment,s),r=!1},d(s){s&&detach(e),destroy_component(i,s)}}}function create_fragment$t(o){let t,e,i=o[0].length>0&&create_if_block$n(o);return{c(){i&&i.c(),t=empty()},m(r,s){i&&i.m(r,s),insert(r,t,s),e=!0},p(r,[s]){r[0].length>0?i?(i.p(r,s),s&1&&transition_in(i,1)):(i=create_if_block$n(r),i.c(),transition_in(i,1),i.m(t.parentNode,t)):i&&(group_outros(),transition_out(i,1,1,()=>{i=null}),check_outros())},i(r){e||(transition_in(i),e=!0)},o(r){transition_out(i),e=!1},d(r){i&&i.d(r),r&&detach(t)}}}function instance$u(o,t,e){let{folders:i}=t,{view:r}=t;var s,c=!0;function a(p){p==s&&e(3,c=!c),e(2,s=p);let d=i;switch(p){case"name":d.sort((m,g)=>compare(m.name,g.name,c))}e(0,i=d)}function u(p){c=p,e(3,c)}const f=()=>a("name");return o.$$set=p=>{"folders"in p&&e(0,i=p.folders),"view"in p&&e(1,r=p.view)},[i,r,s,c,a,u,f]}class FoldersGallery extends SvelteComponent{constructor(t){super(),init(this,t,instance$u,create_fragment$t,safe_not_equal,{folders:0,view:1})}}const DEFAULT_DELAY=300,DEFAULT_MIN_SWIPE_DISTANCE=60,DEFAULT_TOUCH_ACTION="none";function addEventListener(o,t,e){return o.addEventListener(t,e),()=>o.removeEventListener(t,e)}function removeEvent(o,t){return t.filter(e=>o.pointerId!==e.pointerId)}function dispatch(o,t,e,i,r){o.dispatchEvent(new CustomEvent(`${t}${r}`,{detail:{event:e,pointersCount:i.length,target:e.target}}))}function setPointerControls(o,t,e,i,r,s=DEFAULT_TOUCH_ACTION){t.style.touchAction=s;let c=[];function a(f){c.push(f),dispatch(t,o,f,c,"down"),i==null||i(c,f);const p=f.pointerId;function d(k){p===k.pointerId&&(c=removeEvent(k,c),c.length||m(),dispatch(t,o,k,c,"up"),r==null||r(c,k))}function m(){g(),h(),v(),w()}const g=addEventListener(t,"pointermove",k=>{c=c.map($=>k.pointerId===$.pointerId?k:$),dispatch(t,o,k,c,"move"),e==null||e(c,k)}),h=addEventListener(t,"lostpointercapture",k=>{d(k)}),v=addEventListener(t,"pointerup",k=>{d(k)}),w=addEventListener(t,"pointerleave",k=>{c=[],m(),dispatch(t,o,k,c,"up"),r==null||r(c,k)})}const u=addEventListener(t,"pointerdown",a);return{destroy:()=>{u()}}}function swipe(o,t){const e={timeframe:DEFAULT_DELAY,minSwipeDistance:DEFAULT_MIN_SWIPE_DISTANCE,touchAction:DEFAULT_TOUCH_ACTION,composed:!1,...t},i="swipe";let r,s,c,a;function u(p,d){s=d.clientX,c=d.clientY,r=Date.now(),p.length===1&&(a=d.target)}function f(p,d){if(d.type==="pointerup"&&p.length===0&&Date.now()-r<e.timeframe){const m=d.clientX-s,g=d.clientY-c,h=Math.abs(m),v=Math.abs(g);let w=null;h>=2*v&&h>e.minSwipeDistance?w=m>0?"right":"left":v>=2*h&&v>e.minSwipeDistance&&(w=g>0?"bottom":"top"),w&&o.dispatchEvent(new CustomEvent(i,{detail:{direction:w,target:a}}))}}return e.composed?{onMove:null,onDown:u,onUp:f}:setPointerControls(i,o,null,u,f,e.touchAction)}var leaflet={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(o,t){(function(e,i){i(t)})(commonjsGlobal,function(e){function i(n){for(var l,_,b=1,y=arguments.length;b<y;b++)for(l in _=arguments[b])n[l]=_[l];return n}var r=Object.create||function(n){return s.prototype=n,new s};function s(){}function c(n,l){var _,b=Array.prototype.slice;return n.bind?n.bind.apply(n,b.call(arguments,1)):(_=b.call(arguments,2),function(){return n.apply(l,_.length?_.concat(b.call(arguments)):arguments)})}var a=0;function u(n){return"_leaflet_id"in n||(n._leaflet_id=++a),n._leaflet_id}function f(n,l,_){var b,y,B=function(){b=!1,y&&(K.apply(_,y),y=!1)},K=function(){b?y=arguments:(n.apply(_,arguments),setTimeout(B,l),b=!0)};return K}function p(n,y,_){var b=y[1],y=y[0],B=b-y;return n===b&&_?n:((n-y)%B+B)%B+y}function d(){return!1}function m(n,l){return l===!1?n:(l=Math.pow(10,l===void 0?6:l),Math.round(n*l)/l)}function g(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function h(n){return g(n).split(/\s+/)}function v(n,l){for(var _ in Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?r(n.options):{}),l)n.options[_]=l[_];return n.options}function w(n,l,_){var b,y=[];for(b in n)y.push(encodeURIComponent(_?b.toUpperCase():b)+"="+encodeURIComponent(n[b]));return(l&&l.indexOf("?")!==-1?"&":"?")+y.join("&")}var k=/\{ *([\w_ -]+) *\}/g;function $(n,l){return n.replace(k,function(_,b){if(b=l[b],b===void 0)throw new Error("No value provided for variable "+_);return b=typeof b=="function"?b(l):b})}var T=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function P(n,l){for(var _=0;_<n.length;_++)if(n[_]===l)return _;return-1}var E="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function x(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var S=0;function M(n){var l=+new Date,_=Math.max(0,16-(l-S));return S=l+_,window.setTimeout(n,_)}var O=window.requestAnimationFrame||x("RequestAnimationFrame")||M,q=window.cancelAnimationFrame||x("CancelAnimationFrame")||x("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function F(n,l,_){if(!_||O!==M)return O.call(window,c(n,l));n.call(l)}function A(n){n&&q.call(window,n)}var Z={__proto__:null,extend:i,create:r,bind:c,get lastId(){return a},stamp:u,throttle:f,wrapNum:p,falseFn:d,formatNum:m,trim:g,splitWords:h,setOptions:v,getParamString:w,template:$,isArray:T,indexOf:P,emptyImageUrl:E,requestFn:O,cancelFn:q,requestAnimFrame:F,cancelAnimFrame:A};function I(){}I.extend=function(n){function l(){v(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()}var _,b=l.__super__=this.prototype,y=r(b);for(_ in(y.constructor=l).prototype=y,this)Object.prototype.hasOwnProperty.call(this,_)&&_!=="prototype"&&_!=="__super__"&&(l[_]=this[_]);if(n.statics&&i(l,n.statics),n.includes){var B=n.includes;if(typeof L<"u"&&L&&L.Mixin){B=T(B)?B:[B];for(var K=0;K<B.length;K++)B[K]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}i.apply(null,[y].concat(n.includes))}return i(y,n),delete y.statics,delete y.includes,y.options&&(y.options=b.options?r(b.options):{},i(y.options,n.options)),y._initHooks=[],y.callInitHooks=function(){if(!this._initHooksCalled){b.callInitHooks&&b.callInitHooks.call(this),this._initHooksCalled=!0;for(var Y=0,se=y._initHooks.length;Y<se;Y++)y._initHooks[Y].call(this)}},l},I.include=function(n){var l=this.prototype.options;return i(this.prototype,n),n.options&&(this.prototype.options=l,this.mergeOptions(n.options)),this},I.mergeOptions=function(n){return i(this.prototype.options,n),this},I.addInitHook=function(n){var l=Array.prototype.slice.call(arguments,1),_=typeof n=="function"?n:function(){this[n].apply(this,l)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(_),this};var D={on:function(n,l,_){if(typeof n=="object")for(var b in n)this._on(b,n[b],l);else for(var y=0,B=(n=h(n)).length;y<B;y++)this._on(n[y],l,_);return this},off:function(n,l,_){if(arguments.length)if(typeof n=="object")for(var b in n)this._off(b,n[b],l);else{n=h(n);for(var y=arguments.length===1,B=0,K=n.length;B<K;B++)y?this._off(n[B]):this._off(n[B],l,_)}else delete this._events;return this},_on:function(n,l,_,b){typeof l!="function"?console.warn("wrong listener type: "+typeof l):this._listens(n,l,_)===!1&&(l={fn:l,ctx:_=_===this?void 0:_},b&&(l.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(l))},_off:function(n,l,_){var b,y,B;if(this._events&&(b=this._events[n]))if(arguments.length===1){if(this._firingCount)for(y=0,B=b.length;y<B;y++)b[y].fn=d;delete this._events[n]}else typeof l!="function"?console.warn("wrong listener type: "+typeof l):(l=this._listens(n,l,_))!==!1&&(_=b[l],this._firingCount&&(_.fn=d,this._events[n]=b=b.slice()),b.splice(l,1))},fire:function(n,l,_){if(this.listens(n,_)){var b=i({},l,{type:n,target:this,sourceTarget:l&&l.sourceTarget||this});if(this._events){var y=this._events[n];if(y){this._firingCount=this._firingCount+1||1;for(var B=0,K=y.length;B<K;B++){var Y=y[B],se=Y.fn;Y.once&&this.off(n,se,Y.ctx),se.call(Y.ctx||this,b)}this._firingCount--}}_&&this._propagateEvent(b)}return this},listens:function(n,l,_,b){typeof n!="string"&&console.warn('"string" type argument expected');var y=l,B=(typeof l!="function"&&(b=!!l,_=y=void 0),this._events&&this._events[n]);if(B&&B.length&&this._listens(n,y,_)!==!1)return!0;if(b){for(var K in this._eventParents)if(this._eventParents[K].listens(n,l,_,b))return!0}return!1},_listens:function(n,l,_){if(this._events){var b=this._events[n]||[];if(!l)return!!b.length;_===this&&(_=void 0);for(var y=0,B=b.length;y<B;y++)if(b[y].fn===l&&b[y].ctx===_)return y}return!1},once:function(n,l,_){if(typeof n=="object")for(var b in n)this._on(b,n[b],l,!0);else for(var y=0,B=(n=h(n)).length;y<B;y++)this._on(n[y],l,_,!0);return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[u(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[u(n)],this},_propagateEvent:function(n){for(var l in this._eventParents)this._eventParents[l].fire(n.type,i({layer:n.target,propagatedFrom:n.target},n),!0)}},X=(D.addEventListener=D.on,D.removeEventListener=D.clearAllEventListeners=D.off,D.addOneTimeEventListener=D.once,D.fireEvent=D.fire,D.hasEventListeners=D.listens,I.extend(D));function N(n,l,_){this.x=_?Math.round(n):n,this.y=_?Math.round(l):l}var W=Math.trunc||function(n){return 0<n?Math.floor(n):Math.ceil(n)};function R(n,l,_){return n instanceof N?n:T(n)?new N(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new N(n.x,n.y):new N(n,l,_)}function U(n,l){if(n)for(var _=l?[n,l]:n,b=0,y=_.length;b<y;b++)this.extend(_[b])}function z(n,l){return!n||n instanceof U?n:new U(n,l)}function C(n,l){if(n)for(var _=l?[n,l]:n,b=0,y=_.length;b<y;b++)this.extend(_[b])}function j(n,l){return n instanceof C?n:new C(n,l)}function V(n,l,_){if(isNaN(n)||isNaN(l))throw new Error("Invalid LatLng object: ("+n+", "+l+")");this.lat=+n,this.lng=+l,_!==void 0&&(this.alt=+_)}function H(n,l,_){return n instanceof V?n:T(n)&&typeof n[0]!="object"?n.length===3?new V(n[0],n[1],n[2]):n.length===2?new V(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new V(n.lat,"lng"in n?n.lng:n.lon,n.alt):l===void 0?null:new V(n,l,_)}N.prototype={clone:function(){return new N(this.x,this.y)},add:function(n){return this.clone()._add(R(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(R(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new N(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new N(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=W(this.x),this.y=W(this.y),this},distanceTo:function(_){var l=(_=R(_)).x-this.x,_=_.y-this.y;return Math.sqrt(l*l+_*_)},equals:function(n){return(n=R(n)).x===this.x&&n.y===this.y},contains:function(n){return n=R(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+m(this.x)+", "+m(this.y)+")"}},U.prototype={extend:function(n){var l,_;if(n){if(n instanceof N||typeof n[0]=="number"||"x"in n)l=_=R(n);else if(l=(n=z(n)).min,_=n.max,!l||!_)return this;this.min||this.max?(this.min.x=Math.min(l.x,this.min.x),this.max.x=Math.max(_.x,this.max.x),this.min.y=Math.min(l.y,this.min.y),this.max.y=Math.max(_.y,this.max.y)):(this.min=l.clone(),this.max=_.clone())}return this},getCenter:function(n){return R((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return R(this.min.x,this.max.y)},getTopRight:function(){return R(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var l,_;return(n=(typeof n[0]=="number"||n instanceof N?R:z)(n))instanceof U?(l=n.min,_=n.max):l=_=n,l.x>=this.min.x&&_.x<=this.max.x&&l.y>=this.min.y&&_.y<=this.max.y},intersects:function(B){B=z(B);var l=this.min,_=this.max,b=B.min,B=B.max,y=B.x>=l.x&&b.x<=_.x,B=B.y>=l.y&&b.y<=_.y;return y&&B},overlaps:function(B){B=z(B);var l=this.min,_=this.max,b=B.min,B=B.max,y=B.x>l.x&&b.x<_.x,B=B.y>l.y&&b.y<_.y;return y&&B},isValid:function(){return!(!this.min||!this.max)},pad:function(y){var l=this.min,_=this.max,b=Math.abs(l.x-_.x)*y,y=Math.abs(l.y-_.y)*y;return z(R(l.x-b,l.y-y),R(_.x+b,_.y+y))},equals:function(n){return!!n&&(n=z(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight()))}},C.prototype={extend:function(n){var l,_,b=this._southWest,y=this._northEast;if(n instanceof V)_=l=n;else{if(!(n instanceof C))return n?this.extend(H(n)||j(n)):this;if(l=n._southWest,_=n._northEast,!l||!_)return this}return b||y?(b.lat=Math.min(l.lat,b.lat),b.lng=Math.min(l.lng,b.lng),y.lat=Math.max(_.lat,y.lat),y.lng=Math.max(_.lng,y.lng)):(this._southWest=new V(l.lat,l.lng),this._northEast=new V(_.lat,_.lng)),this},pad:function(y){var l=this._southWest,_=this._northEast,b=Math.abs(l.lat-_.lat)*y,y=Math.abs(l.lng-_.lng)*y;return new C(new V(l.lat-b,l.lng-y),new V(_.lat+b,_.lng+y))},getCenter:function(){return new V((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new V(this.getNorth(),this.getWest())},getSouthEast:function(){return new V(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){n=(typeof n[0]=="number"||n instanceof V||"lat"in n?H:j)(n);var l,_,b=this._southWest,y=this._northEast;return n instanceof C?(l=n.getSouthWest(),_=n.getNorthEast()):l=_=n,l.lat>=b.lat&&_.lat<=y.lat&&l.lng>=b.lng&&_.lng<=y.lng},intersects:function(B){B=j(B);var l=this._southWest,_=this._northEast,b=B.getSouthWest(),B=B.getNorthEast(),y=B.lat>=l.lat&&b.lat<=_.lat,B=B.lng>=l.lng&&b.lng<=_.lng;return y&&B},overlaps:function(B){B=j(B);var l=this._southWest,_=this._northEast,b=B.getSouthWest(),B=B.getNorthEast(),y=B.lat>l.lat&&b.lat<_.lat,B=B.lng>l.lng&&b.lng<_.lng;return y&&B},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,l){return!!n&&(n=j(n),this._southWest.equals(n.getSouthWest(),l)&&this._northEast.equals(n.getNorthEast(),l))},isValid:function(){return!(!this._southWest||!this._northEast)}};var G={latLngToPoint:function(n,l){return n=this.projection.project(n),l=this.scale(l),this.transformation._transform(n,l)},pointToLatLng:function(n,l){return l=this.scale(l),n=this.transformation.untransform(n,l),this.projection.unproject(n)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){var l;return this.infinite?null:(l=this.projection.bounds,n=this.scale(n),new U(this.transformation.transform(l.min,n),this.transformation.transform(l.max,n)))},infinite:!(V.prototype={equals:function(n,l){return!!n&&(n=H(n),Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng))<=(l===void 0?1e-9:l))},toString:function(n){return"LatLng("+m(this.lat,n)+", "+m(this.lng,n)+")"},distanceTo:function(n){return ee.distance(this,H(n))},wrap:function(){return ee.wrapLatLng(this)},toBounds:function(l){var l=180*l/40075017,_=l/Math.cos(Math.PI/180*this.lat);return j([this.lat-l,this.lng-_],[this.lat+l,this.lng+_])},clone:function(){return new V(this.lat,this.lng,this.alt)}}),wrapLatLng:function(n){var l=this.wrapLng?p(n.lng,this.wrapLng,!0):n.lng;return new V(this.wrapLat?p(n.lat,this.wrapLat,!0):n.lat,l,n.alt)},wrapLatLngBounds:function(n){var b=n.getCenter(),l=this.wrapLatLng(b),_=b.lat-l.lat,b=b.lng-l.lng;return _==0&&b==0?n:(l=n.getSouthWest(),n=n.getNorthEast(),new C(new V(l.lat-_,l.lng-b),new V(n.lat-_,n.lng-b)))}},ee=i({},G,{wrapLng:[-180,180],R:6371e3,distance:function(K,B){var Y=Math.PI/180,_=K.lat*Y,b=B.lat*Y,y=Math.sin((B.lat-K.lat)*Y/2),B=Math.sin((B.lng-K.lng)*Y/2),K=y*y+Math.cos(_)*Math.cos(b)*B*B,Y=2*Math.atan2(Math.sqrt(K),Math.sqrt(1-K));return this.R*Y}}),re=6378137,re={R:re,MAX_LATITUDE:85.0511287798,project:function(n){var l=Math.PI/180,_=this.MAX_LATITUDE,_=Math.max(Math.min(_,n.lat),-_),_=Math.sin(_*l);return new N(this.R*n.lng*l,this.R*Math.log((1+_)/(1-_))/2)},unproject:function(n){var l=180/Math.PI;return new V((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*l,n.x*l/this.R)},bounds:new U([-(re=re*Math.PI),-re],[re,re])};function ae(n,l,_,b){T(n)?(this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3]):(this._a=n,this._b=l,this._c=_,this._d=b)}function oe(n,l,_,b){return new ae(n,l,_,b)}ae.prototype={transform:function(n,l){return this._transform(n.clone(),l)},_transform:function(n,l){return n.x=(l=l||1)*(this._a*n.x+this._b),n.y=l*(this._c*n.y+this._d),n},untransform:function(n,l){return new N((n.x/(l=l||1)-this._b)/this._a,(n.y/l-this._d)/this._c)}};var le=i({},ee,{code:"EPSG:3857",projection:re,transformation:oe(le=.5/(Math.PI*re.R),.5,-le,.5)}),fe=i({},le,{code:"EPSG:900913"});function me(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function de(n,l){for(var _,b,y,B,K="",Y=0,se=n.length;Y<se;Y++){for(_=0,b=(y=n[Y]).length;_<b;_++)K+=(_?"L":"M")+(B=y[_]).x+" "+B.y;K+=l?pe.svg?"z":"x":""}return K||"M0 0"}var ht=document.documentElement.style,ue="ActiveXObject"in window,Cn=ue&&!document.addEventListener,Je="msLaunchUri"in navigator&&!("documentMode"in document),Rt=Se("webkit"),en=Se("android"),nn=Se("android 2")||Se("android 3"),Tt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Tt=en&&Se("Google")&&Tt<537&&!("AudioNode"in window),Lt=!!window.opera,on=!Je&&Se("chrome"),te=Se("gecko")&&!Rt&&!Lt&&!ue,An=!on&&Se("safari"),rn=Se("phantom"),Ke="OTransition"in ht,J=navigator.platform.indexOf("Win")===0,_n=ue&&"transition"in ht,Ht="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!nn,ht="MozPerspective"in ht,gn=!window.L_DISABLE_3D&&(_n||Ht||ht)&&!Ke&&!rn,yt=typeof orientation<"u"||Se("mobile"),bn=yt&&Rt,vn=yt&&Ht,Vt=!window.PointerEvent&&window.MSPointerEvent,Gt=!(!window.PointerEvent&&!Vt),Q="ontouchstart"in window||!!window.TouchEvent,he=!window.L_NO_TOUCH&&(Q||Gt),_e=yt&&Lt,ne=yt&&te,ie=1<(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI),ye=function(){var n=!1;try{var l=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",d,l),window.removeEventListener("testPassiveEventSupport",d,l)}catch{}return n}(),Oe=!!document.createElement("canvas").getContext,Le=!(!document.createElementNS||!me("svg").createSVGRect),ve=!!Le&&((ve=document.createElement("div")).innerHTML="<svg/>",(ve.firstChild&&ve.firstChild.namespaceURI)==="http://www.w3.org/2000/svg");function Se(n){return 0<=navigator.userAgent.toLowerCase().indexOf(n)}var pe={ie:ue,ielt9:Cn,edge:Je,webkit:Rt,android:en,android23:nn,androidStock:Tt,opera:Lt,chrome:on,gecko:te,safari:An,phantom:rn,opera12:Ke,win:J,ie3d:_n,webkit3d:Ht,gecko3d:ht,any3d:gn,mobile:yt,mobileWebkit:bn,mobileWebkit3d:vn,msPointer:Vt,pointer:Gt,touch:he,touchNative:Q,mobileOpera:_e,mobileGecko:ne,retina:ie,passiveEvents:ye,canvas:Oe,svg:Le,vml:!Le&&function(){try{var n=document.createElement("div"),l=(n.innerHTML='<v:shape adj="1"/>',n.firstChild);return l.style.behavior="url(#default#VML)",l&&typeof l.adj=="object"}catch{return!1}}(),inlineSvg:ve,mac:navigator.platform.indexOf("Mac")===0,linux:navigator.platform.indexOf("Linux")===0},ze=pe.msPointer?"MSPointerDown":"pointerdown",je=pe.msPointer?"MSPointerMove":"pointermove",Ge=pe.msPointer?"MSPointerUp":"pointerup",He=pe.msPointer?"MSPointerCancel":"pointercancel",Ie={touchstart:ze,touchmove:je,touchend:Ge,touchcancel:He},tt={touchstart:function(n,l){l.MSPOINTER_TYPE_TOUCH&&l.pointerType===l.MSPOINTER_TYPE_TOUCH&&Ve(l),De(n,l)},touchmove:De,touchend:De,touchcancel:De},Ue={},Fe=!1;function rt(n,l,_){return l!=="touchstart"||Fe||(document.addEventListener(ze,nt,!0),document.addEventListener(je,Ze,!0),document.addEventListener(Ge,Pe,!0),document.addEventListener(He,Pe,!0),Fe=!0),tt[l]?(_=tt[l].bind(this,_),n.addEventListener(Ie[l],_,!1),_):(console.warn("wrong event specified:",l),d)}function nt(n){Ue[n.pointerId]=n}function Ze(n){Ue[n.pointerId]&&(Ue[n.pointerId]=n)}function Pe(n){delete Ue[n.pointerId]}function De(n,l){if(l.pointerType!==(l.MSPOINTER_TYPE_MOUSE||"mouse")){for(var _ in l.touches=[],Ue)l.touches.push(Ue[_]);l.changedTouches=[l],n(l)}}var at=200;function Et(n,l){n.addEventListener("dblclick",l);var _,b=0;function y(B){var K;B.detail!==1?_=B.detail:B.pointerType==="mouse"||B.sourceCapabilities&&!B.sourceCapabilities.firesTouchEvents||(K=Fn(B)).some(function(Y){return Y instanceof HTMLLabelElement&&Y.attributes.for})&&!K.some(function(Y){return Y instanceof HTMLInputElement||Y instanceof HTMLSelectElement})||((K=Date.now())-b<=at?++_===2&&l(function(Y){var se,ce,be={};for(ce in Y)se=Y[ce],be[ce]=se&&se.bind?se.bind(Y):se;return(Y=be).type="dblclick",be.detail=2,be.isTrusted=!1,be._simulated=!0,be}(B)):_=1,b=K)}return n.addEventListener("click",y),{dblclick:l,simDblclick:y}}var ut,Xe,mt,ge,ke,Re,At=Jt(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),gt=Jt(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Yt=gt==="webkitTransition"||gt==="OTransition"?gt+"End":"transitionend";function Rn(n){return typeof n=="string"?document.getElementById(n):n}function Zt(n,l){var _=n.style[l]||n.currentStyle&&n.currentStyle[l];return(_=_&&_!=="auto"||!document.defaultView?_:(n=document.defaultView.getComputedStyle(n,null))?n[l]:null)==="auto"?null:_}function Me(n,l,_){return n=document.createElement(n),n.className=l||"",_&&_.appendChild(n),n}function Be(n){var l=n.parentNode;l&&l.removeChild(n)}function Kt(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function Mt(n){var l=n.parentNode;l&&l.lastChild!==n&&l.appendChild(n)}function St(n){var l=n.parentNode;l&&l.firstChild!==n&&l.insertBefore(n,l.firstChild)}function wn(n,l){return n.classList!==void 0?n.classList.contains(l):0<(n=Xt(n)).length&&new RegExp("(^|\\s)"+l+"(\\s|$)").test(n)}function Te(n,l){var _;if(n.classList!==void 0)for(var b=h(l),y=0,B=b.length;y<B;y++)n.classList.add(b[y]);else wn(n,l)||kn(n,((_=Xt(n))?_+" ":"")+l)}function qe(n,l){n.classList!==void 0?n.classList.remove(l):kn(n,g((" "+Xt(n)+" ").replace(" "+l+" "," ")))}function kn(n,l){n.className.baseVal===void 0?n.className=l:n.className.baseVal=l}function Xt(n){return(n=n.correspondingElement?n.correspondingElement:n).className.baseVal===void 0?n.className:n.className.baseVal}function it(n,l){if("opacity"in n.style)n.style.opacity=l;else if("filter"in n.style){var _=!1,b="DXImageTransform.Microsoft.Alpha";try{_=n.filters.item(b)}catch{if(l===1)return}l=Math.round(100*l),_?(_.Enabled=l!==100,_.Opacity=l):n.style.filter+=" progid:"+b+"(opacity="+l+")"}}function Jt(n){for(var l=document.documentElement.style,_=0;_<n.length;_++)if(n[_]in l)return n[_];return!1}function wt(n,l,_){l=l||new N(0,0),n.style[At]=(pe.ie3d?"translate("+l.x+"px,"+l.y+"px)":"translate3d("+l.x+"px,"+l.y+"px,0)")+(_?" scale("+_+")":"")}function We(n,l){n._leaflet_pos=l,pe.any3d?wt(n,l):(n.style.left=l.x+"px",n.style.top=l.y+"px")}function kt(n){return n._leaflet_pos||new N(0,0)}function xn(){we(window,"dragstart",Ve)}function $n(){Ce(window,"dragstart",Ve)}function Pn(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(Qt(),Re=(ke=n).style.outlineStyle,n.style.outlineStyle="none",we(window,"keydown",Qt))}function Qt(){ke&&(ke.style.outlineStyle=Re,Re=ke=void 0,Ce(window,"keydown",Qt))}function qn(n){for(;!((n=n.parentNode).offsetWidth&&n.offsetHeight||n===document.body););return n}function Tn(n){var l=n.getBoundingClientRect();return{x:l.width/n.offsetWidth||1,y:l.height/n.offsetHeight||1,boundingClientRect:l}}ge="onselectstart"in document?(mt=function(){we(window,"selectstart",Ve)},function(){Ce(window,"selectstart",Ve)}):(Xe=Jt(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]),mt=function(){var n;Xe&&(n=document.documentElement.style,ut=n[Xe],n[Xe]="none")},function(){Xe&&(document.documentElement.style[Xe]=ut,ut=void 0)}),ue={__proto__:null,TRANSFORM:At,TRANSITION:gt,TRANSITION_END:Yt,get:Rn,getStyle:Zt,create:Me,remove:Be,empty:Kt,toFront:Mt,toBack:St,hasClass:wn,addClass:Te,removeClass:qe,setClass:kn,getClass:Xt,setOpacity:it,testProp:Jt,setTransform:wt,setPosition:We,getPosition:kt,get disableTextSelection(){return mt},get enableTextSelection(){return ge},disableImageDrag:xn,enableImageDrag:$n,preventOutline:Pn,restoreOutline:Qt,getSizedParentNode:qn,getScale:Tn};function we(n,l,_,b){if(l&&typeof l=="object")for(var y in l)En(n,y,l[y],_);else for(var B=0,K=(l=h(l)).length;B<K;B++)En(n,l[B],_,b);return this}var lt="_leaflet_events";function Ce(n,l,_,b){if(arguments.length===1)Nn(n),delete n[lt];else if(l&&typeof l=="object")for(var y in l)Mn(n,y,l[y],_);else if(l=h(l),arguments.length===2)Nn(n,function(Y){return P(l,Y)!==-1});else for(var B=0,K=l.length;B<K;B++)Mn(n,l[B],_,b);return this}function Nn(n,l){for(var _ in n[lt]){var b=_.split(/\d/)[0];l&&!l(b)||Mn(n,b,null,null,_)}}var Ln={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function En(n,l,_,b){var y,B,K=l+u(_)+(b?"_"+u(b):"");n[lt]&&n[lt][K]||(B=y=function(Y){return _.call(b||n,Y||window.event)},!pe.touchNative&&pe.pointer&&l.indexOf("touch")===0?y=rt(n,l,y):pe.touch&&l==="dblclick"?y=Et(n,y):"addEventListener"in n?l==="touchstart"||l==="touchmove"||l==="wheel"||l==="mousewheel"?n.addEventListener(Ln[l]||l,y,!!pe.passiveEvents&&{passive:!1}):l==="mouseenter"||l==="mouseleave"?n.addEventListener(Ln[l],y=function(Y){Y=Y||window.event,zn(n,Y)&&B(Y)},!1):n.addEventListener(l,B,!1):n.attachEvent("on"+l,y),n[lt]=n[lt]||{},n[lt][K]=y)}function Mn(n,l,Y,b,y){y=y||l+u(Y)+(b?"_"+u(b):"");var B,K,Y=n[lt]&&n[lt][y];Y&&(!pe.touchNative&&pe.pointer&&l.indexOf("touch")===0?(b=n,K=Y,Ie[B=l]?b.removeEventListener(Ie[B],K,!1):console.warn("wrong event specified:",B)):pe.touch&&l==="dblclick"?(b=Y,(K=n).removeEventListener("dblclick",b.dblclick),K.removeEventListener("click",b.simDblclick)):"removeEventListener"in n?n.removeEventListener(Ln[l]||l,Y,!1):n.detachEvent("on"+l,Y),n[lt][y]=null)}function xt(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function Sn(n){return En(n,"wheel",xt),this}function Bt(n){return we(n,"mousedown touchstart dblclick contextmenu",xt),n._leaflet_disable_click=!0,this}function Ve(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function $t(n){return Ve(n),xt(n),this}function Fn(n){if(n.composedPath)return n.composedPath();for(var l=[],_=n.target;_;)l.push(_),_=_.parentNode;return l}function Wn(n,l){var _,b;return l?(b=(_=Tn(l)).boundingClientRect,new N((n.clientX-b.left)/_.x-l.clientLeft,(n.clientY-b.top)/_.y-l.clientTop)):new N(n.clientX,n.clientY)}var vi=pe.linux&&pe.chrome?window.devicePixelRatio:pe.mac?3*window.devicePixelRatio:0<window.devicePixelRatio?2*window.devicePixelRatio:1;function Hn(n){return pe.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/vi:n.deltaY&&n.deltaMode===1?20*-n.deltaY:n.deltaY&&n.deltaMode===2?60*-n.deltaY:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?20*-n.detail:n.detail?n.detail/-32765*60:0}function zn(n,l){var _=l.relatedTarget;if(!_)return!0;try{for(;_&&_!==n;)_=_.parentNode}catch{return!1}return _!==n}var Cn={__proto__:null,on:we,off:Ce,stopPropagation:xt,disableScrollPropagation:Sn,disableClickPropagation:Bt,preventDefault:Ve,stop:$t,getPropagationPath:Fn,getMousePosition:Wn,getWheelDelta:Hn,isExternalTarget:zn,addListener:we,removeListener:Ce},Un=X.extend({run:function(n,l,_,b){this.stop(),this._el=n,this._inProgress=!0,this._duration=_||.25,this._easeOutPower=1/Math.max(b||.5,.2),this._startPos=kt(n),this._offset=l.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=F(this._animate,this),this._step()},_step:function(n){var l=+new Date-this._startTime,_=1e3*this._duration;l<_?this._runFrame(this._easeOut(l/_),n):(this._runFrame(1),this._complete())},_runFrame:function(n,l){n=this._startPos.add(this._offset.multiplyBy(n)),l&&n._round(),We(this._el,n),this.fire("step")},_complete:function(){A(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),Ee=X.extend({options:{crs:le,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,l){l=v(this,l),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),l.maxBounds&&this.setMaxBounds(l.maxBounds),l.zoom!==void 0&&(this._zoom=this._limitZoom(l.zoom)),l.center&&l.zoom!==void 0&&this.setView(H(l.center),l.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=gt&&pe.any3d&&!pe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),we(this._proxy,Yt,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,l,_){return l=l===void 0?this._zoom:this._limitZoom(l),n=this._limitCenter(H(n),l,this.options.maxBounds),_=_||{},this._stop(),this._loaded&&!_.reset&&_!==!0&&(_.animate!==void 0&&(_.zoom=i({animate:_.animate},_.zoom),_.pan=i({animate:_.animate,duration:_.duration},_.pan)),this._zoom!==l?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,l,_.zoom):this._tryAnimatedPan(n,_.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(n,l,_.pan&&_.pan.noMoveStart),this)},setZoom:function(n,l){return this._loaded?this.setView(this.getCenter(),n,{zoom:l}):(this._zoom=n,this)},zoomIn:function(n,l){return n=n||(pe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,l)},zoomOut:function(n,l){return n=n||(pe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,l)},setZoomAround:function(y,l,_){var B=this.getZoomScale(l),b=this.getSize().divideBy(2),y=(y instanceof N?y:this.latLngToContainerPoint(y)).subtract(b).multiplyBy(1-1/B),B=this.containerPointToLatLng(b.add(y));return this.setView(B,l,{zoom:_})},_getBoundsCenterZoom:function(n,l){l=l||{},n=n.getBounds?n.getBounds():j(n);var _=R(l.paddingTopLeft||l.padding||[0,0]),b=R(l.paddingBottomRight||l.padding||[0,0]),y=this.getBoundsZoom(n,!1,_.add(b));return(y=typeof l.maxZoom=="number"?Math.min(l.maxZoom,y):y)===1/0?{center:n.getCenter(),zoom:y}:(l=b.subtract(_).divideBy(2),b=this.project(n.getSouthWest(),y),_=this.project(n.getNorthEast(),y),{center:this.unproject(b.add(_).divideBy(2).add(l),y),zoom:y})},fitBounds:function(n,l){if((n=j(n)).isValid())return n=this._getBoundsCenterZoom(n,l),this.setView(n.center,n.zoom,l);throw new Error("Bounds are not valid.")},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,l){return this.setView(n,this._zoom,{pan:l})},panBy:function(n,l){var _;return l=l||{},(n=R(n).round()).x||n.y?(l.animate===!0||this.getSize().contains(n)?(this._panAnim||(this._panAnim=new Un,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),l.noMoveStart||this.fire("movestart"),l.animate!==!1?(Te(this._mapPane,"leaflet-pan-anim"),_=this._getMapPanePos().subtract(n).round(),this._panAnim.run(this._mapPane,_,l.duration||.25,l.easeLinearity)):(this._rawPanBy(n),this.fire("move").fire("moveend"))):this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this):this.fire("moveend")},flyTo:function(n,l,_){if((_=_||{}).animate===!1||!pe.any3d)return this.setView(n,l,_);this._stop();var b=this.project(this.getCenter()),y=this.project(n),B=this.getSize(),K=this._zoom,Y=(n=H(n),l=l===void 0?K:l,Math.max(B.x,B.y)),se=Y*this.getZoomScale(K,l),ce=y.distanceTo(b)||1,be=1.42,xe=be*be;function $e(Ne){return Ne=(se*se-Y*Y+(Ne?-1:1)*xe*xe*ce*ce)/(2*(Ne?se:Y)*xe*ce),Ne=Math.sqrt(Ne*Ne+1)-Ne,Ne<1e-9?-18:Math.log(Ne)}function Ae(Ne){return(Math.exp(Ne)-Math.exp(-Ne))/2}function Qe(Ne){return(Math.exp(Ne)+Math.exp(-Ne))/2}var Ye=$e(0);function et(Ne){return Y*(Qe(Ye)*(Ae(Ne=Ye+be*Ne)/Qe(Ne))-Ae(Ye))/xe}var wi=Date.now(),gi=($e(1)-Ye)/be,ki=_.duration?1e3*_.duration:1e3*gi*.8;return this._moveStart(!0,_.noMoveStart),(function Ne(){var yn=(Date.now()-wi)/ki,bi=(1-Math.pow(1-yn,1.5))*gi;yn<=1?(this._flyToFrame=F(Ne,this),this._move(this.unproject(b.add(y.subtract(b).multiplyBy(et(bi)/ce)),K),this.getScaleZoom(Y/(yn=bi,Y*(Qe(Ye)/Qe(Ye+be*yn))),K),{flyTo:!0})):this._move(n,l)._moveEnd(!0)}).call(this),this},flyToBounds:function(n,l){return n=this._getBoundsCenterZoom(n,l),this.flyTo(n.center,n.zoom,l)},setMaxBounds:function(n){return n=j(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var l=this.options.minZoom;return this.options.minZoom=n,this._loaded&&l!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var l=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&l!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(b,l){this._enforcingBounds=!0;var _=this.getCenter(),b=this._limitCenter(_,this._zoom,j(b));return _.equals(b)||this.panTo(b,l),this._enforcingBounds=!1,this},panInside:function(y,l){var B=R((l=l||{}).paddingTopLeft||l.padding||[0,0]),_=R(l.paddingBottomRight||l.padding||[0,0]),b=this.project(this.getCenter()),y=this.project(y),K=this.getPixelBounds(),B=z([K.min.add(B),K.max.subtract(_)]),K=B.getSize();return B.contains(y)||(this._enforcingBounds=!0,_=y.subtract(B.getCenter()),B=B.extend(y).getSize().subtract(K),b.x+=_.x<0?-B.x:B.x,b.y+=_.y<0?-B.y:B.y,this.panTo(this.unproject(b),l),this._enforcingBounds=!1),this},invalidateSize:function(n){if(!this._loaded)return this;n=i({animate:!1,pan:!0},n===!0?{animate:!0}:n);var l=this.getSize(),_=(this._sizeChanged=!0,this._lastCenter=null,this.getSize()),y=l.divideBy(2).round(),b=_.divideBy(2).round(),y=y.subtract(b);return y.x||y.y?(n.animate&&n.pan?this.panBy(y):(n.pan&&this._rawPanBy(y),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:l,newSize:_})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){var l,_;return n=this._locateOptions=i({timeout:1e4,watch:!1},n),"geolocation"in navigator?(l=c(this._handleGeolocationResponse,this),_=c(this._handleGeolocationError,this),n.watch?this._locationWatchId=navigator.geolocation.watchPosition(l,_,n):navigator.geolocation.getCurrentPosition(l,_,n)):this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){var l;this._container._leaflet_id&&(l=n.code,n=n.message||(l===1?"permission denied":l===2?"position unavailable":"timeout"),this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:l,message:"Geolocation error: "+n+"."}))},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var l,_,b=new V(n.coords.latitude,n.coords.longitude),y=b.toBounds(2*n.coords.accuracy),B=this._locateOptions,K=(B.setView&&(l=this.getBoundsZoom(y),this.setView(b,B.maxZoom?Math.min(l,B.maxZoom):l)),{latlng:b,bounds:y,timestamp:n.timestamp});for(_ in n.coords)typeof n.coords[_]=="number"&&(K[_]=n.coords[_]);this.fire("locationfound",K)}},addHandler:function(n,l){return l&&(l=this[n]=new l(this),this._handlers.push(l),this.options[n]&&l.enable()),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}for(var n in this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Be(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(A(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[n].remove();for(n in this._panes)Be(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,l){return l=Me("div","leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),l||this._mapPane),n&&(this._panes[n]=l),l},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds();return new C(this.unproject(n.getBottomLeft()),this.unproject(n.getTopRight()))},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(se,l,Y){se=j(se),Y=R(Y||[0,0]);var ce=this.getZoom()||0,b=this.getMinZoom(),y=this.getMaxZoom(),B=se.getNorthWest(),se=se.getSouthEast(),Y=this.getSize().subtract(Y),se=z(this.project(se,ce),this.project(B,ce)).getSize(),B=pe.any3d?this.options.zoomSnap:1,K=Y.x/se.x,Y=Y.y/se.y,se=l?Math.max(K,Y):Math.min(K,Y),ce=this.getScaleZoom(se,ce);return B&&(ce=Math.round(ce/(B/100))*(B/100),ce=l?Math.ceil(ce/B)*B:Math.floor(ce/B)*B),Math.max(b,Math.min(y,ce))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new N(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,l){return n=this._getTopLeftPoint(n,l),new U(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,l){var _=this.options.crs;return l=l===void 0?this._zoom:l,_.scale(n)/_.scale(l)},getScaleZoom:function(b,l){var _=this.options.crs,b=(l=l===void 0?this._zoom:l,_.zoom(b*_.scale(l)));return isNaN(b)?1/0:b},project:function(n,l){return l=l===void 0?this._zoom:l,this.options.crs.latLngToPoint(H(n),l)},unproject:function(n,l){return l=l===void 0?this._zoom:l,this.options.crs.pointToLatLng(R(n),l)},layerPointToLatLng:function(n){return n=R(n).add(this.getPixelOrigin()),this.unproject(n)},latLngToLayerPoint:function(n){return this.project(H(n))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(H(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(j(n))},distance:function(n,l){return this.options.crs.distance(H(n),H(l))},containerPointToLayerPoint:function(n){return R(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return R(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){return n=this.containerPointToLayerPoint(R(n)),this.layerPointToLatLng(n)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(H(n)))},mouseEventToContainerPoint:function(n){return Wn(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){if(n=this._container=Rn(n),!n)throw new Error("Map container not found.");if(n._leaflet_id)throw new Error("Map container is already initialized.");we(n,"scroll",this._onScroll,this),this._containerId=u(n)},_initLayout:function(){var n=this._container,l=(this._fadeAnimated=this.options.fadeAnimation&&pe.any3d,Te(n,"leaflet-container"+(pe.touch?" leaflet-touch":"")+(pe.retina?" leaflet-retina":"")+(pe.ielt9?" leaflet-oldie":"")+(pe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":"")),Zt(n,"position"));l!=="absolute"&&l!=="relative"&&l!=="fixed"&&l!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),We(this._mapPane,new N(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Te(n.markerPane,"leaflet-zoom-hide"),Te(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,l,_){We(this._mapPane,new N(0,0));var b=!this._loaded,y=(this._loaded=!0,l=this._limitZoom(l),this.fire("viewprereset"),this._zoom!==l);this._moveStart(y,_)._move(n,l)._moveEnd(y),this.fire("viewreset"),b&&this.fire("load")},_moveStart:function(n,l){return n&&this.fire("zoomstart"),l||this.fire("movestart"),this},_move:function(n,l,_,b){l===void 0&&(l=this._zoom);var y=this._zoom!==l;return this._zoom=l,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),b?_&&_.pinch&&this.fire("zoom",_):((y||_&&_.pinch)&&this.fire("zoom",_),this.fire("move",_)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return A(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){We(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={};var l=n?Ce:we;l((this._targets[u(this._container)]=this)._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&l(window,"resize",this._onResize,this),pe.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){A(this._resizeRequest),this._resizeRequest=F(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,l){for(var _,b=[],y=l==="mouseout"||l==="mouseover",B=n.target||n.srcElement,K=!1;B;){if((_=this._targets[u(B)])&&(l==="click"||l==="preclick")&&this._draggableMoved(_)){K=!0;break}if(_&&_.listens(l,!0)&&(y&&!zn(B,n)||(b.push(_),y))||B===this._container)break;B=B.parentNode}return b=b.length||K||y||!this.listens(l,!0)?b:[this]},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var l,_=n.target||n.srcElement;!this._loaded||_._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(_)||((l=n.type)==="mousedown"&&Pn(_),this._fireDOMEvent(n,l))},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,l,_){n.type==="click"&&((Y=i({},n)).type="preclick",this._fireDOMEvent(Y,Y.type,_));var b=this._findEventTargets(n,l);if(_){for(var y=[],B=0;B<_.length;B++)_[B].listens(l,!0)&&y.push(_[B]);b=y.concat(b)}if(b.length){l==="contextmenu"&&Ve(n);var K,Y=b[0],se={originalEvent:n};for(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"&&(K=Y.getLatLng&&(!Y._radius||Y._radius<=10),se.containerPoint=K?this.latLngToContainerPoint(Y.getLatLng()):this.mouseEventToContainerPoint(n),se.layerPoint=this.containerPointToLayerPoint(se.containerPoint),se.latlng=K?Y.getLatLng():this.layerPointToLatLng(se.layerPoint)),B=0;B<b.length;B++)if(b[B].fire(l,se,!0),se.originalEvent._stopped||b[B].options.bubblingMouseEvents===!1&&P(this._mouseEvents,l)!==-1)return}},_draggableMoved:function(n){return(n=n.dragging&&n.dragging.enabled()?n:this).dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,l=this._handlers.length;n<l;n++)this._handlers[n].disable()},whenReady:function(n,l){return this._loaded?n.call(l||this,{target:this}):this.on("load",n,l),this},_getMapPanePos:function(){return kt(this._mapPane)||new N(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,l){return(n&&l!==void 0?this._getNewPixelOrigin(n,l):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,l){var _=this.getSize()._divideBy(2);return this.project(n,l)._subtract(_)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,l,_){return _=this._getNewPixelOrigin(_,l),this.project(n,l)._subtract(_)},_latLngBoundsToNewLayerBounds:function(n,l,_){return _=this._getNewPixelOrigin(_,l),z([this.project(n.getSouthWest(),l)._subtract(_),this.project(n.getNorthWest(),l)._subtract(_),this.project(n.getSouthEast(),l)._subtract(_),this.project(n.getNorthEast(),l)._subtract(_)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,l,_){var b,y;return!_||(b=this.project(n,l),y=this.getSize().divideBy(2),y=new U(b.subtract(y),b.add(y)),y=this._getBoundsOffset(y,_,l),Math.abs(y.x)<=1&&Math.abs(y.y)<=1)?n:this.unproject(b.add(y),l)},_limitOffset:function(n,l){var _;return l?(_=new U((_=this.getPixelBounds()).min.add(n),_.max.add(n)),n.add(this._getBoundsOffset(_,l))):n},_getBoundsOffset:function(n,l,_){return l=z(this.project(l.getNorthEast(),_),this.project(l.getSouthWest(),_)),_=l.min.subtract(n.min),l=l.max.subtract(n.max),new N(this._rebound(_.x,-l.x),this._rebound(_.y,-l.y))},_rebound:function(n,l){return 0<n+l?Math.round(n-l)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(l))},_limitZoom:function(n){var l=this.getMinZoom(),_=this.getMaxZoom(),b=pe.any3d?this.options.zoomSnap:1;return b&&(n=Math.round(n/b)*b),Math.max(l,Math.min(_,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){qe(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,l){return n=this._getCenterOffset(n)._trunc(),!((l&&l.animate)!==!0&&!this.getSize().contains(n))&&(this.panBy(n,l),!0)},_createAnimProxy:function(){var n=this._proxy=Me("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(l){var _=At,b=this._proxy.style[_];wt(this._proxy,this.project(l.center,l.zoom),this.getZoomScale(l.zoom,1)),b===this._proxy.style[_]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Be(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),l=this.getZoom();wt(this._proxy,this.project(n,l),this.getZoomScale(l,1))},_catchTransitionEnd:function(n){this._animatingZoom&&0<=n.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,l,_){if(!this._animatingZoom){if(_=_||{},!this._zoomAnimated||_.animate===!1||this._nothingToAnimate()||Math.abs(l-this._zoom)>this.options.zoomAnimationThreshold)return!1;var b=this.getZoomScale(l),b=this._getCenterOffset(n)._divideBy(1-1/b);if(_.animate!==!0&&!this.getSize().contains(b))return!1;F(function(){this._moveStart(!0,_.noMoveStart||!1)._animateZoom(n,l,!0)},this)}return!0},_animateZoom:function(n,l,_,b){this._mapPane&&(_&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=l,Te(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:l,noUpdate:b}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&qe(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Dt(n){return new st(n)}var st=I.extend({options:{position:"topright"},initialize:function(n){v(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var l=this._map;return l&&l.removeControl(this),this.options.position=n,l&&l.addControl(this),this},getContainer:function(){return this._container},addTo:function(b){this.remove(),this._map=b;var l=this._container=this.onAdd(b),_=this.getPosition(),b=b._controlCorners[_];return Te(l,"leaflet-control"),_.indexOf("bottom")!==-1?b.insertBefore(l,b.firstChild):b.appendChild(l),this._map.on("unload",this.remove,this),this},remove:function(){return this._map&&(Be(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null),this},_refocusOnMap:function(n){this._map&&n&&0<n.screenX&&0<n.screenY&&this._map.getContainer().focus()}}),Vn=(Ee.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},l="leaflet-",_=this._controlContainer=Me("div",l+"control-container",this._container);function b(y,B){n[y+B]=Me("div",l+y+" "+l+B,_)}b("top","left"),b("top","right"),b("bottom","left"),b("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)Be(this._controlCorners[n]);Be(this._controlContainer),delete this._controlCorners,delete this._controlContainer}}),st.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,l,_,b){return _<b?-1:b<_?1:0}},initialize:function(n,l,_){for(var b in v(this,_),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1,n)this._addLayer(n[b],b);for(b in l)this._addLayer(l[b],b,!0)},onAdd:function(n){this._initLayout(),this._update(),(this._map=n).on("zoomend",this._checkDisabledLayers,this);for(var l=0;l<this._layers.length;l++)this._layers[l].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return st.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,l){return this._addLayer(n,l),this._map?this._update():this},addOverlay:function(n,l){return this._addLayer(n,l,!0),this._map?this._update():this},removeLayer:function(n){return n.off("add remove",this._onLayerChange,this),n=this._getLayer(u(n)),n&&this._layers.splice(this._layers.indexOf(n),1),this._map?this._update():this},expand:function(){Te(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(Te(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):qe(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return qe(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",l=this._container=Me("div",n),_=this.options.collapsed,b=(l.setAttribute("aria-haspopup",!0),Bt(l),Sn(l),this._section=Me("section",n+"-list")),y=(_&&(this._map.on("click",this.collapse,this),we(l,{mouseenter:this._expandSafely,mouseleave:this.collapse},this)),this._layersLink=Me("a",n+"-toggle",l));y.href="#",y.title="Layers",y.setAttribute("role","button"),we(y,{keydown:function(B){B.keyCode===13&&this._expandSafely()},click:function(B){Ve(B),this._expandSafely()}},this),_||this.expand(),this._baseLayersList=Me("div",n+"-base",b),this._separator=Me("div",n+"-separator",b),this._overlaysList=Me("div",n+"-overlays",b),l.appendChild(b)},_getLayer:function(n){for(var l=0;l<this._layers.length;l++)if(this._layers[l]&&u(this._layers[l].layer)===n)return this._layers[l]},_addLayer:function(n,l,_){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:l,overlay:_}),this.options.sortLayers&&this._layers.sort(c(function(b,y){return this.options.sortFunction(b.layer,y.layer,b.name,y.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(this._container){Kt(this._baseLayersList),Kt(this._overlaysList),this._layerControlInputs=[];for(var n,l,_,b=0,y=0;y<this._layers.length;y++)_=this._layers[y],this._addItem(_),l=l||_.overlay,n=n||!_.overlay,b+=_.overlay?0:1;this.options.hideSingleBase&&(this._baseLayersList.style.display=(n=n&&1<b)?"":"none"),this._separator.style.display=l&&n?"":"none"}return this},_onLayerChange:function(_){this._handlingClick||this._update();var l=this._getLayer(u(_.target)),_=l.overlay?_.type==="add"?"overlayadd":"overlayremove":_.type==="add"?"baselayerchange":null;_&&this._map.fire(_,l)},_createRadioElement:function(n,l){return n='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(l?' checked="checked"':"")+"/>",l=document.createElement("div"),l.innerHTML=n,l.firstChild},_addItem:function(n){var l,_=document.createElement("label"),b=this._map.hasLayer(n.layer),b=(n.overlay?((l=document.createElement("input")).type="checkbox",l.className="leaflet-control-layers-selector",l.defaultChecked=b):l=this._createRadioElement("leaflet-base-layers_"+u(this),b),this._layerControlInputs.push(l),l.layerId=u(n.layer),we(l,"click",this._onInputClick,this),document.createElement("span")),y=(b.innerHTML=" "+n.name,document.createElement("span"));return _.appendChild(y),y.appendChild(l),y.appendChild(b),(n.overlay?this._overlaysList:this._baseLayersList).appendChild(_),this._checkDisabledLayers(),_},_onInputClick:function(){if(!this._preventClick){var n,l,_=this._layerControlInputs,b=[],y=[];this._handlingClick=!0;for(var B=_.length-1;0<=B;B--)n=_[B],l=this._getLayer(n.layerId).layer,n.checked?b.push(l):n.checked||y.push(l);for(B=0;B<y.length;B++)this._map.hasLayer(y[B])&&this._map.removeLayer(y[B]);for(B=0;B<b.length;B++)this._map.hasLayer(b[B])||this._map.addLayer(b[B]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n,l,_=this._layerControlInputs,b=this._map.getZoom(),y=_.length-1;0<=y;y--)n=_[y],l=this._getLayer(n.layerId).layer,n.disabled=l.options.minZoom!==void 0&&b<l.options.minZoom||l.options.maxZoom!==void 0&&b>l.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section,l=(this._preventClick=!0,we(n,"click",Ve),this.expand(),this);setTimeout(function(){Ce(n,"click",Ve),l._preventClick=!1})}})),On=st.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var l="leaflet-control-zoom",_=Me("div",l+" leaflet-bar"),b=this.options;return this._zoomInButton=this._createButton(b.zoomInText,b.zoomInTitle,l+"-in",_,this._zoomIn),this._zoomOutButton=this._createButton(b.zoomOutText,b.zoomOutTitle,l+"-out",_,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),_},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,l,_,b,y){return _=Me("a",_,b),_.innerHTML=n,_.href="#",_.title=l,_.setAttribute("role","button"),_.setAttribute("aria-label",l),Bt(_),we(_,"click",$t),we(_,"click",y,this),we(_,"click",this._refocusOnMap,this),_},_updateDisabled:function(){var n=this._map,l="leaflet-disabled";qe(this._zoomInButton,l),qe(this._zoomOutButton,l),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),!this._disabled&&n._zoom!==n.getMinZoom()||(Te(this._zoomOutButton,l),this._zoomOutButton.setAttribute("aria-disabled","true")),!this._disabled&&n._zoom!==n.getMaxZoom()||(Te(this._zoomInButton,l),this._zoomInButton.setAttribute("aria-disabled","true"))}}),Gn=(Ee.mergeOptions({zoomControl:!0}),Ee.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new On,this.addControl(this.zoomControl))}),st.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var l="leaflet-control-scale",_=Me("div",l),b=this.options;return this._addScales(b,l+"-line",_),n.on(b.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),_},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,l,_){n.metric&&(this._mScale=Me("div",l,_)),n.imperial&&(this._iScale=Me("div",l,_))},_update:function(){var l=this._map,n=l.getSize().y/2,l=l.distance(l.containerPointToLatLng([0,n]),l.containerPointToLatLng([this.options.maxWidth,n]));this._updateScales(l)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var l=this._getRoundNum(n);this._updateScale(this._mScale,l<1e3?l+" m":l/1e3+" km",l/n)},_updateImperial:function(b){var l,_,b=3.2808399*b;5280<b?(_=this._getRoundNum(l=b/5280),this._updateScale(this._iScale,_+" mi",_/l)):(_=this._getRoundNum(b),this._updateScale(this._iScale,_+" ft",_/b))},_updateScale:function(n,l,_){n.style.width=Math.round(this.options.maxWidth*_)+"px",n.innerHTML=l},_getRoundNum:function(_){var l=Math.pow(10,(Math.floor(_)+"").length-1),_=_/l;return l*(_=10<=_?10:5<=_?5:3<=_?3:2<=_?2:1)}})),jn=st.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(pe.inlineSvg?'<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg> ':"")+"Leaflet</a>"},initialize:function(n){v(this,n),this._attributions={}},onAdd:function(n){for(var l in(n.attributionControl=this)._container=Me("div","leaflet-control-attribution"),Bt(this._container),n._layers)n._layers[l].getAttribution&&this.addAttribution(n._layers[l].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n&&(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update()),this},removeAttribution:function(n){return n&&this._attributions[n]&&(this._attributions[n]--,this._update()),this},_update:function(){if(this._map){var n,l=[];for(n in this._attributions)this._attributions[n]&&l.push(n);var _=[];this.options.prefix&&_.push(this.options.prefix),l.length&&_.push(l.join(", ")),this._container.innerHTML=_.join(' <span aria-hidden="true">|</span> ')}}}),Je=(Ee.mergeOptions({attributionControl:!0}),Ee.addInitHook(function(){this.options.attributionControl&&new jn().addTo(this)}),st.Layers=Vn,st.Zoom=On,st.Scale=Gn,st.Attribution=jn,Dt.layers=function(n,l,_){return new Vn(n,l,_)},Dt.zoom=function(n){return new On(n)},Dt.scale=function(n){return new Gn(n)},Dt.attribution=function(n){return new jn(n)},I.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled&&(this._enabled=!1,this.removeHooks()),this},enabled:function(){return!!this._enabled}})),Rt=(Je.addTo=function(n,l){return n.addHandler(l,this),this},{Events:D}),Yn=pe.touch?"touchstart mousedown":"mousedown",bt=X.extend({options:{clickTolerance:3},initialize:function(n,l,_,b){v(this,b),this._element=n,this._dragStartTarget=l||n,this._preventOutline=_},enable:function(){this._enabled||(we(this._dragStartTarget,Yn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(bt._dragging===this&&this.finishDrag(!0),Ce(this._dragStartTarget,Yn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){var l,_;this._enabled&&(this._moved=!1,wn(this._element,"leaflet-zoom-anim")||(n.touches&&n.touches.length!==1?bt._dragging===this&&this.finishDrag():bt._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches||((bt._dragging=this)._preventOutline&&Pn(this._element),xn(),mt(),this._moving||(this.fire("down"),_=n.touches?n.touches[0]:n,l=qn(this._element),this._startPoint=new N(_.clientX,_.clientY),this._startPos=kt(this._element),this._parentScale=Tn(l),_=n.type==="mousedown",we(document,_?"mousemove":"touchmove",this._onMove,this),we(document,_?"mouseup":"touchend touchcancel",this._onUp,this)))))},_onMove:function(n){var l;this._enabled&&(n.touches&&1<n.touches.length?this._moved=!0:!(l=new N((l=n.touches&&n.touches.length===1?n.touches[0]:n).clientX,l.clientY)._subtract(this._startPoint)).x&&!l.y||Math.abs(l.x)+Math.abs(l.y)<this.options.clickTolerance||(l.x/=this._parentScale.x,l.y/=this._parentScale.y,Ve(n),this._moved||(this.fire("dragstart"),this._moved=!0,Te(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Te(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(l),this._moving=!0,this._lastEvent=n,this._updatePosition()))},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),We(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){qe(document.body,"leaflet-dragging"),this._lastTarget&&(qe(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ce(document,"mousemove touchmove",this._onMove,this),Ce(document,"mouseup touchend touchcancel",this._onUp,this),$n(),ge();var l=this._moved&&this._moving;this._moving=!1,bt._dragging=!1,l&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function Kn(n,l,_){for(var b,y,B,K,Y,se,ce,be=[1,4,2,8],xe=0,$e=n.length;xe<$e;xe++)n[xe]._code=Pt(n[xe],l);for(B=0;B<4;B++){for(se=be[B],b=[],xe=0,y=($e=n.length)-1;xe<$e;y=xe++)K=n[xe],Y=n[y],K._code&se?Y._code&se||((ce=tn(Y,K,se,l,_))._code=Pt(ce,l),b.push(ce)):(Y._code&se&&((ce=tn(Y,K,se,l,_))._code=Pt(ce,l),b.push(ce)),b.push(K));n=b}return n}function Xn(n,l){var _,b,y,B,K,Y,se;if(!n||n.length===0)throw new Error("latlngs not passed");ot(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);for(var ce=H([0,0]),be=j(n),xe=(be.getNorthWest().distanceTo(be.getSouthWest())*be.getNorthEast().distanceTo(be.getNorthWest())<1700&&(ce=In(n)),n.length),$e=[],Ae=0;Ae<xe;Ae++){var Qe=H(n[Ae]);$e.push(l.project(H([Qe.lat-ce.lat,Qe.lng-ce.lng])))}for(Ae=K=Y=se=0,_=xe-1;Ae<xe;_=Ae++)b=$e[Ae],y=$e[_],B=b.y*y.x-y.y*b.x,Y+=(b.x+y.x)*B,se+=(b.y+y.y)*B,K+=3*B;return be=K===0?$e[0]:[Y/K,se/K],be=l.unproject(R(be)),H([be.lat+ce.lat,be.lng+ce.lng])}function In(n){for(var l=0,_=0,b=0,y=0;y<n.length;y++){var B=H(n[y]);l+=B.lat,_+=B.lng,b++}return H([l/b,_/b])}var Jn,en={__proto__:null,clipPolygon:Kn,polygonCenter:Xn,centroid:In};function Qn(n,l){if(l&&n.length){var _=n=function(Y,se){for(var ce=[Y[0]],be=1,xe=0,$e=Y.length;be<$e;be++)(function(Ae,et){var Ye=et.x-Ae.x,et=et.y-Ae.y;return Ye*Ye+et*et})(Y[be],Y[xe])>se&&(ce.push(Y[be]),xe=be);return xe<$e-1&&ce.push(Y[$e-1]),ce}(n,l=l*l),b=_.length,y=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(b);y[0]=y[b-1]=1,function Y(se,ce,be,xe,$e){var Ae,Qe,Ye,et=0;for(Qe=xe+1;Qe<=$e-1;Qe++)Ye=qt(se[Qe],se[xe],se[$e],!0),et<Ye&&(Ae=Qe,et=Ye);be<et&&(ce[Ae]=1,Y(se,ce,be,xe,Ae),Y(se,ce,be,Ae,$e))}(_,y,l,0,b-1);var B,K=[];for(B=0;B<b;B++)y[B]&&K.push(_[B]);return K}return n.slice()}function ei(n,l,_){return Math.sqrt(qt(n,l,_,!0))}function ti(n,l,_,b,y){var B,K,Y,se=b?Jn:Pt(n,_),ce=Pt(l,_);for(Jn=ce;;){if(!(se|ce))return[n,l];if(se&ce)return!1;Y=Pt(K=tn(n,l,B=se||ce,_,y),_),B===se?(n=K,se=Y):(l=K,ce=Y)}}function tn(n,se,_,be,y){var B,K,Y=se.x-n.x,se=se.y-n.y,ce=be.min,be=be.max;return 8&_?(B=n.x+Y*(be.y-n.y)/se,K=be.y):4&_?(B=n.x+Y*(ce.y-n.y)/se,K=ce.y):2&_?(B=be.x,K=n.y+se*(be.x-n.x)/Y):1&_&&(B=ce.x,K=n.y+se*(ce.x-n.x)/Y),new N(B,K,y)}function Pt(n,l){var _=0;return n.x<l.min.x?_|=1:n.x>l.max.x&&(_|=2),n.y<l.min.y?_|=4:n.y>l.max.y&&(_|=8),_}function qt(n,B,_,b){var y=B.x,B=B.y,K=_.x-y,Y=_.y-B,se=K*K+Y*Y;return 0<se&&(1<(se=((n.x-y)*K+(n.y-B)*Y)/se)?(y=_.x,B=_.y):0<se&&(y+=K*se,B+=Y*se)),K=n.x-y,Y=n.y-B,b?K*K+Y*Y:new N(y,B)}function ot(n){return!T(n[0])||typeof n[0][0]!="object"&&n[0][0]!==void 0}function ni(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ot(n)}function ii(n,l){var _,b,y,B,K,Y;if(!n||n.length===0)throw new Error("latlngs not passed");ot(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);for(var se=H([0,0]),ce=j(n),be=(ce.getNorthWest().distanceTo(ce.getSouthWest())*ce.getNorthEast().distanceTo(ce.getNorthWest())<1700&&(se=In(n)),n.length),xe=[],$e=0;$e<be;$e++){var Ae=H(n[$e]);xe.push(l.project(H([Ae.lat-se.lat,Ae.lng-se.lng])))}for(_=$e=0;$e<be-1;$e++)_+=xe[$e].distanceTo(xe[$e+1])/2;if(_===0)Y=xe[0];else for(b=$e=0;$e<be-1;$e++)if(y=xe[$e],B=xe[$e+1],_<(b+=K=y.distanceTo(B))){Y=[B.x-(K=(b-_)/K)*(B.x-y.x),B.y-K*(B.y-y.y)];break}return ce=l.unproject(R(Y)),H([ce.lat+se.lat,ce.lng+se.lng])}var nn={__proto__:null,simplify:Qn,pointToSegmentDistance:ei,closestPointOnSegment:function(n,l,_){return qt(n,l,_)},clipSegment:ti,_getEdgeIntersection:tn,_getBitCode:Pt,_sqClosestPointOnSegment:qt,isFlat:ot,_flat:ni,polylineCenter:ii},Tt={project:function(n){return new N(n.lng,n.lat)},unproject:function(n){return new V(n.y,n.x)},bounds:new U([-180,-90],[180,90])},Lt={R:6378137,R_MINOR:6356752314245179e-9,bounds:new U([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var l=Math.PI/180,_=this.R,B=n.lat*l,b=this.R_MINOR/_,b=Math.sqrt(1-b*b),y=b*Math.sin(B),y=Math.tan(Math.PI/4-B/2)/Math.pow((1-y)/(1+y),b/2),B=-_*Math.log(Math.max(y,1e-10));return new N(n.lng*l*_,B)},unproject:function(n){for(var l,_=180/Math.PI,b=this.R,y=this.R_MINOR/b,B=Math.sqrt(1-y*y),K=Math.exp(-n.y/b),Y=Math.PI/2-2*Math.atan(K),se=0,ce=.1;se<15&&1e-7<Math.abs(ce);se++)l=B*Math.sin(Y),l=Math.pow((1-l)/(1+l),B/2),Y+=ce=Math.PI/2-2*Math.atan(K*l)-Y;return new V(Y*_,n.x*_/b)}},on={__proto__:null,LonLat:Tt,Mercator:Lt,SphericalMercator:re},An=i({},ee,{code:"EPSG:3395",projection:Lt,transformation:oe(te=.5/(Math.PI*Lt.R),.5,-te,.5)}),oi=i({},ee,{code:"EPSG:4326",projection:Tt,transformation:oe(1/180,1,-1/180,.5)}),rn=i({},G,{projection:Tt,transformation:oe(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,b){var _=b.lng-n.lng,b=b.lat-n.lat;return Math.sqrt(_*_+b*b)},infinite:!0}),Ke=(G.Earth=ee,G.EPSG3395=An,G.EPSG3857=le,G.EPSG900913=fe,G.EPSG4326=oi,G.Simple=rn,X.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[u(n)]=this},removeInteractiveTarget:function(n){return delete this._map._targets[u(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var l,_=n.target;_.hasLayer(this)&&(this._map=_,this._zoomAnimated=_._zoomAnimated,this.getEvents&&(l=this.getEvents(),_.on(l,this),this.once("remove",function(){_.off(l,this)},this)),this.onAdd(_),this.fire("add"),_.fire("layeradd",{layer:this}))}})),zt=(Ee.include({addLayer:function(n){var l;if(n._layerAdd)return l=u(n),this._layers[l]||((this._layers[l]=n)._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n)),this;throw new Error("The provided object is not a Layer.")},removeLayer:function(n){var l=u(n);return this._layers[l]&&(this._loaded&&n.onRemove(this),delete this._layers[l],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null),this},hasLayer:function(n){return u(n)in this._layers},eachLayer:function(n,l){for(var _ in this._layers)n.call(l,this._layers[_]);return this},_addLayers:function(n){for(var l=0,_=(n=n?T(n)?n:[n]:[]).length;l<_;l++)this.addLayer(n[l])},_addZoomLimit:function(n){isNaN(n.options.maxZoom)&&isNaN(n.options.minZoom)||(this._zoomBoundLayers[u(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){n=u(n),this._zoomBoundLayers[n]&&(delete this._zoomBoundLayers[n],this._updateZoomLevels())},_updateZoomLevels:function(){var n,l=1/0,_=-1/0,b=this._getZoomSpan();for(n in this._zoomBoundLayers)var y=this._zoomBoundLayers[n].options,l=y.minZoom===void 0?l:Math.min(l,y.minZoom),_=y.maxZoom===void 0?_:Math.max(_,y.maxZoom);this._layersMaxZoom=_===-1/0?void 0:_,this._layersMinZoom=l===1/0?void 0:l,b!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}}),Ke.extend({initialize:function(n,l){var _,b;if(v(this,l),this._layers={},n)for(_=0,b=n.length;_<b;_++)this.addLayer(n[_])},addLayer:function(n){var l=this.getLayerId(n);return this._layers[l]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){return n=n in this._layers?n:this.getLayerId(n),this._map&&this._layers[n]&&this._map.removeLayer(this._layers[n]),delete this._layers[n],this},hasLayer:function(n){return(typeof n=="number"?n:this.getLayerId(n))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var l,_,b=Array.prototype.slice.call(arguments,1);for(l in this._layers)(_=this._layers[l])[n]&&_[n].apply(_,b);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,l){for(var _ in this._layers)n.call(l,this._layers[_]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:u})),ft=zt.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),zt.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?((n=n in this._layers?this._layers[n]:n).removeEventParent(this),zt.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n,l=new C;for(n in this._layers){var _=this._layers[n];l.extend(_.getBounds?_.getBounds():_.getLatLng())}return l}}),Ct=I.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){v(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,l){var _=this._getIconUrl(n);if(_)return _=this._createImg(_,l&&l.tagName==="IMG"?l:null),this._setIconStyles(_,n),!this.options.crossOrigin&&this.options.crossOrigin!==""||(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),_;if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null},_setIconStyles:function(n,l){var _=this.options,b=_[l+"Size"],b=R(b=typeof b=="number"?[b,b]:b),y=R(l==="shadow"&&_.shadowAnchor||_.iconAnchor||b&&b.divideBy(2,!0));n.className="leaflet-marker-"+l+" "+(_.className||""),y&&(n.style.marginLeft=-y.x+"px",n.style.marginTop=-y.y+"px"),b&&(n.style.width=b.x+"px",n.style.height=b.y+"px")},_createImg:function(n,l){return(l=l||document.createElement("img")).src=n,l},_getIconUrl:function(n){return pe.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}}),Nt=Ct.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof Nt.imagePath!="string"&&(Nt.imagePath=this._detectIconPath()),(this.options.imagePath||Nt.imagePath)+Ct.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){function l(_,b,y){return(b=b.exec(_))&&b[y]}return(n=l(n,/^url\((['"])?(.+)\1\)$/,2))&&l(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=Me("div","leaflet-default-icon-path",document.body),l=Zt(n,"background-image")||Zt(n,"backgroundImage");return document.body.removeChild(n),(l=this._stripUrl(l))?l:(n=document.querySelector('link[href$="leaflet.css"]'))?n.href.substring(0,n.href.length-11-1):""}}),ri=Je.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new bt(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Te(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&qe(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var l=this._marker,_=l._map,b=this._marker.options.autoPanSpeed,y=this._marker.options.autoPanPadding,B=kt(l._icon),K=_.getPixelBounds(),Y=_.getPixelOrigin(),Y=z(K.min._subtract(Y).add(y),K.max._subtract(Y).subtract(y));Y.contains(B)||(y=R((Math.max(Y.max.x,B.x)-Y.max.x)/(K.max.x-Y.max.x)-(Math.min(Y.min.x,B.x)-Y.min.x)/(K.min.x-Y.min.x),(Math.max(Y.max.y,B.y)-Y.max.y)/(K.max.y-Y.max.y)-(Math.min(Y.min.y,B.y)-Y.min.y)/(K.min.y-Y.min.y)).multiplyBy(b),_.panBy(y,{animate:!1}),this._draggable._newPos._add(y),this._draggable._startPos._add(y),We(l._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=F(this._adjustPan.bind(this,n)))},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(A(this._panRequest),this._panRequest=F(this._adjustPan.bind(this,n)))},_onDrag:function(n){var l=this._marker,_=l._shadow,b=kt(l._icon),y=l._map.layerPointToLatLng(b);_&&We(_,b),l._latlng=y,n.latlng=y,n.oldLatLng=this._oldLatLng,l.fire("move",n).fire("drag",n)},_onDragEnd:function(n){A(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),sn=Ke.extend({options:{icon:new Nt,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,l){v(this,l),this._latlng=H(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var l=this._latlng;return this._latlng=H(n),this.update(),this.fire("move",{oldLatLng:l,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){var n;return this._icon&&this._map&&(n=this._map.latLngToLayerPoint(this._latlng).round(),this._setPos(n)),this},_initIcon:function(){var n=this.options,l="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),b=n.icon.createIcon(this._icon),_=!1,b=(b!==this._icon&&(this._icon&&this._removeIcon(),_=!0,n.title&&(b.title=n.title),b.tagName==="IMG"&&(b.alt=n.alt||"")),Te(b,l),n.keyboard&&(b.tabIndex="0",b.setAttribute("role","button")),this._icon=b,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&we(b,"focus",this._panOnFocus,this),n.icon.createShadow(this._shadow)),y=!1;b!==this._shadow&&(this._removeShadow(),y=!0),b&&(Te(b,l),b.alt=""),this._shadow=b,n.opacity<1&&this._updateOpacity(),_&&this.getPane().appendChild(this._icon),this._initInteraction(),b&&y&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ce(this._icon,"focus",this._panOnFocus,this),Be(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Be(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&We(this._icon,n),this._shadow&&We(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){n=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round(),this._setPos(n)},_initInteraction:function(){var n;this.options.interactive&&(Te(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ri&&(n=this.options.draggable,this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ri(this),n&&this.dragging.enable()))},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&it(this._icon,n),this._shadow&&it(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n,l,_=this._map;_&&(n=(l=this.options.icon.options).iconSize?R(l.iconSize):R(0,0),l=l.iconAnchor?R(l.iconAnchor):R(0,0),_.panInside(this._latlng,{paddingTopLeft:l,paddingBottomRight:n.subtract(l)}))},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),vt=Ke.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return v(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),an=vt.extend({options:{fill:!0,radius:10},initialize:function(n,l){v(this,l),this._latlng=H(n),this._radius=this.options.radius},setLatLng:function(n){var l=this._latlng;return this._latlng=H(n),this.redraw(),this.fire("move",{oldLatLng:l,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var l=n&&n.radius||this._radius;return vt.prototype.setStyle.call(this,n),this.setRadius(l),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var _=this._radius,n=this._radiusY||_,l=this._clickTolerance(),_=[_+l,n+l];this._pxBounds=new U(this._point.subtract(_),this._point.add(_))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),Zn=an.extend({initialize:function(n,l,_){if(v(this,l=typeof l=="number"?i({},_,{radius:l}):l),this._latlng=H(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new C(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:vt.prototype.setStyle,_project:function(){var n,l,_,b,y,B=this._latlng.lng,K=this._latlng.lat,Y=this._map,se=Y.options.crs;se.distance===ee.distance?(b=Math.PI/180,y=this._mRadius/ee.R/b,n=Y.project([K+y,B]),l=Y.project([K-y,B]),l=n.add(l).divideBy(2),_=Y.unproject(l).lat,b=Math.acos((Math.cos(y*b)-Math.sin(K*b)*Math.sin(_*b))/(Math.cos(K*b)*Math.cos(_*b)))/b,!isNaN(b)&&b!==0||(b=y/Math.cos(Math.PI/180*K)),this._point=l.subtract(Y.getPixelOrigin()),this._radius=isNaN(b)?0:l.x-Y.project([_,B-b]).x,this._radiusY=l.y-n.y):(y=se.unproject(se.project(this._latlng).subtract([this._mRadius,0])),this._point=Y.latLngToLayerPoint(this._latlng),this._radius=this._point.x-Y.latLngToLayerPoint(y).x),this._updateBounds()}}),_t=vt.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,l){v(this,l),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var l=1/0,_=null,b=qt,y=0,B=this._parts.length;y<B;y++)for(var K=this._parts[y],Y=1,se=K.length;Y<se;Y++){var ce,be,xe=b(n,ce=K[Y-1],be=K[Y],!0);xe<l&&(l=xe,_=b(n,ce,be))}return _&&(_.distance=Math.sqrt(l)),_},getCenter:function(){if(this._map)return ii(this._defaultShape(),this._map.options.crs);throw new Error("Must add layer to map before using getCenter()")},getBounds:function(){return this._bounds},addLatLng:function(n,l){return l=l||this._defaultShape(),n=H(n),l.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new C,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return ot(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var l=[],_=ot(n),b=0,y=n.length;b<y;b++)_?(l[b]=H(n[b]),this._bounds.extend(l[b])):l[b]=this._convertLatLngs(n[b]);return l},_project:function(){var n=new U;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),n=new N(n,n);this._rawPxBounds&&(this._pxBounds=new U([this._rawPxBounds.min.subtract(n),this._rawPxBounds.max.add(n)]))},_projectLatlngs:function(n,l,_){var b,y,B=n[0]instanceof V,K=n.length;if(B){for(y=[],b=0;b<K;b++)y[b]=this._map.latLngToLayerPoint(n[b]),_.extend(y[b]);l.push(y)}else for(b=0;b<K;b++)this._projectLatlngs(n[b],l,_)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(n))if(this.options.noClip)this._parts=this._rings;else for(var l,_,b,y,B=this._parts,K=0,Y=0,se=this._rings.length;K<se;K++)for(l=0,_=(y=this._rings[K]).length;l<_-1;l++)(b=ti(y[l],y[l+1],n,l,!0))&&(B[Y]=B[Y]||[],B[Y].push(b[0]),b[1]===y[l+1]&&l!==_-2||(B[Y].push(b[1]),Y++))},_simplifyPoints:function(){for(var n=this._parts,l=this.options.smoothFactor,_=0,b=n.length;_<b;_++)n[_]=Qn(n[_],l)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,l){var _,b,y,B,K,Y,se=this._clickTolerance();if(this._pxBounds&&this._pxBounds.contains(n)){for(_=0,B=this._parts.length;_<B;_++)for(b=0,y=(K=(Y=this._parts[_]).length)-1;b<K;y=b++)if((l||b!==0)&&ei(n,Y[y],Y[b])<=se)return!0}return!1}});_t._flat=ni;var Ot=_t.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(this._map)return Xn(this._defaultShape(),this._map.options.crs);throw new Error("Must add layer to map before using getCenter()")},_convertLatLngs:function(l){var l=_t.prototype._convertLatLngs.call(this,l),_=l.length;return 2<=_&&l[0]instanceof V&&l[0].equals(l[_-1])&&l.pop(),l},_setLatLngs:function(n){_t.prototype._setLatLngs.call(this,n),ot(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return(ot(this._latlngs[0])?this._latlngs:this._latlngs[0])[0]},_clipPoints:function(){var l=this._renderer._bounds,n=this.options.weight,n=new N(n,n),l=new U(l.min.subtract(n),l.max.add(n));if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(l))if(this.options.noClip)this._parts=this._rings;else for(var _,b=0,y=this._rings.length;b<y;b++)(_=Kn(this._rings[b],l,!0)).length&&this._parts.push(_)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var l,_,b,y,B,K,Y,se,ce=!1;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(y=0,Y=this._parts.length;y<Y;y++)for(B=0,K=(se=(l=this._parts[y]).length)-1;B<se;K=B++)_=l[B],b=l[K],_.y>n.y!=b.y>n.y&&n.x<(b.x-_.x)*(n.y-_.y)/(b.y-_.y)+_.x&&(ce=!ce);return ce||_t.prototype._containsPoint.call(this,n,!0)}}),pt=ft.extend({initialize:function(n,l){v(this,l),this._layers={},n&&this.addData(n)},addData:function(n){var l,_,b,y=T(n)?n:n.features;if(y){for(l=0,_=y.length;l<_;l++)((b=y[l]).geometries||b.geometry||b.features||b.coordinates)&&this.addData(b);return this}var B,K=this.options;return(!K.filter||K.filter(n))&&(B=ln(n,K))?(B.feature=fn(n),B.defaultOptions=B.options,this.resetStyle(B),K.onEachFeature&&K.onEachFeature(n,B),this.addLayer(B)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=i({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(l){this._setLayerStyle(l,n)},this)},_setLayerStyle:function(n,l){n.setStyle&&(typeof l=="function"&&(l=l(n.feature)),n.setStyle(l))}});function ln(n,l){var _,b,y,B,K=n.type==="Feature"?n.geometry:n,Y=K?K.coordinates:null,se=[],ce=l&&l.pointToLayer,be=l&&l.coordsToLatLng||Bn;if(!Y&&!K)return null;switch(K.type){case"Point":return si(ce,n,_=be(Y),l);case"MultiPoint":for(y=0,B=Y.length;y<B;y++)_=be(Y[y]),se.push(si(ce,n,_,l));return new ft(se);case"LineString":case"MultiLineString":return b=cn(Y,K.type==="LineString"?0:1,be),new _t(b,l);case"Polygon":case"MultiPolygon":return b=cn(Y,K.type==="Polygon"?1:2,be),new Ot(b,l);case"GeometryCollection":for(y=0,B=K.geometries.length;y<B;y++){var xe=ln({geometry:K.geometries[y],type:"Feature",properties:n.properties},l);xe&&se.push(xe)}return new ft(se);case"FeatureCollection":for(y=0,B=K.features.length;y<B;y++){var $e=ln(K.features[y],l);$e&&se.push($e)}return new ft(se);default:throw new Error("Invalid GeoJSON object.")}}function si(n,l,_,b){return n?n(l,_):new sn(_,b&&b.markersInheritOptions&&b)}function Bn(n){return new V(n[1],n[0],n[2])}function cn(n,l,_){for(var b,y=[],B=0,K=n.length;B<K;B++)b=l?cn(n[B],l-1,_):(_||Bn)(n[B]),y.push(b);return y}function Dn(n,l){return(n=H(n)).alt!==void 0?[m(n.lng,l),m(n.lat,l),m(n.alt,l)]:[m(n.lng,l),m(n.lat,l)]}function un(n,l,_,b){for(var y=[],B=0,K=n.length;B<K;B++)y.push(l?un(n[B],ot(n[B])?0:l-1,_,b):Dn(n[B],b));return!l&&_&&0<y.length&&y.push(y[0].slice()),y}function jt(n,l){return n.feature?i({},n.feature,{geometry:l}):fn(l)}function fn(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}J={toGeoJSON:function(n){return jt(this,{type:"Point",coordinates:Dn(this.getLatLng(),n)})}};function ai(n,l){return new pt(n,l)}sn.include(J),Zn.include(J),an.include(J),_t.include({toGeoJSON:function(n){var l=!ot(this._latlngs);return jt(this,{type:(l?"Multi":"")+"LineString",coordinates:un(this._latlngs,l?1:0,!1,n)})}}),Ot.include({toGeoJSON:function(b){var l=!ot(this._latlngs),_=l&&!ot(this._latlngs[0]),b=un(this._latlngs,_?2:l?1:0,!0,b);return jt(this,{type:(_?"Multi":"")+"Polygon",coordinates:b=l?b:[b]})}}),zt.include({toMultiPoint:function(n){var l=[];return this.eachLayer(function(_){l.push(_.toGeoJSON(n).geometry.coordinates)}),jt(this,{type:"MultiPoint",coordinates:l})},toGeoJSON:function(n){var l,_,b=this.feature&&this.feature.geometry&&this.feature.geometry.type;return b==="MultiPoint"?this.toMultiPoint(n):(l=b==="GeometryCollection",_=[],this.eachLayer(function(y){y.toGeoJSON&&(y=y.toGeoJSON(n),l?_.push(y.geometry):(y=fn(y)).type==="FeatureCollection"?_.push.apply(_,y.features):_.push(y))}),l?jt(this,{geometries:_,type:"GeometryCollection"}):{type:"FeatureCollection",features:_})}});var _n=ai,pn=Ke.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,l,_){this._url=n,this._bounds=j(l),v(this,_)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Te(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Be(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&Mt(this._image),this},bringToBack:function(){return this._map&&St(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=j(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",l=this._image=n?this._url:Me("img");Te(l,"leaflet-image-layer"),this._zoomAnimated&&Te(l,"leaflet-zoom-animated"),this.options.className&&Te(l,this.options.className),l.onselectstart=d,l.onmousemove=d,l.onload=c(this.fire,this,"load"),l.onerror=c(this._overlayOnError,this,"error"),!this.options.crossOrigin&&this.options.crossOrigin!==""||(l.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n?this._url=l.src:(l.src=this._url,l.alt=this.options.alt)},_animateZoom:function(_){var l=this._map.getZoomScale(_.zoom),_=this._map._latLngBoundsToNewLayerBounds(this._bounds,_.zoom,_.center).min;wt(this._image,_,l)},_reset:function(){var n=this._image,l=new U(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),_=l.getSize();We(n,l.min),n.style.width=_.x+"px",n.style.height=_.y+"px"},_updateOpacity:function(){it(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),li=pn.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",l=this._image=n?this._url:Me("video");if(Te(l,"leaflet-image-layer"),this._zoomAnimated&&Te(l,"leaflet-zoom-animated"),this.options.className&&Te(l,this.options.className),l.onselectstart=d,l.onmousemove=d,l.onloadeddata=c(this.fire,this,"load"),n){for(var _=l.getElementsByTagName("source"),b=[],y=0;y<_.length;y++)b.push(_[y].src);this._url=0<_.length?b:[l.src]}else{T(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(l.style,"objectFit")&&(l.style.objectFit="fill"),l.autoplay=!!this.options.autoplay,l.loop=!!this.options.loop,l.muted=!!this.options.muted,l.playsInline=!!this.options.playsInline;for(var B=0;B<this._url.length;B++){var K=Me("source");K.src=this._url[B],l.appendChild(K)}}}}),ci=pn.extend({_initImage:function(){var n=this._image=this._url;Te(n,"leaflet-image-layer"),this._zoomAnimated&&Te(n,"leaflet-zoom-animated"),this.options.className&&Te(n,this.options.className),n.onselectstart=d,n.onmousemove=d}}),ct=Ke.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,l){n&&(n instanceof V||T(n))?(this._latlng=H(n),v(this,l)):(v(this,n),this._source=l),this.options.content&&(this._content=this.options.content)},openOn:function(n){return(n=arguments.length?n:this._source._map).hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&it(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&it(this._container,1),this.bringToFront(),this.options.interactive&&(Te(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(it(this._container,0),this._removeTimeout=setTimeout(c(Be,void 0,this._container),200)):Be(this._container),this.options.interactive&&(qe(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=H(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Mt(this._container),this},bringToBack:function(){return this._map&&St(this._container),this},_prepareOpen:function(n){if(!(_=this._source)._map)return!1;if(_ instanceof ft){var l,_=null,b=this._source._layers;for(l in b)if(b[l]._map){_=b[l];break}if(!_)return!1;this._source=_}if(!n)if(_.getCenter)n=_.getCenter();else if(_.getLatLng)n=_.getLatLng();else{if(!_.getBounds)throw new Error("Unable to get source layer LatLng.");n=_.getBounds().getCenter()}return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,l=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof l=="string")n.innerHTML=l;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(l)}this.fire("contentupdate")}},_updatePosition:function(){var n,l,_;this._map&&(l=this._map.latLngToLayerPoint(this._latlng),n=R(this.options.offset),_=this._getAnchor(),this._zoomAnimated?We(this._container,l.add(_)):n=n.add(l).add(_),l=this._containerBottom=-n.y,_=this._containerLeft=-Math.round(this._containerWidth/2)+n.x,this._container.style.bottom=l+"px",this._container.style.left=_+"px")},_getAnchor:function(){return[0,0]}}),dn=(Ee.include({_initOverlay:function(n,l,_,b){var y=l;return y instanceof n||(y=new n(b).setContent(l)),_&&y.setLatLng(_),y}}),Ke.include({_initOverlay:function(n,l,_,b){var y=_;return y instanceof n?(v(y,b),y._source=this):(y=l&&!b?l:new n(b,this)).setContent(_),y}}),ct.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return!(n=arguments.length?n:this._source._map).hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,ct.prototype.openOn.call(this,n)},onAdd:function(n){ct.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof vt||this._source.on("preclick",xt))},onRemove:function(n){ct.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof vt||this._source.off("preclick",xt))},getEvents:function(){var n=ct.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",l=this._container=Me("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),_=this._wrapper=Me("div",n+"-content-wrapper",l);this._contentNode=Me("div",n+"-content",_),Bt(l),Sn(this._contentNode),we(l,"contextmenu",xt),this._tipContainer=Me("div",n+"-tip-container",l),this._tip=Me("div",n+"-tip",this._tipContainer),this.options.closeButton&&((_=this._closeButton=Me("a",n+"-close-button",l)).setAttribute("role","button"),_.setAttribute("aria-label","Close popup"),_.href="#close",_.innerHTML='<span aria-hidden="true">&#215;</span>',we(_,"click",function(b){Ve(b),this.close()},this))},_updateLayout:function(){var n=this._contentNode,l=n.style,_=(l.width="",l.whiteSpace="nowrap",n.offsetWidth),_=Math.min(_,this.options.maxWidth),_=(_=Math.max(_,this.options.minWidth),l.width=_+1+"px",l.whiteSpace="",l.height="",n.offsetHeight),b=this.options.maxHeight,y="leaflet-popup-scrolled";(b&&b<_?(l.height=b+"px",Te):qe)(n,y),this._containerWidth=this._container.offsetWidth},_animateZoom:function(l){var l=this._map._latLngToNewLayerPoint(this._latlng,l.zoom,l.center),_=this._getAnchor();We(this._container,l.add(_))},_adjustPan:function(){var n,l,_,b,y,B,K,Y;this.options.autoPan&&(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning?this._autopanning=!1:(n=this._map,l=parseInt(Zt(this._container,"marginBottom"),10)||0,l=this._container.offsetHeight+l,Y=this._containerWidth,(_=new N(this._containerLeft,-l-this._containerBottom))._add(kt(this._container)),_=n.layerPointToContainerPoint(_),y=R(this.options.autoPanPadding),b=R(this.options.autoPanPaddingTopLeft||y),y=R(this.options.autoPanPaddingBottomRight||y),B=n.getSize(),K=0,_.x+Y+y.x>B.x&&(K=_.x+Y-B.x+y.x),_.x-K-b.x<(Y=0)&&(K=_.x-b.x),_.y+l+y.y>B.y&&(Y=_.y+l-B.y+y.y),_.y-Y-b.y<0&&(Y=_.y-b.y),(K||Y)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([K,Y]))))},_getAnchor:function(){return R(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}})),hn=(Ee.mergeOptions({closePopupOnClick:!0}),Ee.include({openPopup:function(n,l,_){return this._initOverlay(dn,n,l,_).openOn(this),this},closePopup:function(n){return(n=arguments.length?n:this._popup)&&n.close(),this}}),Ke.include({bindPopup:function(n,l){return this._popup=this._initOverlay(dn,this._popup,n,l),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof ft||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){var l;this._popup&&this._map&&($t(n),l=n.layer||n.target,this._popup._source!==l||l instanceof vt?(this._popup._source=l,this.openPopup(n.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng))},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}}),ct.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){ct.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){ct.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=ct.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Me("div",n),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var l,ce=this._map,_=this._container,b=ce.latLngToContainerPoint(ce.getCenter()),ce=ce.layerPointToContainerPoint(n),y=this.options.direction,B=_.offsetWidth,K=_.offsetHeight,Y=R(this.options.offset),se=this._getAnchor(),ce=y==="top"?(l=B/2,K):y==="bottom"?(l=B/2,0):(l=y==="center"?B/2:y==="right"?0:y==="left"?B:ce.x<b.x?(y="right",0):(y="left",B+2*(Y.x+se.x)),K/2);n=n.subtract(R(l,ce,!0)).add(Y).add(se),qe(_,"leaflet-tooltip-right"),qe(_,"leaflet-tooltip-left"),qe(_,"leaflet-tooltip-top"),qe(_,"leaflet-tooltip-bottom"),Te(_,"leaflet-tooltip-"+y),We(_,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&it(this._container,n)},_animateZoom:function(n){n=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),this._setPosition(n)},_getAnchor:function(){return R(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}})),ui=(Ee.include({openTooltip:function(n,l,_){return this._initOverlay(hn,n,l,_).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),Ke.include({bindTooltip:function(n,l){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(hn,this._tooltip,n,l),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){var l,_;!n&&this._tooltipHandlersAdded||(l=n?"off":"on",_={remove:this.closeTooltip,move:this._moveTooltip},this._tooltip.options.permanent?_.add=this._openTooltip:(_.mouseover=this._openTooltip,_.mouseout=this.closeTooltip,_.click=this._openTooltip,this._map?this._addFocusListeners():_.add=this._addFocusListeners),this._tooltip.options.sticky&&(_.mousemove=this._moveTooltip),this[l](_),this._tooltipHandlersAdded=!n)},openTooltip:function(n){return this._tooltip&&(this instanceof ft||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var l=typeof n.getElement=="function"&&n.getElement();l&&(we(l,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),we(l,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){n=typeof n.getElement=="function"&&n.getElement(),n&&n.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){var l;this._tooltip&&this._map&&(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag?(this._openOnceFlag=!0,(l=this)._map.once("moveend",function(){l._openOnceFlag=!1,l._openTooltip(n)})):(this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)))},_moveTooltip:function(n){var l=n.latlng;this._tooltip.options.sticky&&n.originalEvent&&(n=this._map.mouseEventToContainerPoint(n.originalEvent),n=this._map.containerPointToLayerPoint(n),l=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(l)}}),Ct.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(l){var l=l&&l.tagName==="DIV"?l:document.createElement("div"),_=this.options;return _.html instanceof Element?(Kt(l),l.appendChild(_.html)):l.innerHTML=_.html!==!1?_.html:"",_.bgPos&&(_=R(_.bgPos),l.style.backgroundPosition=-_.x+"px "+-_.y+"px"),this._setIconStyles(l,"icon"),l},createShadow:function(){return null}}));Ct.Default=Nt;var Ft=Ke.extend({options:{tileSize:256,opacity:1,updateWhenIdle:pe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){v(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),Be(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Mt(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(St(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){var n;return this._map&&(this._removeAllTiles(),(n=this._clampZoom(this._map.getZoom()))!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()),this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof N?n:new N(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var l,_=this.getPane().children,b=-n(-1/0,1/0),y=0,B=_.length;y<B;y++)l=_[y].style.zIndex,_[y]!==this._container&&l&&(b=n(b,+l));isFinite(b)&&(this.options.zIndex=b+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!pe.ielt9){it(this._container,this.options.opacity);var n,l=+new Date,_=!1,b=!1;for(n in this._tiles){var y,B=this._tiles[n];B.current&&B.loaded&&(y=Math.min(1,(l-B.loaded)/200),it(B.el,y),y<1?_=!0:(B.active?b=!0:this._onOpaqueTile(B),B.active=!0))}b&&!this._noPrune&&this._pruneTiles(),_&&(A(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this))}},_onOpaqueTile:d,_initContainer:function(){this._container||(this._container=Me("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,l=this.options.maxZoom;if(n!==void 0){for(var _ in this._levels)_=Number(_),this._levels[_].el.children.length||_===n?(this._levels[_].el.style.zIndex=l-Math.abs(n-_),this._onUpdateLevel(_)):(Be(this._levels[_].el),this._removeTilesAtZoom(_),this._onRemoveLevel(_),delete this._levels[_]);var b=this._levels[n],y=this._map;return b||((b=this._levels[n]={}).el=Me("div","leaflet-tile-container leaflet-zoom-animated",this._container),b.el.style.zIndex=l,b.origin=y.project(y.unproject(y.getPixelOrigin()),n).round(),b.zoom=n,this._setZoomTransform(b,y.getCenter(),y.getZoom()),d(b.el.offsetWidth),this._onCreateLevel(b)),this._level=b}},_onUpdateLevel:d,_onRemoveLevel:d,_onCreateLevel:d,_pruneTiles:function(){if(this._map){var n,l,_,b=this._map.getZoom();if(b>this.options.maxZoom||b<this.options.minZoom)this._removeAllTiles();else{for(n in this._tiles)(_=this._tiles[n]).retain=_.current;for(n in this._tiles)(_=this._tiles[n]).current&&!_.active&&(l=_.coords,this._retainParent(l.x,l.y,l.z,l.z-5)||this._retainChildren(l.x,l.y,l.z,l.z+2));for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}}},_removeTilesAtZoom:function(n){for(var l in this._tiles)this._tiles[l].coords.z===n&&this._removeTile(l)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)Be(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(y,B,K,b){var y=Math.floor(y/2),B=Math.floor(B/2),K=K-1,Y=new N(+y,+B),Y=(Y.z=K,this._tileCoordsToKey(Y)),Y=this._tiles[Y];return Y&&Y.active?Y.retain=!0:(Y&&Y.loaded&&(Y.retain=!0),b<K&&this._retainParent(y,B,K,b))},_retainChildren:function(n,l,_,b){for(var y=2*n;y<2*n+2;y++)for(var B=2*l;B<2*l+2;B++){var K=new N(y,B),K=(K.z=_+1,this._tileCoordsToKey(K)),K=this._tiles[K];K&&K.active?K.retain=!0:(K&&K.loaded&&(K.retain=!0),_+1<b&&this._retainChildren(y,B,_+1,b))}},_resetView:function(n){n=n&&(n.pinch||n.flyTo),this._setView(this._map.getCenter(),this._map.getZoom(),n,n)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var l=this.options;return l.minNativeZoom!==void 0&&n<l.minNativeZoom?l.minNativeZoom:l.maxNativeZoom!==void 0&&l.maxNativeZoom<n?l.maxNativeZoom:n},_setView:function(n,l,_,b){var y=Math.round(l),y=this.options.maxZoom!==void 0&&y>this.options.maxZoom||this.options.minZoom!==void 0&&y<this.options.minZoom?void 0:this._clampZoom(y),B=this.options.updateWhenZooming&&y!==this._tileZoom;b&&!B||(this._tileZoom=y,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),y!==void 0&&this._update(n),_||this._pruneTiles(),this._noPrune=!!_),this._setZoomTransforms(n,l)},_setZoomTransforms:function(n,l){for(var _ in this._levels)this._setZoomTransform(this._levels[_],n,l)},_setZoomTransform:function(n,y,_){var b=this._map.getZoomScale(_,n.zoom),y=n.origin.multiplyBy(b).subtract(this._map._getNewPixelOrigin(y,_)).round();pe.any3d?wt(n.el,y,b):We(n.el,y)},_resetGrid:function(){var n=this._map,l=n.options.crs,_=this._tileSize=this.getTileSize(),b=this._tileZoom,y=this._map.getPixelWorldBounds(this._tileZoom);y&&(this._globalTileRange=this._pxBoundsToTileRange(y)),this._wrapX=l.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,l.wrapLng[0]],b).x/_.x),Math.ceil(n.project([0,l.wrapLng[1]],b).x/_.y)],this._wrapY=l.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([l.wrapLat[0],0],b).y/_.x),Math.ceil(n.project([l.wrapLat[1],0],b).y/_.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(_){var b=this._map,l=b._animatingZoom?Math.max(b._animateToZoom,b.getZoom()):b.getZoom(),l=b.getZoomScale(l,this._tileZoom),_=b.project(_,this._tileZoom).floor(),b=b.getSize().divideBy(2*l);return new U(_.subtract(b),_.add(b))},_update:function(n){var l=this._map;if(l){var _=this._clampZoom(l.getZoom());if(n===void 0&&(n=l.getCenter()),this._tileZoom!==void 0){var b,l=this._getTiledPixelBounds(n),y=this._pxBoundsToTileRange(l),B=y.getCenter(),K=[],l=this.options.keepBuffer,Y=new U(y.getBottomLeft().subtract([l,-l]),y.getTopRight().add([l,-l]));if(!(isFinite(y.min.x)&&isFinite(y.min.y)&&isFinite(y.max.x)&&isFinite(y.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(b in this._tiles){var se=this._tiles[b].coords;se.z===this._tileZoom&&Y.contains(new N(se.x,se.y))||(this._tiles[b].current=!1)}if(1<Math.abs(_-this._tileZoom))this._setView(n,_);else{for(var ce=y.min.y;ce<=y.max.y;ce++)for(var be=y.min.x;be<=y.max.x;be++){var xe,$e=new N(be,ce);$e.z=this._tileZoom,this._isValidTile($e)&&((xe=this._tiles[this._tileCoordsToKey($e)])?xe.current=!0:K.push($e))}if(K.sort(function(Ye,et){return Ye.distanceTo(B)-et.distanceTo(B)}),K.length!==0){this._loading||(this._loading=!0,this.fire("loading"));for(var Ae=document.createDocumentFragment(),be=0;be<K.length;be++)this._addTile(K[be],Ae);this._level.el.appendChild(Ae)}}}}},_isValidTile:function(n){var l=this._map.options.crs;if(!l.infinite){var _=this._globalTileRange;if(!l.wrapLng&&(n.x<_.min.x||n.x>_.max.x)||!l.wrapLat&&(n.y<_.min.y||n.y>_.max.y))return!1}return!this.options.bounds||(l=this._tileCoordsToBounds(n),j(this.options.bounds).overlaps(l))},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var l=this._map,b=this.getTileSize(),_=n.scaleBy(b),b=_.add(b);return[l.unproject(_,n.z),l.unproject(b,n.z)]},_tileCoordsToBounds:function(n){return n=this._tileCoordsToNwSe(n),n=new C(n[0],n[1]),n=this.options.noWrap?n:this._map.wrapLatLngBounds(n)},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(l){var l=l.split(":"),_=new N(+l[0],+l[1]);return _.z=+l[2],_},_removeTile:function(n){var l=this._tiles[n];l&&(Be(l.el),delete this._tiles[n],this.fire("tileunload",{tile:l.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){Te(n,"leaflet-tile");var l=this.getTileSize();n.style.width=l.x+"px",n.style.height=l.y+"px",n.onselectstart=d,n.onmousemove=d,pe.ielt9&&this.options.opacity<1&&it(n,this.options.opacity)},_addTile:function(n,l){var _=this._getTilePos(n),b=this._tileCoordsToKey(n),y=this.createTile(this._wrapCoords(n),c(this._tileReady,this,n));this._initTile(y),this.createTile.length<2&&F(c(this._tileReady,this,n,null,y)),We(y,_),this._tiles[b]={el:y,coords:n,current:!0},l.appendChild(y),this.fire("tileloadstart",{tile:y,coords:n})},_tileReady:function(n,l,_){l&&this.fire("tileerror",{error:l,tile:_,coords:n});var b=this._tileCoordsToKey(n);(_=this._tiles[b])&&(_.loaded=+new Date,this._map._fadeAnimated?(it(_.el,0),A(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this)):(_.active=!0,this._pruneTiles()),l||(Te(_.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:_.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),pe.ielt9||!this._map._fadeAnimated?F(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var l=new N(this._wrapX?p(n.x,this._wrapX):n.x,this._wrapY?p(n.y,this._wrapY):n.y);return l.z=n.z,l},_pxBoundsToTileRange:function(n){var l=this.getTileSize();return new U(n.min.unscaleBy(l).floor(),n.max.unscaleBy(l).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}}),It=Ft.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,l){this._url=n,(l=v(this,l)).detectRetina&&pe.retina&&0<l.maxZoom?(l.tileSize=Math.floor(l.tileSize/2),l.zoomReverse?(l.zoomOffset--,l.minZoom=Math.min(l.maxZoom,l.minZoom+1)):(l.zoomOffset++,l.maxZoom=Math.max(l.minZoom,l.maxZoom-1)),l.minZoom=Math.max(0,l.minZoom)):l.zoomReverse?l.minZoom=Math.min(l.maxZoom,l.minZoom):l.maxZoom=Math.max(l.minZoom,l.maxZoom),typeof l.subdomains=="string"&&(l.subdomains=l.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,l){return this._url===n&&l===void 0&&(l=!0),this._url=n,l||this.redraw(),this},createTile:function(n,l){var _=document.createElement("img");return we(_,"load",c(this._tileOnLoad,this,l,_)),we(_,"error",c(this._tileOnError,this,l,_)),!this.options.crossOrigin&&this.options.crossOrigin!==""||(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(_.referrerPolicy=this.options.referrerPolicy),_.alt="",_.src=this.getTileUrl(n),_},getTileUrl:function(n){var l={r:pe.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};return this._map&&!this._map.options.crs.infinite&&(n=this._globalTileRange.max.y-n.y,this.options.tms&&(l.y=n),l["-y"]=n),$(this._url,i(l,this.options))},_tileOnLoad:function(n,l){pe.ielt9?setTimeout(c(n,this,null,l),0):n(null,l)},_tileOnError:function(n,l,_){var b=this.options.errorTileUrl;b&&l.getAttribute("src")!==b&&(l.src=b),n(_,l)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,l=this.options.maxZoom;return(n=this.options.zoomReverse?l-n:n)+this.options.zoomOffset},_getSubdomain:function(n){return n=Math.abs(n.x+n.y)%this.options.subdomains.length,this.options.subdomains[n]},_abortLoading:function(){var n,l,_;for(n in this._tiles)this._tiles[n].coords.z!==this._tileZoom&&((_=this._tiles[n].el).onload=d,_.onerror=d,_.complete||(_.src=E,l=this._tiles[n].coords,Be(_),delete this._tiles[n],this.fire("tileabort",{tile:_,coords:l})))},_removeTile:function(n){var l=this._tiles[n];if(l)return l.el.setAttribute("src",E),Ft.prototype._removeTile.call(this,n)},_tileReady:function(n,l,_){if(this._map&&(!_||_.getAttribute("src")!==E))return Ft.prototype._tileReady.call(this,n,l,_)}});function fi(n,l){return new It(n,l)}var _i=It.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(y,l){this._url=y;var _,b=i({},this.defaultWmsParams);for(_ in l)_ in this.options||(b[_]=l[_]);var y=(l=v(this,l)).detectRetina&&pe.retina?2:1,B=this.getTileSize();b.width=B.x*y,b.height=B.y*y,this.wmsParams=b},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var l=1.3<=this._wmsVersion?"crs":"srs";this.wmsParams[l]=this._crs.code,It.prototype.onAdd.call(this,n)},getTileUrl:function(n){var l=this._tileCoordsToNwSe(n),_=this._crs,_=z(_.project(l[0]),_.project(l[1])),l=_.min,_=_.max,l=(1.3<=this._wmsVersion&&this._crs===oi?[l.y,l.x,_.y,_.x]:[l.x,l.y,_.x,_.y]).join(","),_=It.prototype.getTileUrl.call(this,n);return _+w(this.wmsParams,_,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+l},setParams:function(n,l){return i(this.wmsParams,n),l||this.redraw(),this}});It.WMS=_i,fi.wms=function(n,l){return new _i(n,l)};var dt=Ke.extend({options:{padding:.1},initialize:function(n){v(this,n),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Te(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,l){var _=this._map.getZoomScale(l,this._zoom),y=this._map.getSize().multiplyBy(.5+this.options.padding),b=this._map.project(this._center,l),y=y.multiplyBy(-_).add(b).subtract(this._map._getNewPixelOrigin(n,l));pe.any3d?wt(this._container,y,_):We(this._container,y)},_reset:function(){for(var n in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,l=this._map.getSize(),_=this._map.containerPointToLayerPoint(l.multiplyBy(-n)).round();this._bounds=new U(_,_.add(l.multiplyBy(1+2*n)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),pi=dt.extend({options:{tolerance:0},getEvents:function(){var n=dt.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){dt.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");we(n,"mousemove",this._onMouseMove,this),we(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),we(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){A(this._redrawRequest),delete this._ctx,Be(this._container),Ce(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var n in this._redrawBounds=null,this._layers)this._layers[n]._update();this._redraw()}},_update:function(){var n,l,_,b;this._map._animatingZoom&&this._bounds||(dt.prototype._update.call(this),n=this._bounds,l=this._container,_=n.getSize(),b=pe.retina?2:1,We(l,n.min),l.width=b*_.x,l.height=b*_.y,l.style.width=_.x+"px",l.style.height=_.y+"px",pe.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update"))},_reset:function(){dt.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),n=(this._layers[u(n)]=n)._order={layer:n,prev:this._drawLast,next:null},this._drawLast&&(this._drawLast.next=n),this._drawLast=n,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var _=n._order,l=_.next,_=_.prev;l?l.prev=_:this._drawLast=_,_?_.next=l:this._drawFirst=l,delete n._order,delete this._layers[u(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){for(var l,_=n.options.dashArray.split(/[, ]+/),b=[],y=0;y<_.length;y++){if(l=Number(_[y]),isNaN(l))return;b.push(l)}n.options._dashArray=b}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||F(this._redraw,this))},_extendRedrawBounds:function(n){var l;n._pxBounds&&(l=(n.options.weight||0)+1,this._redrawBounds=this._redrawBounds||new U,this._redrawBounds.extend(n._pxBounds.min.subtract([l,l])),this._redrawBounds.extend(n._pxBounds.max.add([l,l])))},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n,l=this._redrawBounds;l?(n=l.getSize(),this._ctx.clearRect(l.min.x,l.min.y,n.x,n.y)):(this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore())},_draw:function(){var n,l,_=this._redrawBounds;this._ctx.save(),_&&(l=_.getSize(),this._ctx.beginPath(),this._ctx.rect(_.min.x,_.min.y,l.x,l.y),this._ctx.clip()),this._drawing=!0;for(var b=this._drawFirst;b;b=b.next)n=b.layer,(!_||n._pxBounds&&n._pxBounds.intersects(_))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,l){if(this._drawing){var _,b,y,B,K=n._parts,Y=K.length,se=this._ctx;if(Y){for(se.beginPath(),_=0;_<Y;_++){for(b=0,y=K[_].length;b<y;b++)B=K[_][b],se[b?"lineTo":"moveTo"](B.x,B.y);l&&se.closePath()}this._fillStroke(se,n)}}},_updateCircle:function(n){var l,_,b,y;this._drawing&&!n._empty()&&(l=n._point,_=this._ctx,b=Math.max(Math.round(n._radius),1),(y=(Math.max(Math.round(n._radiusY),1)||b)/b)!=1&&(_.save(),_.scale(1,y)),_.beginPath(),_.arc(l.x,l.y/y,b,0,2*Math.PI,!1),y!=1&&_.restore(),this._fillStroke(_,n))},_fillStroke:function(n,l){var _=l.options;_.fill&&(n.globalAlpha=_.fillOpacity,n.fillStyle=_.fillColor||_.color,n.fill(_.fillRule||"evenodd")),_.stroke&&_.weight!==0&&(n.setLineDash&&n.setLineDash(l.options&&l.options._dashArray||[]),n.globalAlpha=_.opacity,n.lineWidth=_.weight,n.strokeStyle=_.color,n.lineCap=_.lineCap,n.lineJoin=_.lineJoin,n.stroke())},_onClick:function(n){for(var l,_,b=this._map.mouseEventToLayerPoint(n),y=this._drawFirst;y;y=y.next)(l=y.layer).options.interactive&&l._containsPoint(b)&&((n.type==="click"||n.type==="preclick")&&this._map._draggableMoved(l)||(_=l));this._fireEvent(!!_&&[_],n)},_onMouseMove:function(n){var l;!this._map||this._map.dragging.moving()||this._map._animatingZoom||(l=this._map.mouseEventToLayerPoint(n),this._handleMouseHover(n,l))},_handleMouseOut:function(n){var l=this._hoveredLayer;l&&(qe(this._container,"leaflet-interactive"),this._fireEvent([l],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,l){if(!this._mouseHoverThrottled){for(var _,b,y=this._drawFirst;y;y=y.next)(_=y.layer).options.interactive&&_._containsPoint(l)&&(b=_);b!==this._hoveredLayer&&(this._handleMouseOut(n),b&&(Te(this._container,"leaflet-interactive"),this._fireEvent([b],n,"mouseover"),this._hoveredLayer=b)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],n),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,l,_){this._map._fireDOMEvent(l,_||l.type,n)},_bringToFront:function(n){var l,_,b=n._order;b&&(l=b.next,_=b.prev,l&&((l.prev=_)?_.next=l:l&&(this._drawFirst=l),b.prev=this._drawLast,(this._drawLast.next=b).next=null,this._drawLast=b,this._requestRedraw(n)))},_bringToBack:function(n){var l,_,b=n._order;b&&(l=b.next,(_=b.prev)&&((_.next=l)?l.prev=_:_&&(this._drawLast=_),b.prev=null,b.next=this._drawFirst,this._drawFirst.prev=b,this._drawFirst=b,this._requestRedraw(n)))}});function di(n){return pe.canvas?new pi(n):null}var Wt=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Ht={_initContainer:function(){this._container=Me("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(dt.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var l=n._container=Wt("shape");Te(l,"leaflet-vml-shape "+(this.options.className||"")),l.coordsize="1 1",n._path=Wt("path"),l.appendChild(n._path),this._updateStyle(n),this._layers[u(n)]=n},_addPath:function(n){var l=n._container;this._container.appendChild(l),n.options.interactive&&n.addInteractiveTarget(l)},_removePath:function(n){var l=n._container;Be(l),n.removeInteractiveTarget(l),delete this._layers[u(n)]},_updateStyle:function(n){var l=n._stroke,_=n._fill,b=n.options,y=n._container;y.stroked=!!b.stroke,y.filled=!!b.fill,b.stroke?(l=l||(n._stroke=Wt("stroke")),y.appendChild(l),l.weight=b.weight+"px",l.color=b.color,l.opacity=b.opacity,b.dashArray?l.dashStyle=T(b.dashArray)?b.dashArray.join(" "):b.dashArray.replace(/( *, *)/g," "):l.dashStyle="",l.endcap=b.lineCap.replace("butt","flat"),l.joinstyle=b.lineJoin):l&&(y.removeChild(l),n._stroke=null),b.fill?(_=_||(n._fill=Wt("fill")),y.appendChild(_),_.color=b.fillColor||b.color,_.opacity=b.fillOpacity):_&&(y.removeChild(_),n._fill=null)},_updateCircle:function(n){var l=n._point.round(),_=Math.round(n._radius),b=Math.round(n._radiusY||_);this._setPath(n,n._empty()?"M0 0":"AL "+l.x+","+l.y+" "+_+","+b+" 0,23592600")},_setPath:function(n,l){n._path.v=l},_bringToFront:function(n){Mt(n._container)},_bringToBack:function(n){St(n._container)}},mn=pe.vml?Wt:me,Ut=dt.extend({_initContainer:function(){this._container=mn("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=mn("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Be(this._container),Ce(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){var n,l,_;this._map._animatingZoom&&this._bounds||(dt.prototype._update.call(this),l=(n=this._bounds).getSize(),_=this._container,this._svgSize&&this._svgSize.equals(l)||(this._svgSize=l,_.setAttribute("width",l.x),_.setAttribute("height",l.y)),We(_,n.min),_.setAttribute("viewBox",[n.min.x,n.min.y,l.x,l.y].join(" ")),this.fire("update"))},_initPath:function(n){var l=n._path=mn("path");n.options.className&&Te(l,n.options.className),n.options.interactive&&Te(l,"leaflet-interactive"),this._updateStyle(n),this._layers[u(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){Be(n._path),n.removeInteractiveTarget(n._path),delete this._layers[u(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(_){var l=_._path,_=_.options;l&&(_.stroke?(l.setAttribute("stroke",_.color),l.setAttribute("stroke-opacity",_.opacity),l.setAttribute("stroke-width",_.weight),l.setAttribute("stroke-linecap",_.lineCap),l.setAttribute("stroke-linejoin",_.lineJoin),_.dashArray?l.setAttribute("stroke-dasharray",_.dashArray):l.removeAttribute("stroke-dasharray"),_.dashOffset?l.setAttribute("stroke-dashoffset",_.dashOffset):l.removeAttribute("stroke-dashoffset")):l.setAttribute("stroke","none"),_.fill?(l.setAttribute("fill",_.fillColor||_.color),l.setAttribute("fill-opacity",_.fillOpacity),l.setAttribute("fill-rule",_.fillRule||"evenodd")):l.setAttribute("fill","none"))},_updatePoly:function(n,l){this._setPath(n,de(n._parts,l))},_updateCircle:function(n){var b=n._point,l=Math.max(Math.round(n._radius),1),_="a"+l+","+(Math.max(Math.round(n._radiusY),1)||l)+" 0 1,0 ",b=n._empty()?"M0 0":"M"+(b.x-l)+","+b.y+_+2*l+",0 "+_+2*-l+",0 ";this._setPath(n,b)},_setPath:function(n,l){n._path.setAttribute("d",l)},_bringToFront:function(n){Mt(n._path)},_bringToBack:function(n){St(n._path)}});function hi(n){return pe.svg||pe.vml?new Ut(n):null}pe.vml&&Ut.include(Ht),Ee.include({getRenderer:function(n){return n=(n=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer)||(this._renderer=this._createRenderer()),this.hasLayer(n)||this.addLayer(n),n},_getPaneRenderer:function(n){var l;return n!=="overlayPane"&&n!==void 0&&((l=this._paneRenderers[n])===void 0&&(l=this._createRenderer({pane:n}),this._paneRenderers[n]=l),l)},_createRenderer:function(n){return this.options.preferCanvas&&di(n)||hi(n)}});var mi=Ot.extend({initialize:function(n,l){Ot.prototype.initialize.call(this,this._boundsToLatLngs(n),l)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return[(n=j(n)).getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});Ut.create=mn,Ut.pointsToPath=de,pt.geometryToLayer=ln,pt.coordsToLatLng=Bn,pt.coordsToLatLngs=cn,pt.latLngToCoords=Dn,pt.latLngsToCoords=un,pt.getFeature=jt,pt.asFeature=fn,Ee.mergeOptions({boxZoom:!0});var ht=Je.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){we(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ce(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Be(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),mt(),xn(),this._startPoint=this._map.mouseEventToContainerPoint(n),we(document,{contextmenu:$t,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(l){this._moved||(this._moved=!0,this._box=Me("div","leaflet-zoom-box",this._container),Te(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(l);var l=new U(this._point,this._startPoint),_=l.getSize();We(this._box,l.min),this._box.style.width=_.x+"px",this._box.style.height=_.y+"px"},_finish:function(){this._moved&&(Be(this._box),qe(this._container,"leaflet-crosshair")),ge(),$n(),Ce(document,{contextmenu:$t,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){n.which!==1&&n.button!==1||(this._finish(),this._moved&&(this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0),n=new C(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point)),this._map.fitBounds(n).fire("boxzoomend",{boxZoomBounds:n})))},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}}),gn=(Ee.addInitHook("addHandler","boxZoom",ht),Ee.mergeOptions({doubleClickZoom:!0}),Je.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var l=this._map,b=l.getZoom(),_=l.options.zoomDelta,b=n.originalEvent.shiftKey?b-_:b+_;l.options.doubleClickZoom==="center"?l.setZoom(b):l.setZoomAround(n.containerPoint,b)}})),yt=(Ee.addInitHook("addHandler","doubleClickZoom",gn),Ee.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0}),Je.extend({addHooks:function(){var n;this._draggable||(n=this._map,this._draggable=new bt(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))),Te(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){qe(this._map._container,"leaflet-grab"),qe(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n,l=this._map;l._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity?(n=j(this._map.options.maxBounds),this._offsetLimit=z(this._map.latLngToContainerPoint(n.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(n.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))):this._offsetLimit=null,l.fire("movestart").fire("dragstart"),l.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){var l,_;this._map.options.inertia&&(l=this._lastTime=+new Date,_=this._lastPos=this._draggable._absPos||this._draggable._newPos,this._positions.push(_),this._times.push(l),this._prunePositions(l)),this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;1<this._positions.length&&50<n-this._times[0];)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),l=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=l.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,l){return n-(n-l)*this._viscosity},_onPreDragLimit:function(){var n,l;this._viscosity&&this._offsetLimit&&(n=this._draggable._newPos.subtract(this._draggable._startPos),l=this._offsetLimit,n.x<l.min.x&&(n.x=this._viscousLimit(n.x,l.min.x)),n.y<l.min.y&&(n.y=this._viscousLimit(n.y,l.min.y)),n.x>l.max.x&&(n.x=this._viscousLimit(n.x,l.max.x)),n.y>l.max.y&&(n.y=this._viscousLimit(n.y,l.max.y)),this._draggable._newPos=this._draggable._startPos.add(n))},_onPreDragWrap:function(){var y=this._worldWidth,n=Math.round(y/2),l=this._initialWorldOffset,b=this._draggable._newPos.x,_=(b-n+l)%y+n-l,b=(b+n+l)%y-n-l,y=Math.abs(_+l)<Math.abs(b+l)?_:b;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=y},_onDragEnd:function(n){var l,_,b,y,B=this._map,K=B.options,Y=!K.inertia||n.noInertia||this._times.length<2;B.fire("dragend",n),!Y&&(this._prunePositions(+new Date),n=this._lastPos.subtract(this._positions[0]),Y=(this._lastTime-this._times[0])/1e3,l=K.easeLinearity,Y=(n=n.multiplyBy(l/Y)).distanceTo([0,0]),_=Math.min(K.inertiaMaxSpeed,Y),n=n.multiplyBy(_/Y),b=_/(K.inertiaDeceleration*l),(y=n.multiplyBy(-b/2).round()).x||y.y)?(y=B._limitOffset(y,B.options.maxBounds),F(function(){B.panBy(y,{duration:b,easeLinearity:l,noMoveStart:!0,animate:!0})})):B.fire("moveend")}})),bn=(Ee.addInitHook("addHandler","dragging",yt),Ee.mergeOptions({keyboard:!0,keyboardPanDelta:80}),Je.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),we(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ce(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){var n,l,_;this._focused||(_=document.body,n=document.documentElement,l=_.scrollTop||n.scrollTop,_=_.scrollLeft||n.scrollLeft,this._map._container.focus(),window.scrollTo(_,l))},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){for(var l=this._panKeys={},_=this.keyCodes,b=0,y=_.left.length;b<y;b++)l[_.left[b]]=[-1*n,0];for(b=0,y=_.right.length;b<y;b++)l[_.right[b]]=[n,0];for(b=0,y=_.down.length;b<y;b++)l[_.down[b]]=[0,n];for(b=0,y=_.up.length;b<y;b++)l[_.up[b]]=[0,-1*n]},_setZoomDelta:function(n){for(var l=this._zoomKeys={},_=this.keyCodes,b=0,y=_.zoomIn.length;b<y;b++)l[_.zoomIn[b]]=n;for(b=0,y=_.zoomOut.length;b<y;b++)l[_.zoomOut[b]]=-n},_addHooks:function(){we(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ce(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var l,_,b=n.keyCode,y=this._map;if(b in this._panKeys)y._panAnim&&y._panAnim._inProgress||(_=this._panKeys[b],n.shiftKey&&(_=R(_).multiplyBy(3)),y.options.maxBounds&&(_=y._limitOffset(R(_),y.options.maxBounds)),y.options.worldCopyJump?(l=y.wrapLatLng(y.unproject(y.project(y.getCenter()).add(_))),y.panTo(l)):y.panBy(_));else if(b in this._zoomKeys)y.setZoom(y.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[b]);else{if(b!==27||!y._popup||!y._popup.options.closeOnEscapeKey)return;y.closePopup()}$t(n)}}})),vn=(Ee.addInitHook("addHandler","keyboard",bn),Ee.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60}),Je.extend({addHooks:function(){we(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ce(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var _=Hn(n),l=this._map.options.wheelDebounceTime,_=(this._delta+=_,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date),Math.max(l-(+new Date-this._startTime),0));clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),_),$t(n)},_performZoom:function(){var n=this._map,l=n.getZoom(),_=this._map.options.zoomSnap||0,b=(n._stop(),this._delta/(4*this._map.options.wheelPxPerZoomLevel)),b=4*Math.log(2/(1+Math.exp(-Math.abs(b))))/Math.LN2,_=_?Math.ceil(b/_)*_:b,b=n._limitZoom(l+(0<this._delta?_:-_))-l;this._delta=0,this._startTime=null,b&&(n.options.scrollWheelZoom==="center"?n.setZoom(l+b):n.setZoomAround(this._lastMousePos,l+b))}})),Vt=(Ee.addInitHook("addHandler","scrollWheelZoom",vn),Ee.mergeOptions({tapHold:pe.touchNative&&pe.safari&&pe.mobile,tapTolerance:15}),Je.extend({addHooks:function(){we(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ce(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){var l;clearTimeout(this._holdTimeout),n.touches.length===1&&(l=n.touches[0],this._startPos=this._newPos=new N(l.clientX,l.clientY),this._holdTimeout=setTimeout(c(function(){this._cancel(),this._isTapValid()&&(we(document,"touchend",Ve),we(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",l))},this),600),we(document,"touchend touchcancel contextmenu",this._cancel,this),we(document,"touchmove",this._onMove,this))},_cancelClickPrevent:function n(){Ce(document,"touchend",Ve),Ce(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),Ce(document,"touchend touchcancel contextmenu",this._cancel,this),Ce(document,"touchmove",this._onMove,this)},_onMove:function(n){n=n.touches[0],this._newPos=new N(n.clientX,n.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,l){n=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:l.screenX,screenY:l.screenY,clientX:l.clientX,clientY:l.clientY}),n._simulated=!0,l.target.dispatchEvent(n)}})),Gt=(Ee.addInitHook("addHandler","tapHold",Vt),Ee.mergeOptions({touchZoom:pe.touch,bounceAtZoomLimits:!0}),Je.extend({addHooks:function(){Te(this._map._container,"leaflet-touch-zoom"),we(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){qe(this._map._container,"leaflet-touch-zoom"),Ce(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var l,_,b=this._map;!n.touches||n.touches.length!==2||b._animatingZoom||this._zooming||(l=b.mouseEventToContainerPoint(n.touches[0]),_=b.mouseEventToContainerPoint(n.touches[1]),this._centerPoint=b.getSize()._divideBy(2),this._startLatLng=b.containerPointToLatLng(this._centerPoint),b.options.touchZoom!=="center"&&(this._pinchStartLatLng=b.containerPointToLatLng(l.add(_)._divideBy(2))),this._startDist=l.distanceTo(_),this._startZoom=b.getZoom(),this._moved=!1,this._zooming=!0,b._stop(),we(document,"touchmove",this._onTouchMove,this),we(document,"touchend touchcancel",this._onTouchEnd,this),Ve(n))},_onTouchMove:function(n){if(n.touches&&n.touches.length===2&&this._zooming){var l=this._map,_=l.mouseEventToContainerPoint(n.touches[0]),b=l.mouseEventToContainerPoint(n.touches[1]),y=_.distanceTo(b)/this._startDist;if(this._zoom=l.getScaleZoom(y,this._startZoom),!l.options.bounceAtZoomLimits&&(this._zoom<l.getMinZoom()&&y<1||this._zoom>l.getMaxZoom()&&1<y)&&(this._zoom=l._limitZoom(this._zoom)),l.options.touchZoom==="center"){if(this._center=this._startLatLng,y==1)return}else{if(_=_._add(b)._divideBy(2)._subtract(this._centerPoint),y==1&&_.x===0&&_.y===0)return;this._center=l.unproject(l.project(this._pinchStartLatLng,this._zoom).subtract(_),this._zoom)}this._moved||(l._moveStart(!0,!1),this._moved=!0),A(this._animRequest),b=c(l._move,l,this._center,this._zoom,{pinch:!0,round:!1},void 0),this._animRequest=F(b,this,!0),Ve(n)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,A(this._animRequest),Ce(document,"touchmove",this._onTouchMove,this),Ce(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}})),yi=(Ee.addInitHook("addHandler","touchZoom",Gt),Ee.BoxZoom=ht,Ee.DoubleClickZoom=gn,Ee.Drag=yt,Ee.Keyboard=bn,Ee.ScrollWheelZoom=vn,Ee.TapHold=Vt,Ee.TouchZoom=Gt,e.Bounds=U,e.Browser=pe,e.CRS=G,e.Canvas=pi,e.Circle=Zn,e.CircleMarker=an,e.Class=I,e.Control=st,e.DivIcon=ui,e.DivOverlay=ct,e.DomEvent=Cn,e.DomUtil=ue,e.Draggable=bt,e.Evented=X,e.FeatureGroup=ft,e.GeoJSON=pt,e.GridLayer=Ft,e.Handler=Je,e.Icon=Ct,e.ImageOverlay=pn,e.LatLng=V,e.LatLngBounds=C,e.Layer=Ke,e.LayerGroup=zt,e.LineUtil=nn,e.Map=Ee,e.Marker=sn,e.Mixin=Rt,e.Path=vt,e.Point=N,e.PolyUtil=en,e.Polygon=Ot,e.Polyline=_t,e.Popup=dn,e.PosAnimation=Un,e.Projection=on,e.Rectangle=mi,e.Renderer=dt,e.SVG=Ut,e.SVGOverlay=ci,e.TileLayer=It,e.Tooltip=hn,e.Transformation=ae,e.Util=Z,e.VideoOverlay=li,e.bind=c,e.bounds=z,e.canvas=di,e.circle=function(n,l,_){return new Zn(n,l,_)},e.circleMarker=function(n,l){return new an(n,l)},e.control=Dt,e.divIcon=function(n){return new ui(n)},e.extend=i,e.featureGroup=function(n,l){return new ft(n,l)},e.geoJSON=ai,e.geoJson=_n,e.gridLayer=function(n){return new Ft(n)},e.icon=function(n){return new Ct(n)},e.imageOverlay=function(n,l,_){return new pn(n,l,_)},e.latLng=H,e.latLngBounds=j,e.layerGroup=function(n,l){return new zt(n,l)},e.map=function(n,l){return new Ee(n,l)},e.marker=function(n,l){return new sn(n,l)},e.point=R,e.polygon=function(n,l){return new Ot(n,l)},e.polyline=function(n,l){return new _t(n,l)},e.popup=function(n,l){return new dn(n,l)},e.rectangle=function(n,l){return new mi(n,l)},e.setOptions=v,e.stamp=u,e.svg=hi,e.svgOverlay=function(n,l,_){return new ci(n,l,_)},e.tileLayer=fi,e.tooltip=function(n,l){return new hn(n,l)},e.transformation=oe,e.version="1.9.4",e.videoOverlay=function(n,l,_){return new li(n,l,_)},window.L);e.noConflict=function(){return window.L=yi,this},window.L=e})})(leaflet,leaflet.exports);var leafletExports=leaflet.exports;const L$1=getDefaultExportFromCjs(leafletExports),PreviewMap_svelte_svelte_type_style_lang="";function create_fragment$s(o){let t;return{c(){t=element("div"),attr(t,"class","h-96"),attr(t,"id","map")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function controlDarkMode(){let o=document.documentElement.getAttribute("data-theme");if(["dark","black","luxury","dracula","coffee"].includes(o))try{["layer","control-zoom-in","control-zoom-out","control-attribution"].map(i=>document.getElementsByClassName("leaflet-"+i)[0]).forEach(i=>i.style.filter="invert(100%) hue-rotate(180deg) brightness(95%) contrast(90%)")}catch(e){console.log(e)}}function instance$t(o,t,e){var i,r;let{lat:s}=t,{lon:c}=t;function a(f,p){i||(i=L$1.map("map").setView([f,p],12),L$1.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"© OSM"}).addTo(i))}function u(f,p){r!=null&&i.removeLayer(r),f!=null&&p!=null&&(r=L$1.marker([f,p]).addTo(i),i.flyTo([f,p],12))}return afterUpdate(()=>{a(s,c),u(s,c)}),onMount(()=>setTimeout(controlDarkMode,1)),o.$$set=f=>{"lat"in f&&e(0,s=f.lat),"lon"in f&&e(1,c=f.lon)},[s,c]}class PreviewMap extends SvelteComponent{constructor(t){super(),init(this,t,instance$t,create_fragment$s,safe_not_equal,{lat:0,lon:1})}}function create_if_block_10$1(o){let t,e,i,r,s;return{c(){t=element("a"),e=text("exif"),attr(t,"class",i="tab bg-base-200 tab-lifted"+(o[4]==1?" tab-active":""))},m(c,a){insert(c,t,a),append(t,e),r||(s=listen(t,"click",o[6]),r=!0)},p(c,a){a&16&&i!==(i="tab bg-base-200 tab-lifted"+(c[4]==1?" tab-active":""))&&attr(t,"class",i)},d(c){c&&detach(t),r=!1,s()}}}function create_if_block_9$1(o){let t,e,i,r,s;return{c(){t=element("a"),e=text("location"),attr(t,"class",i="tab bg-base-200 tab-lifted"+(o[4]==2?" tab-active":""))},m(c,a){insert(c,t,a),append(t,e),r||(s=listen(t,"click",o[7]),r=!0)},p(c,a){a&16&&i!==(i="tab bg-base-200 tab-lifted"+(c[4]==2?" tab-active":""))&&attr(t,"class",i)},d(c){c&&detach(t),r=!1,s()}}}function create_if_block_8$1(o){let t,e,i,r,s;return r=new PreviewMap({props:{lat:o[0].gps_lat,lon:o[0].gps_lon}}),{c(){t=element("p"),e=text(o[1]),i=space(),create_component(r.$$.fragment)},m(c,a){insert(c,t,a),append(t,e),insert(c,i,a),mount_component(r,c,a),s=!0},p(c,a){(!s||a&2)&&set_data(e,c[1]);const u={};a&1&&(u.lat=c[0].gps_lat),a&1&&(u.lon=c[0].gps_lon),r.$set(u)},i(c){s||(transition_in(r.$$.fragment,c),s=!0)},o(c){transition_out(r.$$.fragment,c),s=!1},d(c){c&&detach(t),c&&detach(i),destroy_component(r,c)}}}function create_if_block_2$d(o){let t,e,i,r,s,c,a=new Date(o[0].datetimeoriginal).toLocaleString()+"",u,f,p,d,m,g,h=o[0].camera_manufacturer+" "+o[0].camera_model,v,w,k=check(o[0].lens_manufacturer),$,T=check(o[0].focallength),P,E=check(o[0].aperture),x,S=check(o[0].exposure_time),M,O=check(o[0].iso),q,F,A,Z,I,D=Math.round(o[0].width*o[0].height/1e4)/100+"",X,N,W=o[0].width+"",R,U,z=o[0].height+"",C,j,V=k&&create_if_block_7$4(o),H=T&&create_if_block_6$5(o),G=E&&create_if_block_5$9(o),ee=S&&create_if_block_4$9(o),re=O&&create_if_block_3$a(o);return{c(){t=element("table"),e=element("tbody"),i=element("tr"),r=element("td"),r.textContent="date/time",s=space(),c=element("td"),u=text(a),f=space(),p=element("tr"),d=element("td"),d.textContent="camera",m=space(),g=element("td"),v=text(h),w=space(),V&&V.c(),$=space(),H&&H.c(),P=space(),G&&G.c(),x=space(),ee&&ee.c(),M=space(),re&&re.c(),q=space(),F=element("tr"),A=element("td"),A.textContent="resolution",Z=space(),I=element("td"),X=text(D),N=text(" MP ("),R=text(W),U=text(" x "),C=text(z),j=text(")"),attr(c,"class","break-all"),attr(g,"class","break-all"),attr(t,"class","table")},m(ae,oe){insert(ae,t,oe),append(t,e),append(e,i),append(i,r),append(i,s),append(i,c),append(c,u),append(e,f),append(e,p),append(p,d),append(p,m),append(p,g),append(g,v),append(e,w),V&&V.m(e,null),append(e,$),H&&H.m(e,null),append(e,P),G&&G.m(e,null),append(e,x),ee&&ee.m(e,null),append(e,M),re&&re.m(e,null),append(e,q),append(e,F),append(F,A),append(F,Z),append(F,I),append(I,X),append(I,N),append(I,R),append(I,U),append(I,C),append(I,j)},p(ae,oe){oe&1&&a!==(a=new Date(ae[0].datetimeoriginal).toLocaleString()+"")&&set_data(u,a),oe&1&&h!==(h=ae[0].camera_manufacturer+" "+ae[0].camera_model)&&set_data(v,h),oe&1&&(k=check(ae[0].lens_manufacturer)),k?V?V.p(ae,oe):(V=create_if_block_7$4(ae),V.c(),V.m(e,$)):V&&(V.d(1),V=null),oe&1&&(T=check(ae[0].focallength)),T?H?H.p(ae,oe):(H=create_if_block_6$5(ae),H.c(),H.m(e,P)):H&&(H.d(1),H=null),oe&1&&(E=check(ae[0].aperture)),E?G?G.p(ae,oe):(G=create_if_block_5$9(ae),G.c(),G.m(e,x)):G&&(G.d(1),G=null),oe&1&&(S=check(ae[0].exposure_time)),S?ee?ee.p(ae,oe):(ee=create_if_block_4$9(ae),ee.c(),ee.m(e,M)):ee&&(ee.d(1),ee=null),oe&1&&(O=check(ae[0].iso)),O?re?re.p(ae,oe):(re=create_if_block_3$a(ae),re.c(),re.m(e,q)):re&&(re.d(1),re=null),oe&1&&D!==(D=Math.round(ae[0].width*ae[0].height/1e4)/100+"")&&set_data(X,D),oe&1&&W!==(W=ae[0].width+"")&&set_data(R,W),oe&1&&z!==(z=ae[0].height+"")&&set_data(C,z)},i:noop,o:noop,d(ae){ae&&detach(t),V&&V.d(),H&&H.d(),G&&G.d(),ee&&ee.d(),re&&re.d()}}}function create_if_block$m(o){let t,e,i,r,s,c,a=o[0].name+"",u,f,p,d,m,g,h,v,w=o[2]&&create_if_block_1$g(o);return{c(){t=element("table"),e=element("tbody"),i=element("tr"),r=element("td"),r.textContent="name",s=space(),c=element("td"),u=text(a),f=space(),w&&w.c(),p=space(),d=element("tr"),m=element("td"),m.textContent="size",g=space(),h=element("td"),v=text(o[3]),attr(c,"class","break-all"),attr(h,"class","break-all"),attr(t,"class","table")},m(k,$){insert(k,t,$),append(t,e),append(e,i),append(i,r),append(i,s),append(i,c),append(c,u),append(e,f),w&&w.m(e,null),append(e,p),append(e,d),append(d,m),append(d,g),append(d,h),append(h,v)},p(k,$){$&1&&a!==(a=k[0].name+"")&&set_data(u,a),k[2]?w?w.p(k,$):(w=create_if_block_1$g(k),w.c(),w.m(e,p)):w&&(w.d(1),w=null),$&8&&set_data(v,k[3])},i:noop,o:noop,d(k){k&&detach(t),w&&w.d()}}}function create_if_block_7$4(o){let t,e,i,r,s=o[0].lens_manufacturer+" "+(o[0].lens_model||""),c;return{c(){t=element("tr"),e=element("td"),e.textContent="lens",i=space(),r=element("td"),c=text(s),attr(r,"class","break-all")},m(a,u){insert(a,t,u),append(t,e),append(t,i),append(t,r),append(r,c)},p(a,u){u&1&&s!==(s=a[0].lens_manufacturer+" "+(a[0].lens_model||""))&&set_data(c,s)},d(a){a&&detach(t)}}}function create_if_block_6$5(o){let t,e,i,r,s=Math.round(o[0].focallength*100)/100+" mm",c;return{c(){t=element("tr"),e=element("td"),e.textContent="focal length",i=space(),r=element("td"),c=text(s)},m(a,u){insert(a,t,u),append(t,e),append(t,i),append(t,r),append(r,c)},p(a,u){u&1&&s!==(s=Math.round(a[0].focallength*100)/100+" mm")&&set_data(c,s)},d(a){a&&detach(t)}}}function create_if_block_5$9(o){let t,e,i,r,s="f/"+o[0].aperture,c;return{c(){t=element("tr"),e=element("td"),e.textContent="aperture",i=space(),r=element("td"),c=text(s)},m(a,u){insert(a,t,u),append(t,e),append(t,i),append(t,r),append(r,c)},p(a,u){u&1&&s!==(s="f/"+a[0].aperture)&&set_data(c,s)},d(a){a&&detach(t)}}}function create_if_block_4$9(o){let t,e,i,r,s=toFraction(o[0].exposure_time)+"",c;return{c(){t=element("tr"),e=element("td"),e.textContent="shutter speed",i=space(),r=element("td"),c=text(s)},m(a,u){insert(a,t,u),append(t,e),append(t,i),append(t,r),append(r,c)},p(a,u){u&1&&s!==(s=toFraction(a[0].exposure_time)+"")&&set_data(c,s)},d(a){a&&detach(t)}}}function create_if_block_3$a(o){let t,e,i,r,s=o[0].iso+"",c;return{c(){t=element("tr"),e=element("td"),e.textContent="ISO",i=space(),r=element("td"),c=text(s)},m(a,u){insert(a,t,u),append(t,e),append(t,i),append(t,r),append(r,c)},p(a,u){u&1&&s!==(s=a[0].iso+"")&&set_data(c,s)},d(a){a&&detach(t)}}}function create_if_block_1$g(o){let t,e,i,r,s;return{c(){t=element("tr"),e=element("td"),e.textContent="filepath",i=space(),r=element("td"),s=text(o[2]),attr(r,"class","break-all")},m(c,a){insert(c,t,a),append(t,e),append(t,i),append(t,r),append(r,s)},p(c,a){a&4&&set_data(s,c[2])},d(c){c&&detach(t)}}}function create_fragment$r(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v,w=o[0].type!="video"&&create_if_block_10$1(o),k=o[0].gps_lat!=null&&create_if_block_9$1(o);const $=[create_if_block$m,create_if_block_2$d,create_if_block_8$1],T=[];function P(E,x){return E[4]==0?0:E[4]==1?1:E[4]==2&&E[0].gps_lat!=null?2:-1}return~(d=P(o))&&(m=T[d]=$[d](o)),{c(){t=element("div"),e=element("div"),i=element("a"),r=text("file"),c=space(),w&&w.c(),a=space(),k&&k.c(),u=space(),f=element("div"),p=element("div"),m&&m.c(),attr(i,"class",s="tab bg-base-200 tab-lifted"+(o[4]==0?" tab-active":"")),attr(e,"class","tabs w-full flex justify-center"),attr(p,"class","card-body"),attr(f,"class","card w-full bg-base-100 shadow-xl"),attr(t,"class","w-full")},m(E,x){insert(E,t,x),append(t,e),append(e,i),append(i,r),append(e,c),w&&w.m(e,null),append(e,a),k&&k.m(e,null),append(t,u),append(t,f),append(f,p),~d&&T[d].m(p,null),g=!0,h||(v=listen(i,"click",o[5]),h=!0)},p(E,[x]){(!g||x&16&&s!==(s="tab bg-base-200 tab-lifted"+(E[4]==0?" tab-active":"")))&&attr(i,"class",s),E[0].type!="video"?w?w.p(E,x):(w=create_if_block_10$1(E),w.c(),w.m(e,a)):w&&(w.d(1),w=null),E[0].gps_lat!=null?k?k.p(E,x):(k=create_if_block_9$1(E),k.c(),k.m(e,null)):k&&(k.d(1),k=null);let S=d;d=P(E),d===S?~d&&T[d].p(E,x):(m&&(group_outros(),transition_out(T[S],1,1,()=>{T[S]=null}),check_outros()),~d?(m=T[d],m?m.p(E,x):(m=T[d]=$[d](E),m.c()),transition_in(m,1),m.m(p,null)):m=null)},i(E){g||(transition_in(m),g=!0)},o(E){transition_out(m),g=!1},d(E){E&&detach(t),w&&w.d(),k&&k.d(),~d&&T[d].d(),h=!1,v()}}}function toFraction(o){return o?"1/"+Math.round(1/o)+" s":null}function check(o){return!(o==null||o==0||String(o).includes("null"))}function instance$s(o,t,e){let{info:i}=t,r="",s="",c,a=0;async function u(){try{let v=await fetch("https://nominatim.openstreetmap.org/reverse?lat="+i.gps_lat+"&lon="+i.gps_lon+"&format=json").then(w=>w.json());e(1,r=v.display_name!=null?v.display_name:"")}catch{e(1,r="")}}async function f(){let v=await request("file/path/"+i.id);v.ok&&e(2,s=await v.text())}async function p(){e(3,c=Math.round(i.size/(1024*1024)*100)/100+" MiB")}async function d(){f(),p(),i.gps_lat!=null?u():a==2&&e(4,a=0)}const m=()=>e(4,a=0),g=()=>e(4,a=1),h=()=>e(4,a=2);return o.$$set=v=>{"info"in v&&e(0,i=v.info)},o.$$.update=()=>{o.$$.dirty&1&&i&&d()},[i,r,s,c,a,m,g,h]}class LightboxInfo extends SvelteComponent{constructor(t){super(),init(this,t,instance$s,create_fragment$r,safe_not_equal,{info:0})}}var lib_min={exports:{}};(function(o,t){(function(e,i){o.exports=i()})(window,function(){return function(e){var i={};function r(s){if(i[s])return i[s].exports;var c=i[s]={i:s,l:!1,exports:{}};return e[s].call(c.exports,c,c.exports,r),c.l=!0,c.exports}return r.m=e,r.c=i,r.d=function(s,c,a){r.o(s,c)||Object.defineProperty(s,c,{enumerable:!0,get:a})},r.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},r.t=function(s,c){if(1&c&&(s=r(s)),8&c||4&c&&typeof s=="object"&&s&&s.__esModule)return s;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:s}),2&c&&typeof s!="string")for(var u in s)r.d(a,u,(function(f){return s[f]}).bind(null,u));return a},r.n=function(s){var c=s&&s.__esModule?function(){return s.default}:function(){return s};return r.d(c,"a",c),c},r.o=function(s,c){return Object.prototype.hasOwnProperty.call(s,c)},r.p="",r(r.s=2)}([function(e,i){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch{typeof window=="object"&&(r=window)}e.exports=r},function(e,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.fit=(c,a,u="fill")=>{if(u==="scale-down"&&(u=a.width<=c.width&&a.height<=c.height?"none":"contain"),u==="cover"||u==="contain"){const f=c.width/a.width,p=c.height/a.height,d=u==="cover"?Math.max(f,p):Math.min(f,p);return{width:a.width*d,height:a.height*d}}return u==="none"?a:c},i.position=(c,a,u="50%",f="50%")=>({x:s(u,c.width,a.width),y:s(f,c.height,a.height)}),i.fitAndPosition=(c,a,u="fill",f="50%",p="50%")=>{const d=i.fit(c,a,u),{x:m,y:g}=i.position(c,d,f,p),{width:h,height:v}=d;return{x:m,y:g,width:h,height:v}};const s=(c,a,u)=>c.endsWith("%")?(a-u)*(parseFloat(c)/100):parseFloat(c)},function(e,i,r){var s,c,a;c=[],s=function(){(function(u,f){c=[i,r(3)],(a=typeof(s=f)=="function"?s.apply(i,c):s)===void 0||(e.exports=a)})(0,function(u,f){function p(d){return d&&d.__esModule?d:{default:d}}Object.defineProperty(u,"__esModule",{value:!0}),Object.defineProperty(u,"default",{enumerable:!0,get:function(){return p(f).default}}),e.exports=u.default})},(a=typeof s=="function"?s.apply(i,c):s)===void 0||(e.exports=a)},function(e,i,r){var s,c,a;c=[],s=function(){(function(u,f){c=[i,r(4),r(5),r(6),r(7),r(10)],(a=typeof(s=f)=="function"?s.apply(i,c):s)===void 0||(e.exports=a)})(0,function(u,f,p,d,m,g){Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var h=$(f),v=$(p),w=$(d),k=$(g);function $(W){return W&&W.__esModule?W:{default:W}}function T(W,R){var U=Object.keys(W);if(Object.getOwnPropertySymbols){var z=Object.getOwnPropertySymbols(W);R&&(z=z.filter(function(C){return Object.getOwnPropertyDescriptor(W,C).enumerable})),U.push.apply(U,z)}return U}function P(W){for(var R=1;R<arguments.length;R++){var U=arguments[R]!=null?arguments[R]:{};R%2?T(Object(U),!0).forEach(function(z){E(W,z,U[z])}):Object.getOwnPropertyDescriptors?Object.defineProperties(W,Object.getOwnPropertyDescriptors(U)):T(Object(U)).forEach(function(z){Object.defineProperty(W,z,Object.getOwnPropertyDescriptor(U,z))})}return W}function E(W,R,U){return R in W?Object.defineProperty(W,R,{value:U,enumerable:!0,configurable:!0,writable:!0}):W[R]=U,W}function x(W,R){for(var U=0;U<R.length;U++){var z=R[U];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(W,z.key,z)}}function S(W,R,U){return R&&x(W.prototype,R),U&&x(W,U),W}function M(W){return(M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R})(W)}function O(W,R){if(!(W instanceof R))throw new TypeError("Cannot call a class as a function")}function q(W,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function");W.prototype=Object.create(R&&R.prototype,{constructor:{value:W,writable:!0,configurable:!0}}),R&&F(W,R)}function F(W,R){return(F=Object.setPrototypeOf||function(U,z){return U.__proto__=z,U})(W,R)}function A(W){var R=D();return function(){var U,z=X(W);if(R){var C=X(this).constructor;U=Reflect.construct(z,arguments,C)}else U=z.apply(this,arguments);return Z(this,U)}}function Z(W,R){return!R||M(R)!=="object"&&typeof R!="function"?I(W):R}function I(W){if(W===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return W}function D(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function X(W){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)})(W)}var N=function(W){q(U,W);var R=A(U);function U(){var z,C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},j=C.minZoom,V=j===void 0?.3:j,H=C.maxZoom,G=H===void 0?4:H,ee=C.zoomSpeed,re=ee===void 0?1:ee,ae=C.zoomEnabled,oe=ae===void 0||ae,le=C.panEnabled,fe=le===void 0||le,me=C.bounds,de=me===void 0?.8:me,ue=C.boundingElement,te=C.gestureTimeout,J=te===void 0?60:te,Q=C.initialFit,he=Q===void 0?null:Q,_e=arguments.length>1?arguments[1]:void 0,ne=arguments.length>2?arguments[2]:void 0;return O(this,U),(z=R.call(this,ne)).log("created with",arguments),z._x=0,z._y=0,z._z=1,z._cx=0,z._cy=0,z.boundingType=0,z._moving=!1,z.onResize=(0,w.default)(z.onResize.bind(I(z)),300),z.onGestureStart=z.onGestureStart.bind(I(z)),z.onGestureChange=z.onGestureChange.bind(I(z)),z.onGestureEnd=z.onGestureEnd.bind(I(z)),z.onDoubleClick=z.onDoubleClick.bind(I(z)),z.bounds=de,z.boundingElement=ue,z._zoomEnabled=fe,z._panEnabled=oe,z._zoomSpeed=re/100,z.minZoom=V,z.maxZoom=G,z.initialFit=he,z.gestureTimeout=J,_e&&z.init(_e,{}),z}return S(U,[{key:"init",value:function(z,C){if(this.destroy(),this.element=z,C)for(var j in C)this[j]=C[j];this._initPanZoom(),this._setTransformOrigin(),this._setSelectionProperties(),this._testTransform(),this.boundingElement||(this.boundingElement=z),this._resizeObserver=new k.default(this.onResize),this._resizeObserver.observe(this.boundingElement),this.info("initialized with",arguments),this.debug("settings:",this),this.initialFit==="center"?this.center(!1,!0):this.initialFit==="contain"?this.contain(!1,!0):this.initialFit==="cover"&&this.cover(!1,!0),this._initialized=!0}},{key:"destroy",value:function(){this.element&&(this.onResize.cancel&&this.onResize.cancel(),this._destroyPanZoom(),this._resizeObserver.disconnect(),this.removeAllListeners(),this.element=null,this.boundingElement=null,this._initialized=!1,this.info("destroyed"))}},{key:"_initPanZoom",value:function(){!this.unpz&&this.element&&this.enabled&&(this.unpz=new h.default(this.element,this.onGestureChange,{onStart:this.onGestureStart,onEnd:this.onGestureEnd,onDoubleTap:this.onDoubleClick}),this._moving=!1,this._panEnabled||this.disablePan(),this._zoomEnabled||this.disableZoom())}},{key:"_destroyPanZoom",value:function(){this.unpz&&(this.unpz(),this.unpz=null,this._moving=!1)}},{key:"enable",value:function(){this.enablePan(),this.enableZoom(),this._initPanZoom()}},{key:"disable",value:function(){this.disablePan(),this.disableZoom(),this._destroyPanZoom()}},{key:"enablePan",value:function(){this._panEnabled=!0,this.unpz.enablePan(),this.info("pan enabled")}},{key:"disablePan",value:function(){this._panEnabled=!1,this.unpz.disablePan(),this._moving=!1,this.info("pan disabled")}},{key:"enableZoom",value:function(){this._zoomEnabled=!0,this.unpz.enableZoom(),this.info("zoom enabled")}},{key:"disableZoom",value:function(){this._zoomEnabled=!1,this.unpz.disableZoom(),this._moving=!1,this.info("zoom disabled")}},{key:"reset",value:function(z,C){this._emitState("start"),this._setState(0,0,1,z,C)}},{key:"center",value:function(z,C){this._emitState("start");var j=this._percentToTranslation(.5,.5);this._setState(j.x,j.y,this._z,!1,z,C)}},{key:"contain",value:function(z,C){this._fitToBounds("contain",!1,z,C)}},{key:"cover",value:function(z,C){this._fitToBounds("cover",!1,z,C)}},{key:"scaleDown",value:function(z,C){this._fitToBounds("scale-down",!1,z,C)}},{key:"panTo",value:function(z,C,j,V){this._emitState("start");var H=this._percentToTranslation(z,C);this._setState(H.x,H.y,this._z,j,V)}},{key:"zoomTo",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5,j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:.5,V=arguments.length>3?arguments[3]:void 0,H=arguments.length>4?arguments[4]:void 0;this._emitState("start");var G=this._scaleToScaleDelta(z);this.zoomBy(G,C,j,V,H)}},{key:"centerOn",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:.5,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5,j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this._z,V=arguments.length>3?arguments[3]:void 0,H=arguments.length>4?arguments[4]:void 0;this._emitState("start");var G=this._percentToTranslation(z,C),ee=j-this._z,re=this._getPositionAdjustedForScale(ee,z,C),ae=G.x+re.x,oe=G.y+re.y;this._setState(ae,oe,j,V,H)}},{key:"zoomToArea",value:function(){}},{key:"_scaleToScaleDelta",value:function(z){return(this._z-z)/this._zoomSpeed}},{key:"_percentToTranslation",value:function(z,C){var j=this.boundingWidth,V=this.boundingHeight,H=this.element.getBoundingClientRect();return{x:j/2-H.width*z,y:V/2-H.height*C}}},{key:"getContainSize",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.element,C=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.boundingElement).getBoundingClientRect(),j=z.getBoundingClientRect(),V=(0,m.fitAndPosition)(C,j,"contain","50%","50%");return P(P({},V),{},{scale:V.width/j.width})}},{key:"getCoverSize",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.element,C=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.boundingElement).getBoundingClientRect(),j=z.getBoundingClientRect(),V=(0,m.fitAndPosition)(C,j,"cover","50%","50%");return P(P({},V),{},{scale:V.width/j.width})}},{key:"getScaleDownSize",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.element,C=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.boundingElement).getBoundingClientRect(),j=z.getBoundingClientRect(),V=(0,m.fitAndPosition)(C,j,"scale-down","50%","50%");return P(P({},V),{},{scale:V.width/j.width})}},{key:"_fitToBounds",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"contain",C=arguments.length>1?arguments[1]:void 0,j=arguments.length>2?arguments[2]:void 0,V=arguments.length>3?arguments[3]:void 0,H=this.boundingElement.getBoundingClientRect(),G=this.element.getBoundingClientRect(),ee=(0,m.fitAndPosition)(H,G,z,"50%","50%"),re=ee.x,ae=ee.y,oe=ee.width/G.width*this._z;this._emitState("start"),this._setState(re,ae,oe,C,j,V)}},{key:"onGestureStart",value:function(){this._moving=!0,this._emitState("start"),this._emitState("gesturestart")}},{key:"onGestureEnd",value:function(){this._moving=!1,this._clampStateAfterTransition(),this._emitState("end"),this._emitState("gestureend")}},{key:"onGestureChange",value:function(z){var C=z.dx,j=C===void 0?0:C,V=z.dy,H=V===void 0?0:V,G=z.dz,ee=G===void 0?0:G,re=z.px0,ae=z.py0,oe=z.event;if(this.enabled){oe.preventDefault();var le=this._x,fe=this._y,me=this._z;if(this._panEnabled&&(le+=j,fe+=H),this._zoomEnabled){var de=this._calculatePositionForZoom(this._z,ee,re,ae);le+=de.x,fe+=de.y,me=de.z}this._gestureUpdate(le,fe,me,re,ae)}}},{key:"panBy",value:function(z,C,j,V){var H=this._x+z,G=this._y+C;this._setState(H,G,this._z,j,V)}},{key:"zoomBy",value:function(z,C,j,V,H){var G=this._x,ee=this._y,re=this._z,ae=this._calculatePositionForZoom(this._z,z,C,j);G+=ae.x,ee+=ae.y,re=ae.z,this._setState(G,ee,re,V,H)}},{key:"onDoubleClick",value:function(z){var C=z.px0,j=z.py0;if(this._zoomEnabled){var V=this.maxZoom,H=this.minZoom;this.initialFit&&(this.initialFit==="contain"?H=this.getContainSize().scale:this.initialFit==="cover"?H=this.getCoverSize().scale:this.initialFit==="scale-down"&&(H=this.getScaleDownSize().scale));var G=H+(V-H)/2,ee=this._z>G?H:V,re=(this._z-ee)/this._zoomSpeed;this.log("DOUBLE CLICK","this._z",this._z,"mid",G,"z",ee,"dz",re),this.zoomBy(re,C,j,!0)}}},{key:"onResize",value:function(){this._clampStateAfterTransition(),this.info("resize end")}},{key:"_setState",value:function(z,C,j,V){var H=arguments.length>5?arguments[5]:void 0;arguments.length>4&&arguments[4]!==void 0&&!arguments[4]?this.update(z,C,j,V,H):this._transitionTo(z,C,j,V)}},{key:"_transitionTo",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,V=arguments.length>3?arguments[3]:void 0;this._x===z&&this._y===C&&this._z===j||(this.log("TRANSITION TO","x",z,"y",C,"z",j),this._x=z,this._y=C,this._z=j,this._transitionToState(V))}},{key:"_cancelRAF",value:function(){this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null)}},{key:"update",value:function(z,C,j){var V=this,H=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],G=arguments.length>4&&arguments[4]!==void 0&&arguments[4];if(G||(this._moving=!0),H){var ee=this._clampPanZoom(z,C,j);this._x=ee.x,this._y=ee.y,this._z=ee.z}else this._x=z,this._y=C,this._z=j;this._cancelRAF(),this._cancelTransitions(),G?this._setTransform(this._x,this._y,this._z):this.rafId=requestAnimationFrame(function(){V._setTransform(V._x,V._y,V._z),V.rafId=null,V._moving=!1,V._emitState("update")})}},{key:"_gestureUpdate",value:function(z,C,j,V,H){var G=this;this._x=z,this._y=C,this._z=j,this._cx=V,this._cy=H,this._cancelRAF(),this._cancelTransitions(),this.rafId=requestAnimationFrame(function(){G._setTransform(G._x,G._y,G._z),G.rafId=null,G._emitState("update")})}},{key:"_calculatePositionForZoom",value:function(z,C,j,V){if(C===0)return{x:0,y:0,z};var H=z,G=-1*C*this._zoomSpeed;H=Math.min(Math.max(z+G,this.minZoom),this.maxZoom);var ee=H-z;return P(P({},ee?this._getPositionAdjustedForScale(ee,j,V):{x:0,y:0}),{},{z:H})}},{key:"_getPositionAdjustedForScale",value:function(z){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return{x:-this.elementWidth*z*C,y:-this.elementHeight*z*j}}},{key:"_clampZoom",value:function(z){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5,j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:.5,V=arguments.length>3&&arguments[3]!==void 0?arguments[3]:this.minZoom,H=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.maxZoom,G=0,ee=0,re=z;if(V!=null&&(re=Math.max(re,V)),H!=null&&(re=Math.min(re,H)),z!==re){var ae=re-z,oe=this._getPositionAdjustedForScale(ae,C,j);G+=oe.x,ee+=oe.y,this.info("CLAMP SCALE:","unclamped scale",z,"clamped scale",re,"dz",ae,"x",G,"y",ee)}return{x:G,y:ee,z:re}}},{key:"_clampPan",value:function(z,C){var j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.bounds,V=z,H=C;if(j){var G,ee,re,ae,oe=this.boundingWidth,le=this.boundingHeight,fe=this.elementWidth,me=this.elementHeight,de=Math.ceil(fe*this._z),ue=Math.ceil(me*this._z);if(this.boundingType===0)G=oe*(1-j)-de,ee=le*(1-j)-ue,re=oe*j,ae=le*j;else if(this.boundingType===1){var te=de*j,J=ue*j;G=-te,ee=-J,re=oe-(de-te),ae=le-(ue-J)}else{var Q=Math.round(100*j);G=-de+Q,ee=-ue+Q,re=oe-Q,ae=le-Q}V=Math.min(Math.max(z,G),re),H=Math.min(Math.max(C,ee),ae),V===z&&H===C||this.log("CLAMP X/Y:","x",z,"clamped x",V,"xMin",G,"xMax",re,"y",C,"clamped y",H,"yMin",ee,"yMax",ae)}return{x:V,y:H}}},{key:"_clampPanZoom",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._x,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._y,j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this._z,V=!1,H=this._clampZoom(j);H.z!==j&&(V=!0,j=H.z,z=H.x,C=H.y);var G=this._clampPan(z,C);return z===G.x&&C===G.y||(V=!0,z=G.x,C=G.y),{clamped:V,x:z,y:C,z:j}}},{key:"_clampStateAfterTransition",value:function(){var z=this._clampPanZoom();z.clamped&&(this._x=z.x,this._y=z.y,this._z=z.z,this._transitionToState())}},{key:"_transitionToState",value:function(z){var C=this;this._setTransition(z),requestAnimationFrame(function(){C._setTransform(C._x,C._y,C._z),C._emitState("update")})}},{key:"_cancelTransitions",value:function(){this._cancelTransitionEndListener&&this._cancelTransitionEndListener()}},{key:"_setTransition",value:function(){var z=this,C=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],j=this.element.style.transition;if(!/transform /.test(j)){var V=function(){z._cancelTransitions(),z._emitState("update"),z._moving=!1,C?z._clampStateAfterTransition():z._emitState("end")};this._cancelTransitionEndListener=function(){z.element.style.transition=j,z.element.removeEventListener("transitionend",V),z._cancelTransitionEndListener=null},this._moving=!0,this.element.addEventListener("transitionend",V),this.element.style.transition="transform 300ms cubic-bezier(0.785, 0.135, 0.150, 0.860)"}}},{key:"_setSelectionProperties",value:function(){this.element.style.touchAction&&this.element.style.touchAction!=="none"&&this.warn('element already has a "touch-action" style set. PanZ will reset the "touch-action" to "none" for propery gesture handling.'),this.element.style.touchAction="none",this.element.style.userSelect="none"}},{key:"_setTransformOrigin",value:function(){this.element.style.transformOrigin&&this.warn('element already has a "transform-origin" style set. PanZ will reset the "transform-origin" to "0 0" for proper pan/zoom functionality.'),this.element.style.transformOrigin="0 0"}},{key:"_setTransform",value:function(z,C,j){this.element.style.transform="translate(".concat(z,"px, ").concat(C,"px) scale(").concat(j,")")}},{key:"_testTransform",value:function(){this.element.style.transform&&this.warn('element already has a "transform" style set. Be aware that PanZ will modify the "transform" style during pan/zoom gestures, overriding your custom transform.')}},{key:"_emitState",value:function(z){var C=this.elementWidth,j=this.elementHeight,V={x:this._x,y:this._y,scale:this._z,width:Math.ceil(C*this._z),height:Math.ceil(j*this._z),unscaledWidth:C,unscaledHeight:j};this[z==="update"?"debug":"log"](z.toUpperCase(),"x",V.x.toFixed(0),"y",V.y.toFixed(0),"scale",V.scale.toFixed(4),"width",V.width.toFixed(0),"height",V.height.toFixed(0),"originalWidth",V.unscaledWidth,"originalHeight",V.unscaledHeight),this.emit(z,V)}},{key:"scale",get:function(){return this._z}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"moving",get:function(){return this._moving}},{key:"initialized",get:function(){return this._initialized}},{key:"enabled",get:function(){return this._panEnabled||this._zoomEnabled}},{key:"panEnabled",get:function(){return this._panEnabled}},{key:"zoomEnabled",get:function(){return this._zoomEnabled}},{key:"position",get:function(){return{x:this._x,y:this._y,z:this._z}}},{key:"elementWidth",get:function(){return this.element.offsetWidth||this.element.clientWidth}},{key:"elementHeight",get:function(){return this.element.offsetHeight||this.element.clientHeight}},{key:"boundingWidth",get:function(){return this.boundingElement.offsetWidth||this.boundingElement.clientWidth}},{key:"boundingHeight",get:function(){return this.boundingElement.offsetHeight||this.boundingElement.clientHeight}}]),U}(function(W){q(U,W);var R=A(U);function U(){var z,C=arguments.length>0&&arguments[0]!==void 0&&arguments[0];O(this,U),z=R.call(this);var j=function(H){return console[H].bind(window.console,"[PanZ]")},V=function(){};return["debug","log","info"].forEach(function(H){z[H]=C?j(H):V}),z.error=j("error"),z.warn=j("warn"),z}return U}(v.default));u.default=N,e.exports=u.default})},(a=typeof s=="function"?s.apply(i,c):s)===void 0||(e.exports=a)},function(e,i,r){e.exports=function(s){var c={};function a(u){if(c[u])return c[u].exports;var f=c[u]={i:u,l:!1,exports:{}};return s[u].call(f.exports,f,f.exports,a),f.l=!0,f.exports}return a.m=s,a.c=c,a.d=function(u,f,p){a.o(u,f)||Object.defineProperty(u,f,{enumerable:!0,get:p})},a.r=function(u){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(u,"__esModule",{value:!0})},a.t=function(u,f){if(1&f&&(u=a(u)),8&f||4&f&&typeof u=="object"&&u&&u.__esModule)return u;var p=Object.create(null);if(a.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:u}),2&f&&typeof u!="string")for(var d in u)a.d(p,d,(function(m){return u[m]}).bind(null,d));return p},a.n=function(u){var f=u&&u.__esModule?function(){return u.default}:function(){return u};return a.d(f,"a",f),f},a.o=function(u,f){return Object.prototype.hasOwnProperty.call(u,f)},a.p="",a(a.s=9)}([function(s,c,a){var u=a(7);s.exports=u&&function(){var f=!1;try{var p=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("test",null,p),window.removeEventListener("test",null,p)}catch{f=!1}return f}()},function(s,c,a){var u,f=typeof Reflect=="object"?Reflect:null,p=f&&typeof f.apply=="function"?f.apply:function(x,S,M){return Function.prototype.apply.call(x,S,M)};u=f&&typeof f.ownKeys=="function"?f.ownKeys:Object.getOwnPropertySymbols?function(x){return Object.getOwnPropertyNames(x).concat(Object.getOwnPropertySymbols(x))}:function(x){return Object.getOwnPropertyNames(x)};var d=Number.isNaN||function(x){return x!=x};function m(){m.init.call(this)}s.exports=m,s.exports.once=function(x,S){return new Promise(function(M,O){function q(){F!==void 0&&x.removeListener("error",F),M([].slice.call(arguments))}var F;S!=="error"&&(F=function(A){x.removeListener(S,q),O(A)},x.once("error",F)),x.once(S,q)})},m.EventEmitter=m,m.prototype._events=void 0,m.prototype._eventsCount=0,m.prototype._maxListeners=void 0;var g=10;function h(x){if(typeof x!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof x)}function v(x){return x._maxListeners===void 0?m.defaultMaxListeners:x._maxListeners}function w(x,S,M,O){var q,F,A,Z;if(h(M),(F=x._events)===void 0?(F=x._events=Object.create(null),x._eventsCount=0):(F.newListener!==void 0&&(x.emit("newListener",S,M.listener?M.listener:M),F=x._events),A=F[S]),A===void 0)A=F[S]=M,++x._eventsCount;else if(typeof A=="function"?A=F[S]=O?[M,A]:[A,M]:O?A.unshift(M):A.push(M),(q=v(x))>0&&A.length>q&&!A.warned){A.warned=!0;var I=new Error("Possible EventEmitter memory leak detected. "+A.length+" "+String(S)+" listeners added. Use emitter.setMaxListeners() to increase limit");I.name="MaxListenersExceededWarning",I.emitter=x,I.type=S,I.count=A.length,Z=I,console&&console.warn&&console.warn(Z)}return x}function k(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function $(x,S,M){var O={fired:!1,wrapFn:void 0,target:x,type:S,listener:M},q=k.bind(O);return q.listener=M,O.wrapFn=q,q}function T(x,S,M){var O=x._events;if(O===void 0)return[];var q=O[S];return q===void 0?[]:typeof q=="function"?M?[q.listener||q]:[q]:M?function(F){for(var A=new Array(F.length),Z=0;Z<A.length;++Z)A[Z]=F[Z].listener||F[Z];return A}(q):E(q,q.length)}function P(x){var S=this._events;if(S!==void 0){var M=S[x];if(typeof M=="function")return 1;if(M!==void 0)return M.length}return 0}function E(x,S){for(var M=new Array(S),O=0;O<S;++O)M[O]=x[O];return M}Object.defineProperty(m,"defaultMaxListeners",{enumerable:!0,get:function(){return g},set:function(x){if(typeof x!="number"||x<0||d(x))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+x+".");g=x}}),m.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},m.prototype.setMaxListeners=function(x){if(typeof x!="number"||x<0||d(x))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+x+".");return this._maxListeners=x,this},m.prototype.getMaxListeners=function(){return v(this)},m.prototype.emit=function(x){for(var S=[],M=1;M<arguments.length;M++)S.push(arguments[M]);var O=x==="error",q=this._events;if(q!==void 0)O=O&&q.error===void 0;else if(!O)return!1;if(O){var F;if(S.length>0&&(F=S[0]),F instanceof Error)throw F;var A=new Error("Unhandled error."+(F?" ("+F.message+")":""));throw A.context=F,A}var Z=q[x];if(Z===void 0)return!1;if(typeof Z=="function")p(Z,this,S);else{var I=Z.length,D=E(Z,I);for(M=0;M<I;++M)p(D[M],this,S)}return!0},m.prototype.addListener=function(x,S){return w(this,x,S,!1)},m.prototype.on=m.prototype.addListener,m.prototype.prependListener=function(x,S){return w(this,x,S,!0)},m.prototype.once=function(x,S){return h(S),this.on(x,$(this,x,S)),this},m.prototype.prependOnceListener=function(x,S){return h(S),this.prependListener(x,$(this,x,S)),this},m.prototype.removeListener=function(x,S){var M,O,q,F,A;if(h(S),(O=this._events)===void 0)return this;if((M=O[x])===void 0)return this;if(M===S||M.listener===S)--this._eventsCount==0?this._events=Object.create(null):(delete O[x],O.removeListener&&this.emit("removeListener",x,M.listener||S));else if(typeof M!="function"){for(q=-1,F=M.length-1;F>=0;F--)if(M[F]===S||M[F].listener===S){A=M[F].listener,q=F;break}if(q<0)return this;q===0?M.shift():function(Z,I){for(;I+1<Z.length;I++)Z[I]=Z[I+1];Z.pop()}(M,q),M.length===1&&(O[x]=M[0]),O.removeListener!==void 0&&this.emit("removeListener",x,A||S)}return this},m.prototype.off=m.prototype.removeListener,m.prototype.removeAllListeners=function(x){var S,M,O;if((M=this._events)===void 0)return this;if(M.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):M[x]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete M[x]),this;if(arguments.length===0){var q,F=Object.keys(M);for(O=0;O<F.length;++O)(q=F[O])!=="removeListener"&&this.removeAllListeners(q);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(S=M[x])=="function")this.removeListener(x,S);else if(S!==void 0)for(O=S.length-1;O>=0;O--)this.removeListener(x,S[O]);return this},m.prototype.listeners=function(x){return T(this,x,!0)},m.prototype.rawListeners=function(x){return T(this,x,!1)},m.listenerCount=function(x,S){return typeof x.listenerCount=="function"?x.listenerCount(S):P.call(x,S)},m.prototype.listenerCount=P,m.prototype.eventNames=function(){return this._eventsCount>0?u(this._events):[]}},function(s,c){var a={left:0,top:0};s.exports=function(u,f,p){f=f||u.currentTarget||u.srcElement,Array.isArray(p)||(p=[0,0]);var d,m=u.clientX||0,g=u.clientY||0,h=(d=f)===window||d===document||d===document.body?a:d.getBoundingClientRect();return p[0]=m-h.left,p[1]=g-h.top,p}},function(s,c){s.exports=function(a,u){return{configurable:!0,enumerable:!0,get:a,set:u}}},function(s,c){s.exports=function(a,u){var f=u[0]-a[0],p=u[1]-a[1];return Math.sqrt(f*f+p*p)}},function(s,c,a){var u=a(2),f=a(1).EventEmitter;function p(d){var m=(d=d||{}).element||window,g=new f,h=d.position||[0,0];return d.touchstart!==!1&&(m.addEventListener("mousedown",w,!1),m.addEventListener("touchstart",v,!1)),m.addEventListener("mousemove",w,!1),m.addEventListener("touchmove",v,!1),g.position=h,g.dispose=function(){m.removeEventListener("mousemove",w,!1),m.removeEventListener("mousedown",w,!1),m.removeEventListener("touchmove",v,!1),m.removeEventListener("touchstart",v,!1)},g;function v(k){w(k.targetTouches[0])}function w(k){u(k,m,h),g.emit("move",k)}}s.exports=function(d){return p(d).position},s.exports.emitter=function(d){return p(d)}},function(s,c,a){(function(u){var f=/^\s+|\s+$/g,p=/^[-+]0x[0-9a-f]+$/i,d=/^0b[01]+$/i,m=/^0o[0-7]+$/i,g=parseInt,h=typeof u=="object"&&u&&u.Object===Object&&u,v=typeof self=="object"&&self&&self.Object===Object&&self,w=h||v||Function("return this")(),k=Object.prototype.toString,$=Math.max,T=Math.min,P=function(){return w.Date.now()};function E(S){var M=typeof S;return!!S&&(M=="object"||M=="function")}function x(S){if(typeof S=="number")return S;if(function(q){return typeof q=="symbol"||function(F){return!!F&&typeof F=="object"}(q)&&k.call(q)=="[object Symbol]"}(S))return NaN;if(E(S)){var M=typeof S.valueOf=="function"?S.valueOf():S;S=E(M)?M+"":M}if(typeof S!="string")return S===0?S:+S;S=S.replace(f,"");var O=d.test(S);return O||m.test(S)?g(S.slice(2),O?2:8):p.test(S)?NaN:+S}s.exports=function(S,M,O){var q,F,A,Z,I,D,X=0,N=!1,W=!1,R=!0;if(typeof S!="function")throw new TypeError("Expected a function");function U(G){var ee=q,re=F;return q=F=void 0,X=G,Z=S.apply(re,ee)}function z(G){return X=G,I=setTimeout(j,M),N?U(G):Z}function C(G){var ee=G-D;return D===void 0||ee>=M||ee<0||W&&G-X>=A}function j(){var G=P();if(C(G))return V(G);I=setTimeout(j,function(ee){var re=M-(ee-D);return W?T(re,A-(ee-X)):re}(G))}function V(G){return I=void 0,R&&q?U(G):(q=F=void 0,Z)}function H(){var G=P(),ee=C(G);if(q=arguments,F=this,D=G,ee){if(I===void 0)return z(D);if(W)return I=setTimeout(j,M),U(D)}return I===void 0&&(I=setTimeout(j,M)),Z}return M=x(M)||0,E(O)&&(N=!!O.leading,A=(W="maxWait"in O)?$(x(O.maxWait)||0,M):A,R="trailing"in O?!!O.trailing:R),H.cancel=function(){I!==void 0&&clearTimeout(I),X=0,q=D=F=I=void 0},H.flush=function(){return I===void 0?Z:V(P())},H}}).call(this,a(8))},function(s,c){s.exports=!0},function(s,c){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch{typeof window=="object"&&(a=window)}s.exports=a},function(s,c,a){a.r(c);var u=a(1),f=a(0),p=a.n(f);function d(N){return(d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W})(N)}function m(N,W){return(m=Object.setPrototypeOf||function(R,U){return R.__proto__=U,R})(N,W)}function g(N){var W=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var R,U=w(N);if(W){var z=w(this).constructor;R=Reflect.construct(U,arguments,z)}else R=U.apply(this,arguments);return h(this,R)}}function h(N,W){return!W||d(W)!=="object"&&typeof W!="function"?v(N):W}function v(N){if(N===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N}function w(N){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(W){return W.__proto__||Object.getPrototypeOf(W)})(N)}var k=!!p.a&&{capture:!1,passive:!0},$=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(N){window.setTimeout(N,1e3/60)};window.addEventListener("touchmove",function(){});var T=function(N){(function(U,z){if(typeof z!="function"&&z!==null)throw new TypeError("Super expression must either be null or a function");U.prototype=Object.create(z&&z.prototype,{constructor:{value:U,writable:!0,configurable:!0}}),z&&m(U,z)})(R,N);var W=g(R);function R(U){var z,C,j,V,H,G,ee,re,ae,oe,le,fe,me=U.source,de=me===void 0?document:me,ue=U.update,te=U.multiplier,J=te===void 0?1:te,Q=U.friction,he=Q===void 0?.92:Q,_e=U.initialValues,ne=U.boundX,ie=U.boundY,ye=U.bounce,Oe=ye===void 0||ye;(function(ge,ke){if(!(ge instanceof ke))throw new TypeError("Cannot call a class as a function")})(this,R),z=W.call(this);var Le=0,ve=0,Se=.3*J,pe=!1,ze=!1,je=!1,Ge=!1,He=[],Ie=null;(function(){if(!(de=typeof de=="string"?document.querySelector(de):de))throw new Error("IMPETUS: source not found.");if(!ue)throw new Error("IMPETUS: update function not defined.");_e&&(_e[0]&&(Le=_e[0]),_e[1]&&(ve=_e[1]),Fe()),ne&&(C=ne[0],j=ne[1]),ie&&(V=ie[0],H=ie[1]),de.addEventListener("touchstart",nt,k),de.addEventListener("mousedown",nt,k)})();var tt=z.emit.bind(v(z));function Ue(){document.removeEventListener("touchmove",Ze,!!p.a&&{passive:!1}),document.removeEventListener("touchend",Pe,k),document.removeEventListener("touchcancel",De,k),document.removeEventListener("mousemove",Ze,!!p.a&&{passive:!1}),document.removeEventListener("mouseup",Pe,k)}function Fe(){ue.call(de,Le,ve,Ie)}function rt(ge){if(ge.type==="touchmove"||ge.type==="touchstart"||ge.type==="touchend"){var ke=ge.targetTouches[0]||ge.changedTouches[0];return{x:ke.clientX,y:ke.clientY,id:ke.identifier}}return{x:ge.clientX,y:ge.clientY,id:null}}function nt(ge){Ie=ge;var ke=rt(ge);ze||je||(ze=!0,Ge=!1,oe=ke.id,G=re=ke.x,ee=ae=ke.y,He=[],at(G,ee),Ue(),document.addEventListener("touchmove",Ze,!!p.a&&{passive:!1}),document.addEventListener("touchend",Pe,k),document.addEventListener("touchcancel",De,k),document.addEventListener("mousemove",Ze,!!p.a&&{passive:!1}),document.addEventListener("mouseup",Pe,k),tt("start",{x:re,y:ae,event:Ie}))}function Ze(ge){ge.preventDefault(),Ie=ge;var ke=rt(ge);ze&&ke.id===oe&&(re=ke.x,ae=ke.y,at(G,ee),pe||$(Et),pe=!0)}function Pe(ge){Ie=ge;var ke=rt(ge);ze&&ke.id===oe&&De()}function De(){ze=!1,at(G,ee),function(){var ge=He[0],ke=He[He.length-1],Re=ke.x-ge.x,At=ke.y-ge.y,gt=(ke.time-ge.time)/15/J;le=Re/gt||0,fe=At/gt||0;var Yt=Xe();Math.abs(le)>1||Math.abs(fe)>1||!Yt.inBounds?(Ge=!0,$(mt)):tt("end",{x:Le,y:ve,event:Ie})}(),Ue()}function at(ge,ke){for(var Re=Date.now();He.length>0&&!(Re-He[0].time<=100);)He.shift();He.push({x:ge,y:ke,time:Re})}function Et(){var ge=re-G,ke=ae-ee;if(Le+=ge*J,ve+=ke*J,Oe){var Re=Xe();Re.x!==0&&(Le-=ge*ut(Re.x)*J),Re.y!==0&&(ve-=ke*ut(Re.y)*J)}else Xe(!0);Fe(),G=re,ee=ae,pe=!1}function ut(ge){return 5e-6*Math.pow(ge,2)+1e-4*ge+.55}function Xe(ge){var ke=0,Re=0;return C!==void 0&&Le<C?ke=C-Le:j!==void 0&&Le>j&&(ke=j-Le),V!==void 0&&ve<V?Re=V-ve:H!==void 0&&ve>H&&(Re=H-ve),ge&&(ke!==0&&(Le=ke>0?C:j),Re!==0&&(ve=Re>0?V:H)),{x:ke,y:Re,inBounds:ke===0&&Re===0}}function mt(){if(Ge){Le+=le*=he,ve+=fe*=he;var ge=Xe();if(Math.abs(le)>Se||Math.abs(fe)>Se||!ge.inBounds){if(Oe){if(ge.x!==0)if(ge.x*le<=0)le+=.04*ge.x;else{var ke=ge.x>0?2.5:-2.5;le=.11*(ge.x+ke)}if(ge.y!==0)if(ge.y*fe<=0)fe+=.04*ge.y;else{var Re=ge.y>0?2.5:-2.5;fe=.11*(ge.y+Re)}}else ge.x!==0&&(Le=ge.x>0?C:j,le=0),ge.y!==0&&(ve=ge.y>0?V:H,fe=0);Fe(),$(mt)}else Ge=!1,tt("end",{x:Le,y:ve,event:Ie})}}return z.destroy=function(){return de.removeEventListener("touchstart",nt),de.removeEventListener("mousedown",nt),Ue(),null},z.pause=function(){Ue(),ze=!1,je=!0},z.resume=function(){je=!1},z.setValues=function(ge,ke){typeof ge=="number"&&(Le=ge),typeof ke=="number"&&(ve=ke)},z.setMultiplier=function(ge){Se=.3*(J=ge)},z.setBoundX=function(ge){C=ge[0],j=ge[1]},z.setBoundY=function(ge){V=ge[0],H=ge[1]},z}return R}(u.EventEmitter),P=a(4),E=a.n(P),x=a(3),S=a.n(x),M=a(2),O=a.n(M),q=!!p.a&&{capture:!1,passive:!0};function F(){this.position=[0,0],this.touch=null}var A=function(N){N=N||window;var W=new u.EventEmitter,R=[null,null],U=0,z=0,C=!1,j=!1;return Object.defineProperties(W,{pinching:S()(function(){return U===2}),fingers:S()(function(){return R})}),H(),W.enable=H,W.disable=function(){j&&(j=!1,U=0,R[0]=null,R[1]=null,z=0,C=!1,N.removeEventListener("touchstart",G,q),N.removeEventListener("touchmove",ee,q),N.removeEventListener("touchend",re,q),N.removeEventListener("touchcancel",re,q))},W.indexOfTouch=V,W;function V(oe){for(var le=oe.identifier,fe=0;fe<R.length;fe++)if(R[fe]&&R[fe].touch&&R[fe].touch.identifier===le)return fe;return-1}function H(){j||(j=!0,N.addEventListener("touchstart",G,q),N.addEventListener("touchmove",ee,q),N.addEventListener("touchend",re,q),N.addEventListener("touchcancel",re,q))}function G(oe){for(var le=0;le<oe.changedTouches.length;le++){var fe=oe.changedTouches[le];if(V(fe.identifier)===-1&&U<2){var me=U===0,de=R[0]?1:0,ue=R[0]?0:1,te=new F;R[de]=te,U++,te.touch=fe,O()(fe,N,te.position);var J=R[ue]?R[ue].touch:void 0;if(W.emit("place",fe,J),!me){var Q=ae();C=!1,W.emit("start",Q,oe),z=Q}}}}function ee(oe){for(var le=!1,fe=0;fe<oe.changedTouches.length;fe++){var me=oe.changedTouches[fe],de=V(me);de!==-1&&(le=!0,R[de].touch=me,O()(me,N,R[de].position))}if(U===2&&le){var ue=ae();W.emit("change",ue,z,oe),z=ue}}function re(oe){for(var le=0;le<oe.changedTouches.length;le++){var fe=oe.changedTouches[le],me=V(fe);if(me!==-1){R[me]=null,U--;var de=me===0?1:0,ue=R[de]?R[de].touch:void 0;W.emit("lift",fe,ue,oe)}}C||U===2||(C=!0,W.emit("end",z,oe))}function ae(){return U<2?0:E()(R[0].position,R[1].position)}},Z=a(5),I=a.n(Z),D=a(6),X=a.n(D);c.default=function(N,W,R){function U(_e){R.onStart&&R.onStart(_e)}function z(_e){R.onEnd&&requestAnimationFrame(function(){R.onEnd(_e)})}N instanceof Function&&(W=N,N=document.documentElement||document.body),R||(R={});var C=null,j=null,V=null;typeof N=="string"&&(N=document.querySelector(N));var H,G,ee=I.a.emitter();function re(_e){return _e||(_e=N.getBoundingClientRect()),{x:ee.position[0]-_e.x,y:ee.position[1]-_e.y}}var ae={x:0,y:0,px:0,py:0},oe=0,le=0;(H=new T({source:N,update:function(_e,ne,ie){var ye=re(N.getBoundingClientRect()),Oe={srcElement:G,event:ie,target:N,type:"mouse",dx:_e-oe,dy:ne-le,dz:0,x:ye.x,y:ye.y,x0:ae.x,y0:ae.y,px0:ae.px,py0:ae.py};oe=_e,le=ne,W(Oe)},multiplier:R.friction||1,friction:R.multiplier||.75,boundX:R.boundX,boundY:R.boundY,bounce:R.bounce})).on("start",function(_e){var ne=_e.event,ie=N.getBoundingClientRect(),ye=re(ie);ae={x:ye.x,y:ye.y,px:ye.x/ie.width,py:ye.y/ie.height},U({srcElement:G=ne.srcElement,event:ne,target:N,type:"mouse",dx:0,dy:0,dz:0,x:ye.x,y:ye.y,x0:ae.x,y0:ae.y,px0:ae.px,py0:ae.py})}),H.on("end",function(_e){var ne=_e.event,ie=re();z({srcElement:G,event:ne,target:N,type:"mouse",dx:0,dy:0,dz:0,x:ie.x,y:ie.y,x0:ae.x,y0:ae.y,px0:ae.px,py0:ae.py})});var fe=null;function me(){if(fe)return fe;var _e=function(ne){R.passive||ne.preventDefault();var ie=N.getBoundingClientRect(),ye=ne.clientX-ie.x,Oe=ne.clientY-ie.y,Le=function(ve){ve||(ve={});var Se=N.getBoundingClientRect(),pe=re(Se),ze=j||{},je=V||{},Ge=ve.x!=null?ve.x:pe.x,He=ve.y!=null?ve.y:pe.y,Ie=je.x!=null?je.x:Ge,tt=je.y!=null?je.y:He,Ue=ve.dx!=null?ve.dx:Ge-Ie,Fe=ve.dy!=null?ve.dy:He-tt,rt=ve.dz!=null?ve.dz:0,nt=ze.x0!=null?ze.x0:ve.x0!=null?ve.x0:pe.x,Ze=ze.y0!=null?ze.y0:ve.y0!=null?ve.y0:pe.y,Pe=ze.px0!=null?ze.px0:nt/Se.width,De=ze.py0!=null?ze.py0:Ze/Se.height,at={type:ve.type||"mouse",srcElement:ve.srcElement||N,target:N,event:ve.event,x:Ge,y:He,dx:Ue,dy:Fe,dz:rt,x0:nt,y0:Ze,px0:Pe,py0:De},Et=!1;C||(Et=!0,j=V=at,U(at),C=X()(function(Xe){z(Xe),C=null,j=null,V=null},60)),C(at);var ut={isStart:Et,init:j,last:V,event:at};return V=ut.event,ut}({dx:0,dy:0,dz:.5*ne.deltaY,x:ye,y:Oe,x0:ye,y0:Oe,srcElement:ne.srcElement,event:ne,type:"mouse"});W(Le.event)};return N.addEventListener("wheel",_e,{passive:!!R.passive}),_e}function de(){fe&&(fe=N.removeEventListener("wheel",fe,{passive:!0}))}fe=me();var ue,te=A();function J(){return function(_e){var ne,ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window,ye=(arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}).threshold||500,Oe=function(Le){ne?(ne=clearTimeout(ne),_e&&_e(Le)):ne=setTimeout(function(){ne=null},ye)};return ie.addEventListener("click",Oe,{passive:!0}),function(){return ie.removeEventListener("click",Oe,{passive:!0}),null}}(function(){var _e,ne=N.getBoundingClientRect(),ie=re(ne);_e={srcElement:N,target:N,type:"mouse",dx:0,dy:0,dz:0,x:ie.x,y:ie.x,x0:ie.x,y0:ie.x,px0:ie.x/ne.width,py0:ie.y/ne.height},R.onDoubleTap&&R.onDoubleTap(_e)},N)}te.on("start",function(_e,ne){var ie,ye,Oe=(ie=te.fingers[0],[.5*(ye=te.fingers[1]).position[0]+.5*ie.position[0],.5*ye.position[1]+.5*ie.position[1]]),Le=N.getBoundingClientRect(),ve=Oe[0],Se=Oe[1];(function(pe,ze,je){return je||(je=N.getBoundingClientRect()),pe>=je.x&&pe<=je.x+je.width&&ze>=je.y&&ze<=je.y+je.height})(ve,Se,Le)&&(ve-=Le.x,Se-=Le.y,ue={x:ve,y:Se,px0:ve/Le.width,py0:Se/Le.height},H&&H.pause(),U({srcElement:ne.srcElement,event:ne,target:N,type:"touch",dx:0,dy:0,dz:0,x:ue.x,y:ue.y,x0:ue.x,y0:ue.y,px0:ue.px0,py0:ue.py0}))}),te.on("end",function(_e,ne){ue&&(H&&H.resume(),z({srcElement:ne.srcElement,event:ne,target:N,type:"touch",dx:0,dy:0,dz:0,x:ue.x,y:ue.y,x0:ue.x,y0:ue.y,px0:ue.px0,py0:ue.py0}),ue=null)}),te.on("change",function(_e,ne,ie){te.pinching&&ue&&W({srcElement:N,event:ie,target:N,type:"touch",dx:0,dy:0,dz:1.3*-(_e-ne),x:ue.x,y:ue.x,x0:ue.x,y0:ue.x,px0:ue.px0,py0:ue.py0})});var Q=J(),he=function(){ee.dispose(),H.destroy(),de(),Q&&(Q=Q()),te.disable()};return he.disablePan=function(){H&&H.pause()},he.enablePan=function(){H&&H.resume()},he.disableZoom=function(){te&&te.disable(),de(),Q&&(Q=Q())},he.enableZoom=function(){te&&te.enable(),fe=me(),Q=J()},he}}])},function(e,i,r){var s=Object.prototype.hasOwnProperty,c="~";function a(){}function u(m,g,h){this.fn=m,this.context=g,this.once=h||!1}function f(m,g,h,v,w){if(typeof h!="function")throw new TypeError("The listener must be a function");var k=new u(h,v||m,w),$=c?c+g:g;return m._events[$]?m._events[$].fn?m._events[$]=[m._events[$],k]:m._events[$].push(k):(m._events[$]=k,m._eventsCount++),m}function p(m,g){--m._eventsCount===0?m._events=new a:delete m._events[g]}function d(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(c=!1)),d.prototype.eventNames=function(){var m,g,h=[];if(this._eventsCount===0)return h;for(g in m=this._events)s.call(m,g)&&h.push(c?g.slice(1):g);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(m)):h},d.prototype.listeners=function(m){var g=c?c+m:m,h=this._events[g];if(!h)return[];if(h.fn)return[h.fn];for(var v=0,w=h.length,k=new Array(w);v<w;v++)k[v]=h[v].fn;return k},d.prototype.listenerCount=function(m){var g=c?c+m:m,h=this._events[g];return h?h.fn?1:h.length:0},d.prototype.emit=function(m,g,h,v,w,k){var $=c?c+m:m;if(!this._events[$])return!1;var T,P,E=this._events[$],x=arguments.length;if(E.fn){switch(E.once&&this.removeListener(m,E.fn,void 0,!0),x){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,g),!0;case 3:return E.fn.call(E.context,g,h),!0;case 4:return E.fn.call(E.context,g,h,v),!0;case 5:return E.fn.call(E.context,g,h,v,w),!0;case 6:return E.fn.call(E.context,g,h,v,w,k),!0}for(P=1,T=new Array(x-1);P<x;P++)T[P-1]=arguments[P];E.fn.apply(E.context,T)}else{var S,M=E.length;for(P=0;P<M;P++)switch(E[P].once&&this.removeListener(m,E[P].fn,void 0,!0),x){case 1:E[P].fn.call(E[P].context);break;case 2:E[P].fn.call(E[P].context,g);break;case 3:E[P].fn.call(E[P].context,g,h);break;case 4:E[P].fn.call(E[P].context,g,h,v);break;default:if(!T)for(S=1,T=new Array(x-1);S<x;S++)T[S-1]=arguments[S];E[P].fn.apply(E[P].context,T)}}return!0},d.prototype.on=function(m,g,h){return f(this,m,g,h,!1)},d.prototype.once=function(m,g,h){return f(this,m,g,h,!0)},d.prototype.removeListener=function(m,g,h,v){var w=c?c+m:m;if(!this._events[w])return this;if(!g)return p(this,w),this;var k=this._events[w];if(k.fn)k.fn!==g||v&&!k.once||h&&k.context!==h||p(this,w);else{for(var $=0,T=[],P=k.length;$<P;$++)(k[$].fn!==g||v&&!k[$].once||h&&k[$].context!==h)&&T.push(k[$]);T.length?this._events[w]=T.length===1?T[0]:T:p(this,w)}return this},d.prototype.removeAllListeners=function(m){var g;return m?(g=c?c+m:m,this._events[g]&&p(this,g)):(this._events=new a,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=c,d.EventEmitter=d,e.exports=d},function(e,i,r){(function(s){var c=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,f=/^0o[0-7]+$/i,p=parseInt,d=typeof s=="object"&&s&&s.Object===Object&&s,m=typeof self=="object"&&self&&self.Object===Object&&self,g=d||m||Function("return this")(),h=Object.prototype.toString,v=Math.max,w=Math.min,k=function(){return g.Date.now()};function $(P){var E=typeof P;return!!P&&(E=="object"||E=="function")}function T(P){if(typeof P=="number")return P;if(function(S){return typeof S=="symbol"||function(M){return!!M&&typeof M=="object"}(S)&&h.call(S)=="[object Symbol]"}(P))return NaN;if($(P)){var E=typeof P.valueOf=="function"?P.valueOf():P;P=$(E)?E+"":E}if(typeof P!="string")return P===0?P:+P;P=P.replace(c,"");var x=u.test(P);return x||f.test(P)?p(P.slice(2),x?2:8):a.test(P)?NaN:+P}e.exports=function(P,E,x){var S,M,O,q,F,A,Z=0,I=!1,D=!1,X=!0;if(typeof P!="function")throw new TypeError("Expected a function");function N(j){var V=S,H=M;return S=M=void 0,Z=j,q=P.apply(H,V)}function W(j){return Z=j,F=setTimeout(U,E),I?N(j):q}function R(j){var V=j-A;return A===void 0||V>=E||V<0||D&&j-Z>=O}function U(){var j=k();if(R(j))return z(j);F=setTimeout(U,function(V){var H=E-(V-A);return D?w(H,O-(V-Z)):H}(j))}function z(j){return F=void 0,X&&S?N(j):(S=M=void 0,q)}function C(){var j=k(),V=R(j);if(S=arguments,M=this,A=j,V){if(F===void 0)return W(A);if(D)return F=setTimeout(U,E),N(A)}return F===void 0&&(F=setTimeout(U,E)),q}return E=T(E)||0,$(x)&&(I=!!x.leading,O=(D="maxWait"in x)?v(T(x.maxWait)||0,E):O,X="trailing"in x?!!x.trailing:X),C.cancel=function(){F!==void 0&&clearTimeout(F),Z=0,S=A=M=F=void 0},C.flush=function(){return F===void 0?q:z(k())},C}}).call(this,r(0))},function(e,i,r){Object.defineProperty(i,"__esModule",{value:!0});var s=r(1);i.fit=s.fit,i.position=s.position,i.fitAndPosition=s.fitAndPosition;var c=r(8);i.transformFittedPoint=c.transformFittedPoint;var a=r(9);i.isFit=a.isFit},function(e,i,r){Object.defineProperty(i,"__esModule",{value:!0});const s=r(1);i.transformFittedPoint=(c,a,u,f="fill",p="50%",d="50%")=>{const{x:m,y:g,width:h,height:v}=s.fitAndPosition(a,u,f,p,d),w=u.width/h,k=u.height/v;return{x:(c.x-m)*w,y:(c.y-g)*k}}},function(e,i,r){Object.defineProperty(i,"__esModule",{value:!0});const s={contain:!0,cover:!0,fill:!0,none:!0,"scale-down":!0};i.isFit=c=>c in s},function(e,i,r){r.r(i),(function(s){var c=function(){if(typeof Map<"u")return Map;function A(Z,I){var D=-1;return Z.some(function(X,N){return X[0]===I&&(D=N,!0)}),D}return function(){function Z(){this.__entries__=[]}return Object.defineProperty(Z.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),Z.prototype.get=function(I){var D=A(this.__entries__,I),X=this.__entries__[D];return X&&X[1]},Z.prototype.set=function(I,D){var X=A(this.__entries__,I);~X?this.__entries__[X][1]=D:this.__entries__.push([I,D])},Z.prototype.delete=function(I){var D=this.__entries__,X=A(D,I);~X&&D.splice(X,1)},Z.prototype.has=function(I){return!!~A(this.__entries__,I)},Z.prototype.clear=function(){this.__entries__.splice(0)},Z.prototype.forEach=function(I,D){D===void 0&&(D=null);for(var X=0,N=this.__entries__;X<N.length;X++){var W=N[X];I.call(D,W[1],W[0])}},Z}()}(),a=typeof window<"u"&&typeof document<"u"&&window.document===document,u=typeof s<"u"&&s.Math===Math?s:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")(),f=typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(u):function(A){return setTimeout(function(){return A(Date.now())},1e3/60)},p=["top","right","bottom","left","width","height","size","weight"],d=typeof MutationObserver<"u",m=function(){function A(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(Z,I){var D=!1,X=!1,N=0;function W(){D&&(D=!1,Z()),X&&U()}function R(){f(W)}function U(){var z=Date.now();if(D){if(z-N<2)return;X=!0}else D=!0,X=!1,setTimeout(R,I);N=z}return U}(this.refresh.bind(this),20)}return A.prototype.addObserver=function(Z){~this.observers_.indexOf(Z)||this.observers_.push(Z),this.connected_||this.connect_()},A.prototype.removeObserver=function(Z){var I=this.observers_,D=I.indexOf(Z);~D&&I.splice(D,1),!I.length&&this.connected_&&this.disconnect_()},A.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},A.prototype.updateObservers_=function(){var Z=this.observers_.filter(function(I){return I.gatherActive(),I.hasActive()});return Z.forEach(function(I){return I.broadcastActive()}),Z.length>0},A.prototype.connect_=function(){a&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),d?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},A.prototype.disconnect_=function(){a&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},A.prototype.onTransitionEnd_=function(Z){var I=Z.propertyName,D=I===void 0?"":I;p.some(function(X){return!!~D.indexOf(X)})&&this.refresh()},A.getInstance=function(){return this.instance_||(this.instance_=new A),this.instance_},A.instance_=null,A}(),g=function(A,Z){for(var I=0,D=Object.keys(Z);I<D.length;I++){var X=D[I];Object.defineProperty(A,X,{value:Z[X],enumerable:!1,writable:!1,configurable:!0})}return A},h=function(A){return A&&A.ownerDocument&&A.ownerDocument.defaultView||u},v=E(0,0,0,0);function w(A){return parseFloat(A)||0}function k(A){for(var Z=[],I=1;I<arguments.length;I++)Z[I-1]=arguments[I];return Z.reduce(function(D,X){return D+w(A["border-"+X+"-width"])},0)}function $(A){var Z=A.clientWidth,I=A.clientHeight;if(!Z&&!I)return v;var D=h(A).getComputedStyle(A),X=function(j){for(var V={},H=0,G=["top","right","bottom","left"];H<G.length;H++){var ee=G[H],re=j["padding-"+ee];V[ee]=w(re)}return V}(D),N=X.left+X.right,W=X.top+X.bottom,R=w(D.width),U=w(D.height);if(D.boxSizing==="border-box"&&(Math.round(R+N)!==Z&&(R-=k(D,"left","right")+N),Math.round(U+W)!==I&&(U-=k(D,"top","bottom")+W)),!function(j){return j===h(j).document.documentElement}(A)){var z=Math.round(R+N)-Z,C=Math.round(U+W)-I;Math.abs(z)!==1&&(R-=z),Math.abs(C)!==1&&(U-=C)}return E(X.left,X.top,R,U)}var T=typeof SVGGraphicsElement<"u"?function(A){return A instanceof h(A).SVGGraphicsElement}:function(A){return A instanceof h(A).SVGElement&&typeof A.getBBox=="function"};function P(A){return a?T(A)?function(Z){var I=Z.getBBox();return E(0,0,I.width,I.height)}(A):$(A):v}function E(A,Z,I,D){return{x:A,y:Z,width:I,height:D}}var x=function(){function A(Z){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=E(0,0,0,0),this.target=Z}return A.prototype.isActive=function(){var Z=P(this.target);return this.contentRect_=Z,Z.width!==this.broadcastWidth||Z.height!==this.broadcastHeight},A.prototype.broadcastRect=function(){var Z=this.contentRect_;return this.broadcastWidth=Z.width,this.broadcastHeight=Z.height,Z},A}(),S=function(A,Z){var I,D,X,N,W,R,U,z=(D=(I=Z).x,X=I.y,N=I.width,W=I.height,R=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,U=Object.create(R.prototype),g(U,{x:D,y:X,width:N,height:W,top:X,right:D+N,bottom:W+X,left:D}),U);g(this,{target:A,contentRect:z})},M=function(){function A(Z,I,D){if(this.activeObservations_=[],this.observations_=new c,typeof Z!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=Z,this.controller_=I,this.callbackCtx_=D}return A.prototype.observe=function(Z){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(typeof Element<"u"&&Element instanceof Object){if(!(Z instanceof h(Z).Element))throw new TypeError('parameter 1 is not of type "Element".');var I=this.observations_;I.has(Z)||(I.set(Z,new x(Z)),this.controller_.addObserver(this),this.controller_.refresh())}},A.prototype.unobserve=function(Z){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(typeof Element<"u"&&Element instanceof Object){if(!(Z instanceof h(Z).Element))throw new TypeError('parameter 1 is not of type "Element".');var I=this.observations_;I.has(Z)&&(I.delete(Z),I.size||this.controller_.removeObserver(this))}},A.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},A.prototype.gatherActive=function(){var Z=this;this.clearActive(),this.observations_.forEach(function(I){I.isActive()&&Z.activeObservations_.push(I)})},A.prototype.broadcastActive=function(){if(this.hasActive()){var Z=this.callbackCtx_,I=this.activeObservations_.map(function(D){return new S(D.target,D.broadcastRect())});this.callback_.call(Z,I,Z),this.clearActive()}},A.prototype.clearActive=function(){this.activeObservations_.splice(0)},A.prototype.hasActive=function(){return this.activeObservations_.length>0},A}(),O=typeof WeakMap<"u"?new WeakMap:new c,q=function A(Z){if(!(this instanceof A))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var I=m.getInstance(),D=new M(Z,I,this);O.set(this,D)};["observe","unobserve","disconnect"].forEach(function(A){q.prototype[A]=function(){var Z;return(Z=O.get(this))[A].apply(Z,arguments)}});var F=typeof u.ResizeObserver<"u"?u.ResizeObserver:q;i.default=F}).call(this,r(0))}])})})(lib_min);var lib_minExports=lib_min.exports;const PanZ=getDefaultExportFromCjs(lib_minExports);function get_each_context$a(o,t,e){const i=o.slice();return i[13]=t[e],i}function create_else_block$b(o){let t,e,i,r,s,c,a,u=o[0],f=[];for(let d=0;d<u.length;d+=1)f[d]=create_each_block$a(get_each_context$a(o,u,d));const p=d=>transition_out(f[d],1,1,()=>{f[d]=null});return{c(){t=element("h3"),t.textContent="download:",e=space(),i=element("h3"),r=text(o[1]),s=space();for(let d=0;d<f.length;d+=1)f[d].c();c=empty(),attr(t,"class","font-bold text-lg text-center"),attr(i,"class","text-md font-mono text-center mb-5 mt-2")},m(d,m){insert(d,t,m),insert(d,e,m),insert(d,i,m),append(i,r),insert(d,s,m);for(let g=0;g<f.length;g+=1)f[g]&&f[g].m(d,m);insert(d,c,m),a=!0},p(d,m){if((!a||m&2)&&set_data(r,d[1]),m&165){u=d[0];let g;for(g=0;g<u.length;g+=1){const h=get_each_context$a(d,u,g);f[g]?(f[g].p(h,m),transition_in(f[g],1)):(f[g]=create_each_block$a(h),f[g].c(),transition_in(f[g],1),f[g].m(c.parentNode,c))}for(group_outros(),g=u.length;g<f.length;g+=1)p(g);check_outros()}},i(d){if(!a){for(let m=0;m<u.length;m+=1)transition_in(f[m]);a=!0}},o(d){f=f.filter(Boolean);for(let m=0;m<f.length;m+=1)transition_out(f[m]);a=!1},d(d){d&&detach(t),d&&detach(e),d&&detach(i),d&&detach(s),destroy_each(f,d),d&&detach(c)}}}function create_if_block$l(o){let t;return{c(){t=element("div"),t.innerHTML='<span class="loading loading-dots loading-lg"></span>',attr(t,"class","w-full h-32 flex justify-center items-center")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_each_block$a(o){let t,e,i,r=o[13].desc+"",s,c,a,u,f,p,d;return e=new Icons({props:{icon:"download"}}),{c(){t=element("a"),create_component(e.$$.fragment),i=space(),s=text(r),c=space(),attr(t,"class","btn w-full my-2"),attr(t,"href",a="/api/download/"+o[13].url),attr(t,"download",u=`${o[2]}${o[13].name}`)},m(m,g){insert(m,t,g),mount_component(e,t,null),append(t,i),append(t,s),append(t,c),f=!0,p||(d=listen(t,"click",o[9]),p=!0)},p(m,g){(!f||g&1)&&r!==(r=m[13].desc+"")&&set_data(s,r),(!f||g&1&&a!==(a="/api/download/"+m[13].url))&&attr(t,"href",a),(!f||g&5&&u!==(u=`${m[2]}${m[13].name}`))&&attr(t,"download",u)},i(m){f||(transition_in(e.$$.fragment,m),f=!0)},o(m){transition_out(e.$$.fragment,m),f=!1},d(m){m&&detach(t),destroy_component(e),p=!1,d()}}}function create_fragment$q(o){let t,e,i,r,s,c,a,u,f,p,d;const m=[create_if_block$l,create_else_block$b],g=[];function h(v,w){return v[3]?1:0}return i=h(o),r=g[i]=m[i](o),a=new Icons({props:{icon:"x"}}),{c(){t=element("dialog"),e=element("div"),r.c(),s=space(),c=element("button"),create_component(a.$$.fragment),u=text(`
            abort`),attr(c,"class","btn btn-error w-full mt-5"),attr(e,"class","modal-box"),attr(t,"class","modal")},m(v,w){insert(v,t,w),append(t,e),g[i].m(e,null),append(e,s),append(e,c),mount_component(a,c,null),append(c,u),o[10](t),f=!0,p||(d=listen(c,"click",o[7]),p=!0)},p(v,[w]){let k=i;i=h(v),i===k?g[i].p(v,w):(group_outros(),transition_out(g[k],1,1,()=>{g[k]=null}),check_outros(),r=g[i],r?r.p(v,w):(r=g[i]=m[i](v),r.c()),transition_in(r,1),r.m(e,s))},i(v){f||(transition_in(r),transition_in(a.$$.fragment,v),f=!0)},o(v){transition_out(r),transition_out(a.$$.fragment,v),f=!1},d(v){v&&detach(t),g[i].d(),destroy_component(a),o[10](null),p=!1,d()}}}function instance$r(o,t,e){let i;const r=stores.notify;component_subscribe(o,r,w=>e(5,i=w));let s,c,a,u=!1;var f;const p=w=>{m(),f.showModal(),d(w)};async function d(w){if(e(3,u=!1),console.log(w),w.type=="file"||w.type=="folder"||w.type=="share")e(1,c=w.name);else if(e(1,c=w.files.length+" files from "),w!=null&&w.basedirs){let $=await request("user");if(!$.ok)return;let T=await $.json().then(P=>P.name);e(1,c+="basedirs of "+T),w.name="basedirs of "+T}else e(1,c+=w.name),w.name=w.name+"_selection";let k=await request("download/options","post",w);if(!k.ok){console.log(k.status);return}e(0,s=await k.json()),e(3,u=!0)}function m(){e(0,s=[]),e(1,c=""),e(2,a=""),e(3,u=!1)}function g(){f.close()}const h=()=>{g(),set_store_value(r,i={action:"download",kind:"start"},i)};function v(w){binding_callbacks[w?"unshift":"push"](()=>{f=w,e(4,f)})}return[s,c,a,u,f,i,r,g,p,h,v]}class Download extends SvelteComponent{constructor(t){super(),init(this,t,instance$r,create_fragment$q,safe_not_equal,{open:8})}get open(){return this.$$.ctx[8]}}const{window:window_1}=globals;function create_if_block_5$8(o){let t,e,i,r,s,c;function a(f){o[26](f)}let u={iconon:"minimize",iconoff:"maximize",disabled:!0};return o[4]!==void 0&&(u.bind=o[4]),e=new SwapLogo({props:u}),binding_callbacks.push(()=>bind(e,"bind",a)),{c(){t=element("button"),create_component(e.$$.fragment),attr(t,"class","btn btn-ghost btn-circle px-2")},m(f,p){insert(f,t,p),mount_component(e,t,null),r=!0,s||(c=listen(t,"click",o[22]),s=!0)},p(f,p){const d={};!i&&p[0]&16&&(i=!0,d.bind=f[4],add_flush_callback(()=>i=!1)),e.$set(d)},i(f){r||(transition_in(e.$$.fragment,f),r=!0)},o(f){transition_out(e.$$.fragment,f),r=!1},d(f){f&&detach(t),destroy_component(e),s=!1,c()}}}function create_if_block_4$8(o){let t;return{c(){t=element("span"),attr(t,"class","loading loading-spinner loading-xs")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_3$9(o){let t,e,i,r;return e=new LightboxInfo({props:{info:o[5]}}),{c(){t=element("div"),create_component(e.$$.fragment),attr(t,"class",i=`p-2 absolute top-16 h-0 left-0 right-0 mx-auto max-w-xl will-change-transform transform-gpu transition-transform ease-in-out duration-500 origin-top ${o[8]?"scale-y-100":"scale-y-0"}`)},m(s,c){insert(s,t,c),mount_component(e,t,null),r=!0},p(s,c){const a={};c[0]&32&&(a.info=s[5]),e.$set(a),(!r||c[0]&256&&i!==(i=`p-2 absolute top-16 h-0 left-0 right-0 mx-auto max-w-xl will-change-transform transform-gpu transition-transform ease-in-out duration-500 origin-top ${s[8]?"scale-y-100":"scale-y-0"}`))&&attr(t,"class",i)},i(s){r||(transition_in(e.$$.fragment,s),r=!0)},o(s){transition_out(e.$$.fragment,s),r=!1},d(s){s&&detach(t),destroy_component(e)}}}function create_if_block$k(o){let t,e,i;function r(a,u){if(a[5].type=="video")return create_if_block_1$f;if(a[5].type=="image")return create_if_block_2$c}let s=r(o),c=s&&s(o);return{c(){t=element("div"),c&&c.c(),attr(t,"class","absolute flex justify-center items-center w-screen h-screen top-0 left-0 -z-10 overflow-hidden")},m(a,u){insert(a,t,u),c&&c.m(t,null),e||(i=[action_destroyer(swipe.call(null,t,{timeframe:300,minSwipeDistance:100})),listen(t,"swipe",o[18]),listen(t,"mousedown",o[19]),listen(t,"mouseup",o[20])],e=!0)},p(a,u){s===(s=r(a))&&c?c.p(a,u):(c&&c.d(1),c=s&&s(a),c&&(c.c(),c.m(t,null)))},d(a){a&&detach(t),c&&c.d(),e=!1,run_all(i)}}}function create_if_block_2$c(o){let t,e;return{c(){var i;t=element("img"),attr(t,"id","image"),attr(t,"draggable","false"),attr(t,"class","w-full h-full object-contain"),src_url_equal(t.src,e=(i=o[5])==null?void 0:i.url)||attr(t,"src",e)},m(i,r){insert(i,t,r),o[29](t)},p(i,r){var s;r[0]&32&&!src_url_equal(t.src,e=(s=i[5])==null?void 0:s.url)&&attr(t,"src",e)},d(i){i&&detach(t),o[29](null)}}}function create_if_block_1$f(o){let t,e,i;return{c(){t=element("video"),e=element("source"),src_url_equal(e.src,i=o[5].url)||attr(e,"src",i),attr(e,"type","video/mp4"),t.controls=!0,t.autoplay=!0},m(r,s){insert(r,t,s),append(t,e)},p(r,s){s[0]&32&&!src_url_equal(e.src,i=r[5].url)&&attr(e,"src",i)},d(r){r&&detach(t)}}}function create_fragment$p(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v,w,k,$,T,P,E,x,S,M,O,q,F,A,Z,I,D,X,N,W=o[27]()+"",R,U,z,C=o[1].findIndex(o[28])+1+" / "+o[1].length,j,V,H,G,ee,re,ae,oe,le,fe,me;a=new Icons({props:{icon:"x"}}),d=new Icons({props:{icon:"info"}}),h=new Icons({props:{icon:"download"}});function de(ie){o[25](ie)}let ue={iconon:"pause",iconoff:"play",disabled:!1};o[3]!==void 0&&(ue.bind=o[3]),$=new SwapLogo({props:ue}),binding_callbacks.push(()=>bind($,"bind",de));let te=!o[9]&&create_if_block_5$8(o);M=new Icons({props:{icon:"arrow_right",size:"7"}}),A=new Icons({props:{icon:"arrow_left",size:"7"}});let J=o[7]%2==0&&create_if_block_4$8(),Q=o[5]!=null&&create_if_block_3$9(o),he=o[0]&&create_if_block$k(o);function _e(ie){o[30](ie)}let ne={};return o[10]!==void 0&&(ne.open=o[10]),ae=new Download({props:ne}),binding_callbacks.push(()=>bind(ae,"open",_e)),{c(){t=element("div"),e=element("div"),r=space(),s=element("div"),c=element("button"),create_component(a.$$.fragment),u=space(),f=element("div"),p=element("button"),create_component(d.$$.fragment),m=space(),g=element("button"),create_component(h.$$.fragment),v=space(),w=element("div"),k=element("button"),create_component($.$$.fragment),P=space(),te&&te.c(),x=space(),S=element("button"),create_component(M.$$.fragment),q=space(),F=element("button"),create_component(A.$$.fragment),I=space(),D=element("div"),X=element("div"),J&&J.c(),N=space(),R=text(W),U=space(),z=element("div"),j=text(C),V=space(),Q&&Q.c(),G=space(),he&&he.c(),re=space(),create_component(ae.$$.fragment),attr(e,"class",i=`transition-opacity -z-10 ease-in-out duration-500 absolute w-full h-full bg-black ${o[2]?"opacity-0":"opacity-100"}`),attr(c,"class","btn btn-ghost btn-circle px-2 ml-2"),attr(p,"class","btn btn-ghost btn-circle px-2"),attr(g,"class","btn btn-ghost btn-circle px-2"),attr(f,"class","flex items-center"),attr(k,"class","btn btn-ghost btn-circle px-2"),attr(s,"class",E=`absolute -top-px w-full z-31 bg-base-100 opacity-95 flex justify-between items-center overflow-hidden transition-all transform-gpu will-change-transform h-16 duration-500 ${o[2]?" translate-y-0":" -translate-y-16"}`),attr(S,"class",O=`rounded-full w-14 h-14 bg-base-200 opacity-50 absolute right-2 top-1/2 -translate-y-1/2 flex items-center justify-center transition-transform ease-in-out duration-500 active:scale-110 will-change-transform transform-gpu ${o[2]?"translate-x-0":"translate-x-24"}`),attr(F,"class",Z=`rounded-full w-14 h-14 bg-base-200 opacity-50 absolute left-2 top-1/2 -translate-y-1/2 flex items-center justify-center transition-transform ease-in-out duration-500 active:scale-110 will-change-transform transform-gpu ${o[2]?"translate-x-0":"-translate-x-24"}`),attr(X,"class","bg-base-200 opacity-50 p-2 rounded absolute left-4 top-20"),attr(z,"class","bg-base-200 opacity-50 p-2 rounded absolute right-4 top-20"),attr(D,"class",H="transition-all ease-in-out duration-500 "+(o[2]?" opacity-100":" opacity-0")),attr(t,"class",ee=`touch-none fixed h-screen w-screen z-30 overflow-hidden left-0 top-0 transition-all duration-500 ease-in-out transform-gpu will-change-transform ${o[0]?" translate-y-0":" translate-y-full"} bg-base-100`)},m(ie,ye){insert(ie,t,ye),append(t,e),append(t,r),append(t,s),append(s,c),mount_component(a,c,null),append(s,u),append(s,f),append(f,p),mount_component(d,p,null),append(f,m),append(f,g),mount_component(h,g,null),append(s,v),append(s,w),append(w,k),mount_component($,k,null),append(w,P),te&&te.m(w,null),append(t,x),append(t,S),mount_component(M,S,null),append(t,q),append(t,F),mount_component(A,F,null),append(t,I),append(t,D),append(D,X),J&&J.m(X,null),append(X,N),append(X,R),append(D,U),append(D,z),append(z,j),append(D,V),Q&&Q.m(D,null),append(t,G),he&&he.m(t,null),insert(ie,re,ye),mount_component(ae,ie,ye),le=!0,fe||(me=[listen(window_1,"keydown",o[21]),listen(c,"click",o[15]),listen(p,"click",o[14]),listen(g,"click",o[24]),listen(S,"click",o[17]),listen(F,"click",o[16])],fe=!0)},p(ie,ye){(!le||ye[0]&4&&i!==(i=`transition-opacity -z-10 ease-in-out duration-500 absolute w-full h-full bg-black ${ie[2]?"opacity-0":"opacity-100"}`))&&attr(e,"class",i);const Oe={};!T&&ye[0]&8&&(T=!0,Oe.bind=ie[3],add_flush_callback(()=>T=!1)),$.$set(Oe),ie[9]?te&&(group_outros(),transition_out(te,1,1,()=>{te=null}),check_outros()):te?(te.p(ie,ye),ye[0]&512&&transition_in(te,1)):(te=create_if_block_5$8(ie),te.c(),transition_in(te,1),te.m(w,null)),(!le||ye[0]&4&&E!==(E=`absolute -top-px w-full z-31 bg-base-100 opacity-95 flex justify-between items-center overflow-hidden transition-all transform-gpu will-change-transform h-16 duration-500 ${ie[2]?" translate-y-0":" -translate-y-16"}`))&&attr(s,"class",E),(!le||ye[0]&4&&O!==(O=`rounded-full w-14 h-14 bg-base-200 opacity-50 absolute right-2 top-1/2 -translate-y-1/2 flex items-center justify-center transition-transform ease-in-out duration-500 active:scale-110 will-change-transform transform-gpu ${ie[2]?"translate-x-0":"translate-x-24"}`))&&attr(S,"class",O),(!le||ye[0]&4&&Z!==(Z=`rounded-full w-14 h-14 bg-base-200 opacity-50 absolute left-2 top-1/2 -translate-y-1/2 flex items-center justify-center transition-transform ease-in-out duration-500 active:scale-110 will-change-transform transform-gpu ${ie[2]?"translate-x-0":"-translate-x-24"}`))&&attr(F,"class",Z),ie[7]%2==0?J||(J=create_if_block_4$8(),J.c(),J.m(X,N)):J&&(J.d(1),J=null),(!le||ye[0]&128)&&W!==(W=ie[27]()+"")&&set_data(R,W),(!le||ye[0]&34)&&C!==(C=ie[1].findIndex(ie[28])+1+" / "+ie[1].length)&&set_data(j,C),ie[5]!=null?Q?(Q.p(ie,ye),ye[0]&32&&transition_in(Q,1)):(Q=create_if_block_3$9(ie),Q.c(),transition_in(Q,1),Q.m(D,null)):Q&&(group_outros(),transition_out(Q,1,1,()=>{Q=null}),check_outros()),(!le||ye[0]&4&&H!==(H="transition-all ease-in-out duration-500 "+(ie[2]?" opacity-100":" opacity-0")))&&attr(D,"class",H),ie[0]?he?he.p(ie,ye):(he=create_if_block$k(ie),he.c(),he.m(t,null)):he&&(he.d(1),he=null),(!le||ye[0]&1&&ee!==(ee=`touch-none fixed h-screen w-screen z-30 overflow-hidden left-0 top-0 transition-all duration-500 ease-in-out transform-gpu will-change-transform ${ie[0]?" translate-y-0":" translate-y-full"} bg-base-100`))&&attr(t,"class",ee);const Le={};!oe&&ye[0]&1024&&(oe=!0,Le.open=ie[10],add_flush_callback(()=>oe=!1)),ae.$set(Le)},i(ie){le||(transition_in(a.$$.fragment,ie),transition_in(d.$$.fragment,ie),transition_in(h.$$.fragment,ie),transition_in($.$$.fragment,ie),transition_in(te),transition_in(M.$$.fragment,ie),transition_in(A.$$.fragment,ie),transition_in(Q),transition_in(ae.$$.fragment,ie),le=!0)},o(ie){transition_out(a.$$.fragment,ie),transition_out(d.$$.fragment,ie),transition_out(h.$$.fragment,ie),transition_out($.$$.fragment,ie),transition_out(te),transition_out(M.$$.fragment,ie),transition_out(A.$$.fragment,ie),transition_out(Q),transition_out(ae.$$.fragment,ie),le=!1},d(ie){ie&&detach(t),destroy_component(a),destroy_component(d),destroy_component(h),destroy_component($),te&&te.d(),destroy_component(M),destroy_component(A),J&&J.d(),Q&&Q.d(),he&&he.d(),ie&&detach(re),destroy_component(ae,ie),fe=!1,run_all(me)}}}function instance$q(o,t,e){let i,r,s,{active:c}=t,{files:a}=t;var u;const f=Q=>{e(5,u=a.find(he=>he.id==Q)),e(0,c=!0),D()};var p=null,d={x:null,y:null},m,g;function h(){if(m){if(g){g.reset();return}g=new PanZ({minZoom:1,bounds:Number.MIN_VALUE,maxZoom:6},m),g.disablePan(),g.on("update",Q=>{c&&(Q.scale>1.1?($<4&&A(),g.panEnabled||g.enablePan()):g.panEnabled&&g.disablePan())})}}const v=stores.cache.small;component_subscribe(o,v,Q=>e(37,s=Q));const w=stores.cache.medium;component_subscribe(o,w,Q=>e(36,r=Q));const k=stores.cache.large;component_subscribe(o,k,Q=>e(35,i=Q));var $=-1,T=!0,P=!1,E=!1,x,S,M=!1;function O(){e(9,S=/Android|iPhone/i.test(navigator.userAgent)),e(4,M=window.innerHeight===screen.height)}async function q(){e(7,$=0),s.map(Q=>Q.id).includes(u.id)?e(5,u.url=s.find(Q=>Q.id==u.id).url,u):(e(7,$=1),e(5,u.url=await bloburl(u.id,240),u),set_store_value(v,s=[...s,{id:u.id,url:u.url}],s)),e(7,$=1)}async function F(){e(7,$=2),r.map(Q=>Q.id).includes(u.id)?e(5,u.url=r.find(Q=>Q.id==u.id).url,u):(e(5,u.url=await bloburl(u.id,1080),u),set_store_value(w,r=[...r,{id:u.id,url:u.url}],r)),e(7,$=3)}async function A(){console.log("getting full res"),e(7,$=4),i.map(Q=>Q.id).includes(u.id)?e(5,u.url=i.find(Q=>Q.id==u.id).url,u):(e(5,u.url=await bloburl(u.id),u),set_store_value(k,i=[...i,{id:u.id,url:u.url}],i)),e(7,$=5)}function Z(){e(2,T=!T)}function I(){P?(e(8,P=!1),g&&g.enableZoom()):(e(8,P=!0),g&&g.disableZoom())}async function D(){e(7,$=-1),u.type=="image"?(await q(),M?A():F(),h()):u.type=="video"&&(e(3,E=!1),e(5,u.url="/api/file/stream/"+u.id,u),e(7,$=7))}function X(){g&&(g.destroy(),g=void 0),e(0,c=!1)}function N(){let Q=a.findIndex(_e=>_e.id==u.id),he=a.length;Q==0?Q=he-1:Q=Q-1,e(5,u=a[Q]),D()}function W(){let Q=a.findIndex(_e=>_e.id==u.id),he=a.length;Q>=he-1?Q=0:Q=Q+1,e(5,u=a[Q]),D()}function R(Q){if(g&&g.scale>1.1)return!1;switch(Q.detail.direction){case"right":N();break;case"left":W();break;case"bottom":X()}}function U(){p==null?p=setTimeout(()=>{Z(),p=null},200):(g&&(g.disableZoom(),g.scale<1.8?g.zoomTo(2):g.zoomTo(1),g.enableZoom()),clearTimeout(p),p=null)}function z(Q){d={x:Q.clientX,y:Q.clientY}}function C(Q){Math.abs(d.x-Q.clientX)<20&&Math.abs(d.y-Q.clientY)<20&&U()}function j(Q){if(c)switch(Q.preventDefault(),Q.keyCode){case 37:N();break;case 39:W();break;case 27:X()}}function V(){E?x=setTimeout(()=>{W(),V()},3e3):(clearTimeout(x),x=null)}function H(){e(4,M=window.innerHeight===screen.height),M?ee():G()}function G(){let Q=document.documentElement;Q.requestFullscreen?Q.requestFullscreen():Q.webkitRequestFullscreen?Q.webkitRequestFullscreen():Q.msRequestFullscreen&&Q.msRequestFullscreen(),e(4,M=!0)}function ee(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),e(4,M=!1)}function re(){c?(document.documentElement.style.overflow="hidden",document.body.scroll="no"):(document.documentElement.style.overflow="auto",document.body.scroll="yes")}function ae(){let Q=document.querySelector("meta[name=theme-color]");T?Q.setAttribute("content","data-theme"):Q.setAttribute("content","black")}var oe;O();const le=()=>oe({file:u.id,type:"file",name:u.name});function fe(Q){E=Q,e(3,E)}function me(Q){M=Q,e(4,M)}const de=()=>{switch($){case 0:return"loading thumbnail...";case 1:return"thumbnail";case 2:return"loading preview...";case 3:return"preview";case 4:return"loading full resolution...";case 5:return"full resolution";case 7:return"video"}},ue=Q=>(Q==null?void 0:Q.id)==(u==null?void 0:u.id);function te(Q){binding_callbacks[Q?"unshift":"push"](()=>{m=Q,e(6,m)})}function J(Q){oe=Q,e(10,oe)}return o.$$set=Q=>{"active"in Q&&e(0,c=Q.active),"files"in Q&&e(1,a=Q.files)},o.$$.update=()=>{o.$$.dirty[0]&4&&ae(),o.$$.dirty[0]&8&&V(),o.$$.dirty[0]&17&&(re(),!c&&M&&H())},[c,a,T,E,M,u,m,$,P,S,oe,v,w,k,I,X,N,W,R,z,C,j,H,f,le,fe,me,de,ue,te,J]}class Lightbox extends SvelteComponent{constructor(t){super(),init(this,t,instance$q,create_fragment$p,safe_not_equal,{active:0,files:1,open:23},null,[-1,-1])}get open(){return this.$$.ctx[23]}}var WorkerHandler$1={exports:{}};function Promise$2(o,t){var e=this;if(!(this instanceof Promise$2))throw new SyntaxError("Constructor must be called with the new operator");if(typeof o!="function")throw new SyntaxError("Function parameter handler(resolve, reject) missing");var i=[],r=[];this.resolved=!1,this.rejected=!1,this.pending=!0;var s=function(u,f){i.push(u),r.push(f)};this.then=function(u,f){return new Promise$2(function(p,d){var m=u?_then(u,p,d):p,g=f?_then(f,p,d):d;s(m,g)},e)};var c=function(u){return e.resolved=!0,e.rejected=!1,e.pending=!1,i.forEach(function(f){f(u)}),s=function(f,p){f(u)},c=a=function(){},e},a=function(u){return e.resolved=!1,e.rejected=!0,e.pending=!1,r.forEach(function(f){f(u)}),s=function(f,p){p(u)},c=a=function(){},e};this.cancel=function(){return t?t.cancel():a(new CancellationError),e},this.timeout=function(u){if(t)t.timeout(u);else{var f=setTimeout(function(){a(new TimeoutError("Promise timed out after "+u+" ms"))},u);e.always(function(){clearTimeout(f)})}return e},o(function(u){c(u)},function(u){a(u)})}function _then(o,t,e){return function(i){try{var r=o(i);r&&typeof r.then=="function"&&typeof r.catch=="function"?r.then(t,e):t(r)}catch(s){e(s)}}}Promise$2.prototype.catch=function(o){return this.then(null,o)};Promise$2.prototype.always=function(o){return this.then(o,o)};Promise$2.all=function(o){return new Promise$2(function(t,e){var i=o.length,r=[];i?o.forEach(function(s,c){s.then(function(a){r[c]=a,i--,i==0&&t(r)},function(a){i=0,e(a)})}):t(r)})};Promise$2.defer=function(){var o={};return o.promise=new Promise$2(function(t,e){o.resolve=t,o.reject=e}),o};function CancellationError(o){this.message=o||"promise cancelled",this.stack=new Error().stack}CancellationError.prototype=new Error;CancellationError.prototype.constructor=Error;CancellationError.prototype.name="CancellationError";Promise$2.CancellationError=CancellationError;function TimeoutError(o){this.message=o||"timeout exceeded",this.stack=new Error().stack}TimeoutError.prototype=new Error;TimeoutError.prototype.constructor=Error;TimeoutError.prototype.name="TimeoutError";Promise$2.TimeoutError=TimeoutError;var _Promise=Promise$2,environment$1={exports:{}},requireFoolWebpack$1=eval(`typeof require !== 'undefined' ? require : function (module) { throw new Error('Module " + module + " not found.') }`),requireFoolWebpack_1=requireFoolWebpack$1;(function(o){var t=requireFoolWebpack_1,e=function(s){return typeof s<"u"&&s.versions!=null&&s.versions.node!=null};o.exports.isNode=e,o.exports.platform=typeof process<"u"&&e(process)?"node":"browser";var i=r("worker_threads");o.exports.isMainThread=o.exports.platform==="node"?(!i||i.isMainThread)&&!process.connected:typeof Window<"u",o.exports.cpus=o.exports.platform==="browser"?self.navigator.hardwareConcurrency:t("os").cpus().length;function r(s){try{return t(s)}catch{return null}}})(environment$1);var environmentExports=environment$1.exports,embeddedWorker,hasRequiredEmbeddedWorker;function requireEmbeddedWorker(){return hasRequiredEmbeddedWorker||(hasRequiredEmbeddedWorker=1,embeddedWorker=`!function(){var __webpack_modules__={577:function(e){e.exports=function(e,r){this.message=e,this.transfer=r}}},__webpack_module_cache__={};function __webpack_require__(e){var r=__webpack_module_cache__[e];return void 0!==r||(r=__webpack_module_cache__[e]={exports:{}},__webpack_modules__[e](r,r.exports,__webpack_require__)),r.exports}var __webpack_exports__={};!function(){var exports=__webpack_exports__,__webpack_unused_export__;function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Transfer=__webpack_require__(577),requireFoolWebpack=eval("typeof require !== 'undefined' ? require : function (module) { throw new Error('Module \\" + module + \\" not found.') }"),TERMINATE_METHOD_ID="__workerpool-terminate__",worker={exit:function(){}},WorkerThreads,parentPort;if("undefined"!=typeof self&&"function"==typeof postMessage&&"function"==typeof addEventListener)worker.on=function(e,r){addEventListener(e,function(e){r(e.data)})},worker.send=function(e){postMessage(e)};else{if("undefined"==typeof process)throw new Error("Script must be executed as a worker");try{WorkerThreads=requireFoolWebpack("worker_threads")}catch(error){if("object"!==_typeof(error)||null===error||"MODULE_NOT_FOUND"!==error.code)throw error}WorkerThreads&&null!==WorkerThreads.parentPort?(parentPort=WorkerThreads.parentPort,worker.send=parentPort.postMessage.bind(parentPort),worker.on=parentPort.on.bind(parentPort)):(worker.on=process.on.bind(process),worker.send=function(e){process.send(e)},worker.on("disconnect",function(){process.exit(1)})),worker.exit=process.exit.bind(process)}function convertError(o){return Object.getOwnPropertyNames(o).reduce(function(e,r){return Object.defineProperty(e,r,{value:o[r],enumerable:!0})},{})}function isPromise(e){return e&&"function"==typeof e.then&&"function"==typeof e.catch}worker.methods={},worker.methods.run=function(e,r){e=new Function("return ("+e+").apply(null, arguments);");return e.apply(e,r)},worker.methods.methods=function(){return Object.keys(worker.methods)},worker.terminationHandler=void 0,worker.cleanupAndExit=function(e){function r(){worker.exit(e)}if(!worker.terminationHandler)return r();var o=worker.terminationHandler(e);isPromise(o)?o.then(r,r):r()};var currentRequestId=null;worker.on("message",function(r){if(r===TERMINATE_METHOD_ID)return worker.cleanupAndExit(0);try{var e=worker.methods[r.method];if(!e)throw new Error('Unknown method "'+r.method+'"');currentRequestId=r.id;var o=e.apply(e,r.params);isPromise(o)?o.then(function(e){e instanceof Transfer?worker.send({id:r.id,result:e.message,error:null},e.transfer):worker.send({id:r.id,result:e,error:null}),currentRequestId=null}).catch(function(e){worker.send({id:r.id,result:null,error:convertError(e)}),currentRequestId=null}):(o instanceof Transfer?worker.send({id:r.id,result:o.message,error:null},o.transfer):worker.send({id:r.id,result:o,error:null}),currentRequestId=null)}catch(e){worker.send({id:r.id,result:null,error:convertError(e)})}}),worker.register=function(e,r){if(e)for(var o in e)e.hasOwnProperty(o)&&(worker.methods[o]=e[o]);r&&(worker.terminationHandler=r.onTerminate),worker.send("ready")},worker.emit=function(e){currentRequestId&&(e instanceof Transfer?worker.send({id:currentRequestId,isEvent:!0,payload:e.message},e.transfer):worker.send({id:currentRequestId,isEvent:!0,payload:e}))},__webpack_unused_export__=worker.register,worker.emit}()}();`),embeddedWorker}var Promise$1=_Promise,environment=environmentExports,requireFoolWebpack=requireFoolWebpack_1,TERMINATE_METHOD_ID="__workerpool-terminate__";function ensureWorkerThreads(){var o=tryRequireWorkerThreads();if(!o)throw new Error("WorkerPool: workerType = 'thread' is not supported, Node >= 11.7.0 required");return o}function ensureWebWorker(){if(typeof Worker!="function"&&(typeof Worker!="object"||typeof Worker.prototype.constructor!="function"))throw new Error("WorkerPool: Web Workers not supported")}function tryRequireWorkerThreads(){try{return requireFoolWebpack("worker_threads")}catch(o){if(typeof o=="object"&&o!==null&&o.code==="MODULE_NOT_FOUND")return null;throw o}}function getDefaultWorker(){if(environment.platform==="browser"){if(typeof Blob>"u")throw new Error("Blob not supported by the browser");if(!window.URL||typeof window.URL.createObjectURL!="function")throw new Error("URL.createObjectURL not supported by the browser");var o=new Blob([requireEmbeddedWorker()],{type:"text/javascript"});return window.URL.createObjectURL(o)}else return __dirname+"/worker.js"}function setupWorker(o,t){if(t.workerType==="web")return ensureWebWorker(),setupBrowserWorker(o,Worker);if(t.workerType==="thread")return e=ensureWorkerThreads(),setupWorkerThreadWorker(o,e,t.workerThreadOpts);if(t.workerType==="process"||!t.workerType)return setupProcessWorker(o,resolveForkOptions(t),requireFoolWebpack("child_process"));if(environment.platform==="browser")return ensureWebWorker(),setupBrowserWorker(o,Worker);var e=tryRequireWorkerThreads();return e?setupWorkerThreadWorker(o,e):setupProcessWorker(o,resolveForkOptions(t),requireFoolWebpack("child_process"))}function setupBrowserWorker(o,t){var e=new t(o);return e.isBrowserWorker=!0,e.on=function(i,r){this.addEventListener(i,function(s){r(s.data)})},e.send=function(i,r){this.postMessage(i,r)},e}function setupWorkerThreadWorker(o,t,e){var i=new t.Worker(o,{stdout:!1,stderr:!1,...e});return i.isWorkerThread=!0,i.send=function(r,s){this.postMessage(r,s)},i.kill=function(){return this.terminate(),!0},i.disconnect=function(){this.terminate()},i}function setupProcessWorker(o,t,e){var i=e.fork(o,t.forkArgs,t.forkOpts),r=i.send;return i.send=function(s){return r.call(i,s)},i.isChildProcess=!0,i}function resolveForkOptions(o){o=o||{};var t=process.execArgv.join(" "),e=t.indexOf("--inspect")!==-1,i=t.indexOf("--debug-brk")!==-1,r=[];return e&&(r.push("--inspect="+o.debugPort),i&&r.push("--debug-brk")),process.execArgv.forEach(function(s){s.indexOf("--max-old-space-size")>-1&&r.push(s)}),Object.assign({},o,{forkArgs:o.forkArgs,forkOpts:Object.assign({},o.forkOpts,{execArgv:(o.forkOpts&&o.forkOpts.execArgv||[]).concat(r)})})}function objectToError(o){for(var t=new Error(""),e=Object.keys(o),i=0;i<e.length;i++)t[e[i]]=o[e[i]];return t}function WorkerHandler(o,t){var e=this,i=t||{};this.script=o||getDefaultWorker(),this.worker=setupWorker(this.script,i),this.debugPort=i.debugPort,this.forkOpts=i.forkOpts,this.forkArgs=i.forkArgs,this.workerThreadOpts=i.workerThreadOpts,this.workerTerminateTimeout=i.workerTerminateTimeout,o||(this.worker.ready=!0),this.requestQueue=[],this.worker.on("message",function(a){if(!e.terminated)if(typeof a=="string"&&a==="ready")e.worker.ready=!0,s();else{var u=a.id,f=e.processing[u];f!==void 0&&(a.isEvent?f.options&&typeof f.options.on=="function"&&f.options.on(a.payload):(delete e.processing[u],e.terminating===!0&&e.terminate(),a.error?f.resolver.reject(objectToError(a.error)):f.resolver.resolve(a.result)))}});function r(a){e.terminated=!0;for(var u in e.processing)e.processing[u]!==void 0&&e.processing[u].resolver.reject(a);e.processing=Object.create(null)}function s(){for(const a of e.requestQueue.splice(0))e.worker.send(a.message,a.transfer)}var c=this.worker;this.worker.on("error",r),this.worker.on("exit",function(a,u){var f=`Workerpool Worker terminated Unexpectedly
`;f+="    exitCode: `"+a+"`\n",f+="    signalCode: `"+u+"`\n",f+="    workerpool.script: `"+e.script+"`\n",f+="    spawnArgs: `"+c.spawnargs+"`\n",f+="    spawnfile: `"+c.spawnfile+"`\n",f+="    stdout: `"+c.stdout+"`\n",f+="    stderr: `"+c.stderr+"`\n",r(new Error(f))}),this.processing=Object.create(null),this.terminating=!1,this.terminated=!1,this.cleaning=!1,this.terminationHandler=null,this.lastId=0}WorkerHandler.prototype.methods=function(){return this.exec("methods")};WorkerHandler.prototype.exec=function(o,t,e,i){e||(e=Promise$1.defer());var r=++this.lastId;this.processing[r]={id:r,resolver:e,options:i};var s={message:{id:r,method:o,params:t},transfer:i&&i.transfer};this.terminated?e.reject(new Error("Worker is terminated")):this.worker.ready?this.worker.send(s.message,s.transfer):this.requestQueue.push(s);var c=this;return e.promise.catch(function(a){if(a instanceof Promise$1.CancellationError||a instanceof Promise$1.TimeoutError)return delete c.processing[r],c.terminateAndNotify(!0).then(function(){throw a},function(u){throw u});throw a})};WorkerHandler.prototype.busy=function(){return this.cleaning||Object.keys(this.processing).length>0};WorkerHandler.prototype.terminate=function(o,t){var e=this;if(o){for(var i in this.processing)this.processing[i]!==void 0&&this.processing[i].resolver.reject(new Error("Worker terminated"));this.processing=Object.create(null)}if(typeof t=="function"&&(this.terminationHandler=t),this.busy())this.terminating=!0;else{var r=function(c){if(e.terminated=!0,e.cleaning=!1,e.worker!=null&&e.worker.removeAllListeners&&e.worker.removeAllListeners("message"),e.worker=null,e.terminating=!1,e.terminationHandler)e.terminationHandler(c,e);else if(c)throw c};if(this.worker)if(typeof this.worker.kill=="function"){if(this.worker.killed){r(new Error("worker already killed!"));return}var s=setTimeout(function(){e.worker&&e.worker.kill()},this.workerTerminateTimeout);this.worker.once("exit",function(){clearTimeout(s),e.worker&&(e.worker.killed=!0),r()}),this.worker.ready?this.worker.send(TERMINATE_METHOD_ID):this.requestQueue.push({message:TERMINATE_METHOD_ID}),this.cleaning=!0;return}else if(typeof this.worker.terminate=="function")this.worker.terminate(),this.worker.killed=!0;else throw new Error("Failed to terminate worker");r()}};WorkerHandler.prototype.terminateAndNotify=function(o,t){var e=Promise$1.defer();return t&&e.promise.timeout(t),this.terminate(o,function(i,r){i?e.reject(i):e.resolve(r)}),e.promise};WorkerHandler$1.exports=WorkerHandler;WorkerHandler$1.exports._tryRequireWorkerThreads=tryRequireWorkerThreads;WorkerHandler$1.exports._setupProcessWorker=setupProcessWorker;WorkerHandler$1.exports._setupBrowserWorker=setupBrowserWorker;WorkerHandler$1.exports._setupWorkerThreadWorker=setupWorkerThreadWorker;WorkerHandler$1.exports.ensureWorkerThreads=ensureWorkerThreads;function get_each_context_1$4(o,t,e){const i=o.slice();return i[20]=t[e],i[23]=t,i[24]=e,i}function get_each_context$9(o,t,e){const i=o.slice();return i[20]=t[e],i}function create_if_block$j(o){let t,e=o[0].length+"",i,r,s,c,a,u,f,p,d,m,g,h=o[0].length>1&&create_if_block_6$4();const v=[create_if_block_1$e,create_if_block_2$b],w=[];function k(x,S){return x[1]=="grid"?0:x[1]=="list"?1:-1}~(c=k(o))&&(a=w[c]=v[c](o));function $(x){o[16](x)}function T(x){o[17](x)}function P(x){o[18](x)}let E={};return o[3]!==void 0&&(E.active=o[3]),o[0]!==void 0&&(E.files=o[0]),o[2]!==void 0&&(E.open=o[2]),f=new Lightbox({props:E}),binding_callbacks.push(()=>bind(f,"active",$)),binding_callbacks.push(()=>bind(f,"files",T)),binding_callbacks.push(()=>bind(f,"open",P)),{c(){t=element("div"),i=text(e),r=text(" FILE"),h&&h.c(),s=space(),a&&a.c(),u=space(),create_component(f.$$.fragment),attr(t,"class","divider mx-2")},m(x,S){insert(x,t,S),append(t,i),append(t,r),h&&h.m(t,null),insert(x,s,S),~c&&w[c].m(x,S),insert(x,u,S),mount_component(f,x,S),g=!0},p(x,S){(!g||S&1)&&e!==(e=x[0].length+"")&&set_data(i,e),x[0].length>1?h||(h=create_if_block_6$4(),h.c(),h.m(t,null)):h&&(h.d(1),h=null);let M=c;c=k(x),c===M?~c&&w[c].p(x,S):(a&&(group_outros(),transition_out(w[M],1,1,()=>{w[M]=null}),check_outros()),~c?(a=w[c],a?a.p(x,S):(a=w[c]=v[c](x),a.c()),transition_in(a,1),a.m(u.parentNode,u)):a=null);const O={};!p&&S&8&&(p=!0,O.active=x[3],add_flush_callback(()=>p=!1)),!d&&S&1&&(d=!0,O.files=x[0],add_flush_callback(()=>d=!1)),!m&&S&4&&(m=!0,O.open=x[2],add_flush_callback(()=>m=!1)),f.$set(O)},i(x){g||(transition_in(a),transition_in(f.$$.fragment,x),g=!0)},o(x){transition_out(a),transition_out(f.$$.fragment,x),g=!1},d(x){x&&detach(t),h&&h.d(),x&&detach(s),~c&&w[c].d(x),x&&detach(u),destroy_component(f,x)}}}function create_if_block_6$4(o){let t;return{c(){t=text("S")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_2$b(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v,w,k,$,T=[],P=new Map,E,x,S,M=o[4]=="name"&&create_if_block_5$7(o),O=o[4]=="date"&&create_if_block_4$7(o),q=o[4]=="camera"&&create_if_block_3$8(o),F=o[0];const A=Z=>Z[20];for(let Z=0;Z<F.length;Z+=1){let I=get_each_context_1$4(o,F,Z),D=A(I);P.set(D,T[Z]=create_each_block_1$4(D,I))}return{c(){t=element("table"),e=element("thead"),i=element("tr"),r=element("th"),s=space(),c=element("th"),a=element("div"),u=text("name "),M&&M.c(),f=space(),p=element("th"),d=element("div"),m=text("capture date "),O&&O.c(),g=space(),h=element("th"),v=element("div"),w=text("camera "),q&&q.c(),k=space(),$=element("tbody");for(let Z=0;Z<T.length;Z+=1)T[Z].c();attr(a,"class","flex justify-start items-center"),attr(d,"class","flex justify-start items-center"),attr(p,"class","hidden sm:table-cell"),attr(v,"class","flex justify-start items-center"),attr(h,"class","hidden sm:table-cell"),attr(e,"class","shadow-sm bg-base-100"),attr(t,"class","table cursor-pointer")},m(Z,I){insert(Z,t,I),append(t,e),append(e,i),append(i,r),append(i,s),append(i,c),append(c,a),append(a,u),M&&M.m(a,null),append(i,f),append(i,p),append(p,d),append(d,m),O&&O.m(d,null),append(i,g),append(i,h),append(h,v),append(v,w),q&&q.m(v,null),append(t,k),append(t,$);for(let D=0;D<T.length;D+=1)T[D]&&T[D].m($,null);E=!0,x||(S=[listen(c,"click",o[10]),listen(p,"click",o[12]),listen(h,"click",o[14])],x=!0)},p(Z,I){Z[4]=="name"?M?(M.p(Z,I),I&16&&transition_in(M,1)):(M=create_if_block_5$7(Z),M.c(),transition_in(M,1),M.m(a,null)):M&&(group_outros(),transition_out(M,1,1,()=>{M=null}),check_outros()),Z[4]=="date"?O?(O.p(Z,I),I&16&&transition_in(O,1)):(O=create_if_block_4$7(Z),O.c(),transition_in(O,1),O.m(d,null)):O&&(group_outros(),transition_out(O,1,1,()=>{O=null}),check_outros()),Z[4]=="camera"?q?(q.p(Z,I),I&16&&transition_in(q,1)):(q=create_if_block_3$8(Z),q.c(),transition_in(q,1),q.m(v,null)):q&&(group_outros(),transition_out(q,1,1,()=>{q=null}),check_outros()),I&1&&(F=Z[0],group_outros(),T=update_keyed_each(T,I,A,1,Z,F,P,$,outro_and_destroy_block,create_each_block_1$4,null,get_each_context_1$4),check_outros())},i(Z){if(!E){transition_in(M),transition_in(O),transition_in(q);for(let I=0;I<F.length;I+=1)transition_in(T[I]);E=!0}},o(Z){transition_out(M),transition_out(O),transition_out(q);for(let I=0;I<T.length;I+=1)transition_out(T[I]);E=!1},d(Z){Z&&detach(t),M&&M.d(),O&&O.d(),q&&q.d();for(let I=0;I<T.length;I+=1)T[I].d();x=!1,run_all(S)}}}function create_if_block_1$e(o){let t,e=[],i=new Map,r,s=o[0];const c=a=>a[20];for(let a=0;a<s.length;a+=1){let u=get_each_context$9(o,s,a),f=c(u);i.set(f,e[a]=create_each_block$9(f,u))}return{c(){t=element("div");for(let a=0;a<e.length;a+=1)e[a].c();attr(t,"class","grid grid-cols-3 sm:grid-cols-5 lg:grid-cols-7 xl:grid-cols-9 2xl:grid-cols-11 mb-12 mx-1")},m(a,u){insert(a,t,u);for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(t,null);r=!0},p(a,u){u&1&&(s=a[0],group_outros(),e=update_keyed_each(e,u,c,1,a,s,i,t,outro_and_destroy_block,create_each_block$9,null,get_each_context$9),check_outros())},i(a){if(!r){for(let u=0;u<s.length;u+=1)transition_in(e[u]);r=!0}},o(a){for(let u=0;u<e.length;u+=1)transition_out(e[u]);r=!1},d(a){a&&detach(t);for(let u=0;u<e.length;u+=1)e[u].d()}}}function create_if_block_5$7(o){let t,e,i,r;function s(a){o[9](a)}let c={iconon:"arrow_up",iconoff:"arrow_down",disabled:!0};return o[5]!==void 0&&(c.bind=o[5]),e=new SwapLogo({props:c}),binding_callbacks.push(()=>bind(e,"bind",s)),{c(){t=element("span"),create_component(e.$$.fragment),attr(t,"class","ml-2")},m(a,u){insert(a,t,u),mount_component(e,t,null),r=!0},p(a,u){const f={};!i&&u&32&&(i=!0,f.bind=a[5],add_flush_callback(()=>i=!1)),e.$set(f)},i(a){r||(transition_in(e.$$.fragment,a),r=!0)},o(a){transition_out(e.$$.fragment,a),r=!1},d(a){a&&detach(t),destroy_component(e)}}}function create_if_block_4$7(o){let t,e,i,r;function s(a){o[11](a)}let c={iconon:"arrow_up",iconoff:"arrow_down",disabled:!0};return o[5]!==void 0&&(c.bind=o[5]),e=new SwapLogo({props:c}),binding_callbacks.push(()=>bind(e,"bind",s)),{c(){t=element("span"),create_component(e.$$.fragment),attr(t,"class","ml-2")},m(a,u){insert(a,t,u),mount_component(e,t,null),r=!0},p(a,u){const f={};!i&&u&32&&(i=!0,f.bind=a[5],add_flush_callback(()=>i=!1)),e.$set(f)},i(a){r||(transition_in(e.$$.fragment,a),r=!0)},o(a){transition_out(e.$$.fragment,a),r=!1},d(a){a&&detach(t),destroy_component(e)}}}function create_if_block_3$8(o){let t,e,i,r;function s(a){o[13](a)}let c={iconon:"arrow_up",iconoff:"arrow_down",disabled:!0};return o[5]!==void 0&&(c.bind=o[5]),e=new SwapLogo({props:c}),binding_callbacks.push(()=>bind(e,"bind",s)),{c(){t=element("span"),create_component(e.$$.fragment),attr(t,"class","ml-2")},m(a,u){insert(a,t,u),mount_component(e,t,null),r=!0},p(a,u){const f={};!i&&u&32&&(i=!0,f.bind=a[5],add_flush_callback(()=>i=!1)),e.$set(f)},i(a){r||(transition_in(e.$$.fragment,a),r=!0)},o(a){transition_out(e.$$.fragment,a),r=!1},d(a){a&&detach(t),destroy_component(e)}}}function create_each_block_1$4(o,t){let e,i,r,s;function c(u){t[15](u,t[20],t[23],t[24])}let a={kind:"file",view:"list",shared:!1};return t[20]!==void 0&&(a.element=t[20]),i=new Preview({props:a}),binding_callbacks.push(()=>bind(i,"element",c)),{key:o,first:null,c(){e=empty(),create_component(i.$$.fragment),this.first=e},m(u,f){insert(u,e,f),mount_component(i,u,f),s=!0},p(u,f){t=u;const p={};!r&&f&1&&(r=!0,p.element=t[20],add_flush_callback(()=>r=!1)),i.$set(p)},i(u){s||(transition_in(i.$$.fragment,u),s=!0)},o(u){transition_out(i.$$.fragment,u),s=!1},d(u){u&&detach(e),destroy_component(i,u)}}}function create_each_block$9(o,t){let e,i,r;return i=new Preview({props:{element:t[20],kind:"file",view:"grid",shared:!1}}),{key:o,first:null,c(){e=empty(),create_component(i.$$.fragment),this.first=e},m(s,c){insert(s,e,c),mount_component(i,s,c),r=!0},p(s,c){t=s;const a={};c&1&&(a.element=t[20]),i.$set(a)},i(s){r||(transition_in(i.$$.fragment,s),r=!0)},o(s){transition_out(i.$$.fragment,s),r=!1},d(s){s&&detach(e),destroy_component(i,s)}}}function create_fragment$o(o){let t,e,i=o[0].length>0&&create_if_block$j(o);return{c(){i&&i.c(),t=empty()},m(r,s){i&&i.m(r,s),insert(r,t,s),e=!0},p(r,[s]){r[0].length>0?i?(i.p(r,s),s&1&&transition_in(i,1)):(i=create_if_block$j(r),i.c(),transition_in(i,1),i.m(t.parentNode,t)):i&&(group_outros(),transition_out(i,1,1,()=>{i=null}),check_outros())},i(r){e||(transition_in(i),e=!0)},o(r){transition_out(i),e=!1},d(r){i&&i.d(r),r&&detach(t)}}}function instance$p(o,t,e){let i;const r=stores.notify;component_subscribe(o,r,x=>e(8,i=x));let{files:s}=t,{view:c}=t,a=!1,u;var f,p=!0;function d(x){x==f&&e(5,p=!p),e(4,f=x);let S=s;switch(x){case"date":S.sort((M,O)=>compare(M.datetimeoriginal,O.datetimeoriginal,p));break;case"camera":S.sort((M,O)=>compare(M.camera_manufacturer+" "+M.camera_model,O.camera_manufacturer+" "+O.camera_model,p));break;case"name":S.sort((M,O)=>compare(M.name,O.name,p));break}e(0,s=S)}function m(x){p=x,e(5,p)}const g=()=>d("name");function h(x){p=x,e(5,p)}const v=()=>d("date");function w(x){p=x,e(5,p)}const k=()=>d("camera");function $(x,S,M,O){M[O]=x,e(0,s)}function T(x){a=x,e(3,a)}function P(x){s=x,e(0,s)}function E(x){u=x,e(2,u)}return o.$$set=x=>{"files"in x&&e(0,s=x.files),"view"in x&&e(1,c=x.view)},o.$$.update=()=>{o.$$.dirty&260&&(i==null?void 0:i.kind)=="file"&&i.action=="clicked"&&(u(i.element.id),set_store_value(r,i={},i))},[s,c,u,a,f,p,r,d,i,m,g,h,v,w,k,$,T,P,E]}class FilesGallery extends SvelteComponent{constructor(t){super(),init(this,t,instance$p,create_fragment$o,safe_not_equal,{files:0,view:1})}}function get_each_context$8(o,t,e){const i=o.slice();return i[6]=t[e],i[8]=e,i}function create_if_block$i(o){let t,e,i,r,s,c,a,u,f;s=new Icons({props:{icon:"house",size:"4"}});let p=o[0],d=[];for(let g=0;g<p.length;g+=1)d[g]=create_each_block$8(get_each_context$8(o,p,g));const m=g=>transition_out(d[g],1,1,()=>{d[g]=null});return{c(){t=element("div"),e=element("ul"),i=element("li"),r=element("a"),create_component(s.$$.fragment),c=space();for(let g=0;g<d.length;g+=1)d[g].c();attr(t,"class","text-sm breadcrumbs pl-4 my-1 w-full transition-all ease-in-out h-7 md:h-12 overflow-y-hidden")},m(g,h){insert(g,t,h),append(t,e),append(e,i),append(i,r),mount_component(s,r,null),append(e,c);for(let v=0;v<d.length;v+=1)d[v]&&d[v].m(e,null);a=!0,u||(f=listen(r,"click",o[3]),u=!0)},p(g,h){if(h&5){p=g[0];let v;for(v=0;v<p.length;v+=1){const w=get_each_context$8(g,p,v);d[v]?(d[v].p(w,h),transition_in(d[v],1)):(d[v]=create_each_block$8(w),d[v].c(),transition_in(d[v],1),d[v].m(e,null))}for(group_outros(),v=p.length;v<d.length;v+=1)m(v);check_outros()}},i(g){if(!a){transition_in(s.$$.fragment,g);for(let h=0;h<p.length;h+=1)transition_in(d[h]);a=!0}},o(g){transition_out(s.$$.fragment,g),d=d.filter(Boolean);for(let h=0;h<d.length;h+=1)transition_out(d[h]);a=!1},d(g){g&&detach(t),destroy_component(s),destroy_each(d,g),u=!1,f()}}}function create_else_block$a(o){let t,e,i,r,s=o[6]+"",c,a,u;return i=new Icons({props:{icon:"folder",size:"4"}}),{c(){t=element("li"),e=element("div"),create_component(i.$$.fragment),r=space(),c=text(s),a=space(),attr(e,"class","mr-1")},m(f,p){insert(f,t,p),append(t,e),mount_component(i,e,null),append(t,r),append(t,c),append(t,a),u=!0},p(f,p){(!u||p&1)&&s!==(s=f[6]+"")&&set_data(c,s)},i(f){u||(transition_in(i.$$.fragment,f),u=!0)},o(f){transition_out(i.$$.fragment,f),u=!1},d(f){f&&detach(t),destroy_component(i)}}}function create_if_block_1$d(o){let t,e,i,r,s,c=o[6]+"",a,u,f,p,d;r=new Icons({props:{icon:"folder",size:"4"}});function m(){return o[4](o[8])}return{c(){t=element("li"),e=element("a"),i=element("div"),create_component(r.$$.fragment),s=space(),a=text(c),u=space(),attr(i,"class","mr-1")},m(g,h){insert(g,t,h),append(t,e),append(e,i),mount_component(r,i,null),append(e,s),append(e,a),append(t,u),f=!0,p||(d=listen(e,"click",m),p=!0)},p(g,h){o=g,(!f||h&1)&&c!==(c=o[6]+"")&&set_data(a,c)},i(g){f||(transition_in(r.$$.fragment,g),f=!0)},o(g){transition_out(r.$$.fragment,g),f=!1},d(g){g&&detach(t),destroy_component(r),p=!1,d()}}}function create_each_block$8(o){let t,e,i,r;const s=[create_if_block_1$d,create_else_block$a],c=[];function a(u,f){return u[8]!=u[0].length-1?0:1}return t=a(o),e=c[t]=s[t](o),{c(){e.c(),i=empty()},m(u,f){c[t].m(u,f),insert(u,i,f),r=!0},p(u,f){let p=t;t=a(u),t===p?c[t].p(u,f):(group_outros(),transition_out(c[p],1,1,()=>{c[p]=null}),check_outros(),e=c[t],e?e.p(u,f):(e=c[t]=s[t](u),e.c()),transition_in(e,1),e.m(i.parentNode,i))},i(u){r||(transition_in(e),r=!0)},o(u){transition_out(e),r=!1},d(u){c[t].d(u),u&&detach(i)}}}function create_fragment$n(o){let t,e,i=o[0].length>0&&create_if_block$i(o);return{c(){i&&i.c(),t=empty()},m(r,s){i&&i.m(r,s),insert(r,t,s),e=!0},p(r,[s]){r[0].length>0?i?(i.p(r,s),s&1&&transition_in(i,1)):(i=create_if_block$i(r),i.c(),transition_in(i,1),i.m(t.parentNode,t)):i&&(group_outros(),transition_out(i,1,1,()=>{i=null}),check_outros())},i(r){e||(transition_in(i),e=!0)},o(r){transition_out(i),e=!1},d(r){i&&i.d(r),r&&detach(t)}}}function instance$o(o,t,e){let i;const r=stores.notify;component_subscribe(o,r,f=>e(5,i=f));let{breadcrumbs:s}=t;function c(f){set_store_value(r,i={action:"clicked",kind:"breadcrumb",index:f},i)}const a=()=>c(-1),u=f=>c(f);return o.$$set=f=>{"breadcrumbs"in f&&e(0,s=f.breadcrumbs)},[s,r,c,a,u]}class Breadcrumbs extends SvelteComponent{constructor(t){super(),init(this,t,instance$o,create_fragment$n,safe_not_equal,{breadcrumbs:0})}}function create_else_block$9(o){let t,e,i,r,s,c,a;const u=[create_if_block_5$6,create_else_block_2$2],f=[];function p(h,v){return h[4].info?1:0}t=p(o),e=f[t]=u[t](o);const d=[create_if_block_4$6,create_else_block_1$3],m=[];function g(h,v){return h[4].content?1:0}return r=g(o),s=m[r]=d[r](o),{c(){e.c(),i=space(),s.c(),c=empty()},m(h,v){f[t].m(h,v),insert(h,i,v),m[r].m(h,v),insert(h,c,v),a=!0},p(h,v){let w=t;t=p(h),t===w?f[t].p(h,v):(group_outros(),transition_out(f[w],1,1,()=>{f[w]=null}),check_outros(),e=f[t],e?e.p(h,v):(e=f[t]=u[t](h),e.c()),transition_in(e,1),e.m(i.parentNode,i));let k=r;r=g(h),r===k?m[r].p(h,v):(group_outros(),transition_out(m[k],1,1,()=>{m[k]=null}),check_outros(),s=m[r],s?s.p(h,v):(s=m[r]=d[r](h),s.c()),transition_in(s,1),s.m(c.parentNode,c))},i(h){a||(transition_in(e),transition_in(s),a=!0)},o(h){transition_out(e),transition_out(s),a=!1},d(h){f[t].d(h),h&&detach(i),m[r].d(h),h&&detach(c)}}}function create_if_block_2$a(o){let t,e,i,r,s,c,a,u,f,p,d=o[5].fail&&create_if_block_3$7();return{c(){t=element("div"),e=element("div"),i=element("h3"),i.textContent="Login to share",r=space(),s=element("input"),c=space(),d&&d.c(),a=space(),u=element("button"),u.textContent="Login",attr(i,"class","font-medium text-2xl text-center py mb-5"),attr(s,"type","password"),attr(s,"placeholder","password"),attr(s,"autocomplete","off"),attr(s,"class","input w-full"),s.autofocus=!0,attr(u,"class","btn btn-secondary mt-6 w-full"),attr(e,"class","card w-96 max-w-sm m-2 mt-12 shadow-xl p-6 bg-base-200"),attr(t,"class","w-full flex justify-center items-center")},m(m,g){insert(m,t,g),append(t,e),append(e,i),append(e,r),append(e,s),set_input_value(s,o[5].value),append(e,c),d&&d.m(e,null),append(e,a),append(e,u),s.focus(),f||(p=[listen(s,"input",o[22]),listen(u,"click",o[23]),listen(e,"keydown",o[15])],f=!0)},p(m,g){g[0]&32&&s.value!==m[5].value&&set_input_value(s,m[5].value),m[5].fail?d||(d=create_if_block_3$7(),d.c(),d.m(e,a)):d&&(d.d(1),d=null)},i:noop,o:noop,d(m){m&&detach(t),d&&d.d(),f=!1,run_all(p)}}}function create_if_block_1$c(o){let t,e,i,r,s,c,a,u;return c=new Icons({props:{icon:"info"}}),{c(){t=element("div"),e=element("div"),i=element("h1"),i.textContent="CamPal",r=space(),s=element("div"),create_component(c.$$.fragment),a=text("share doesn't exist or is expired"),attr(i,"class","font-medium text-3xl text-center py-4"),attr(s,"class","alert alert-error flex justify-center mt-8"),attr(e,"class","card w-96 max-w-sm m-2 mt-12 shadow-xl p-6 bg-base-200"),attr(t,"class","w-full flex justify-center items-center")},m(f,p){insert(f,t,p),append(t,e),append(e,i),append(e,r),append(e,s),mount_component(c,s,null),append(s,a),u=!0},p:noop,i(f){u||(transition_in(c.$$.fragment,f),u=!0)},o(f){transition_out(c.$$.fragment,f),u=!1},d(f){f&&detach(t),destroy_component(c)}}}function create_if_block$h(o){let t;return{c(){t=element("div"),t.innerHTML='<div class="w-full h-96 flex justify-center items-center"><span class="loading loading-dots loading-lg"></span></div>',attr(t,"class","w-full flex justify-center items-center")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_else_block_2$2(o){let t,e,i,r=o[0].name+"",s,c,a,u,f,p,d,m,g,h,v,w,k=o[0].username+"",$,T,P,E,x,S,M,O,q=new Date(o[0].timestamp).toLocaleString()+"",F,A,Z,I,D,X,N=o[0].description&&create_if_block_7$3(o);g=new Icons({props:{icon:"share"}}),x=new Icons({props:{icon:"edit"}});let W=o[0].expires&&create_if_block_6$3(o);function R(z){o[24](z)}let U={};return o[2]!==void 0&&(U.open=o[2]),I=new Download({props:U}),binding_callbacks.push(()=>bind(I,"open",R)),{c(){t=element("div"),e=element("div"),i=element("h2"),s=text(r),c=space(),N&&N.c(),a=space(),u=element("div"),f=element("div"),p=element("div"),d=element("div"),m=element("h6"),create_component(g.$$.fragment),h=element("span"),h.textContent="shared by:",v=space(),w=element("span"),$=text(k),T=space(),P=element("div"),E=element("h6"),create_component(x.$$.fragment),S=element("span"),S.textContent="last change:",M=space(),O=element("span"),F=text(q),A=space(),W&&W.c(),Z=space(),create_component(I.$$.fragment),attr(i,"class","text-3xl font-bold"),attr(e,"class","md:mr-5 card shadow-lg p-5 w-full"),attr(h,"class","mx-2"),attr(m,"class","text-sm font-light flex"),attr(w,"class","text-sm"),attr(d,"class","flex justify-start items-center mt-5"),attr(S,"class","mx-2"),attr(E,"class","text-sm font-light flex"),attr(O,"class","text-sm"),attr(P,"class","flex justify-start items-center mt-5"),attr(f,"class","card shadow-lg p-5 flex-grow"),attr(u,"class","flex flex-col justify-between shrink-0"),attr(t,"class","w-full p-2 md:flex md:justify-center")},m(z,C){insert(z,t,C),append(t,e),append(e,i),append(i,s),append(e,c),N&&N.m(e,null),append(t,a),append(t,u),append(u,f),append(f,p),append(p,d),append(d,m),mount_component(g,m,null),append(m,h),append(d,v),append(d,w),append(w,$),append(p,T),append(p,P),append(P,E),mount_component(x,E,null),append(E,S),append(P,M),append(P,O),append(O,F),append(p,A),W&&W.m(p,null),insert(z,Z,C),mount_component(I,z,C),X=!0},p(z,C){(!X||C[0]&1)&&r!==(r=z[0].name+"")&&set_data(s,r),z[0].description?N?N.p(z,C):(N=create_if_block_7$3(z),N.c(),N.m(e,null)):N&&(N.d(1),N=null),(!X||C[0]&1)&&k!==(k=z[0].username+"")&&set_data($,k),(!X||C[0]&1)&&q!==(q=new Date(z[0].timestamp).toLocaleString()+"")&&set_data(F,q),z[0].expires?W?(W.p(z,C),C[0]&1&&transition_in(W,1)):(W=create_if_block_6$3(z),W.c(),transition_in(W,1),W.m(p,null)):W&&(group_outros(),transition_out(W,1,1,()=>{W=null}),check_outros());const j={};!D&&C[0]&4&&(D=!0,j.open=z[2],add_flush_callback(()=>D=!1)),I.$set(j)},i(z){X||(transition_in(g.$$.fragment,z),transition_in(x.$$.fragment,z),transition_in(W),transition_in(I.$$.fragment,z),X=!0)},o(z){transition_out(g.$$.fragment,z),transition_out(x.$$.fragment,z),transition_out(W),transition_out(I.$$.fragment,z),X=!1},d(z){z&&detach(t),N&&N.d(),destroy_component(g),destroy_component(x),W&&W.d(),z&&detach(Z),destroy_component(I,z)}}}function create_if_block_5$6(o){let t;return{c(){t=element("div"),t.innerHTML='<span class="loading loading-dots loading-lg"></span>',attr(t,"class","w-full h-96 flex justify-center items-center")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_if_block_7$3(o){let t,e=o[0].description+"",i;return{c(){t=element("p"),i=text(e),attr(t,"class","my-5")},m(r,s){insert(r,t,s),append(t,i)},p(r,s){s[0]&1&&e!==(e=r[0].description+"")&&set_data(i,e)},d(r){r&&detach(t)}}}function create_if_block_6$3(o){let t,e,i,r,s,c,a=new Date(o[0].expires).toLocaleString()+"",u,f;return i=new Icons({props:{icon:"clock"}}),{c(){t=element("div"),e=element("h6"),create_component(i.$$.fragment),r=element("span"),r.textContent="expires:",s=space(),c=element("span"),u=text(a),attr(r,"class","mx-2"),attr(e,"class","text-sm font-light flex"),attr(c,"class","text-sm"),attr(t,"class","flex justify-start items-center mt-5")},m(p,d){insert(p,t,d),append(t,e),mount_component(i,e,null),append(e,r),append(t,s),append(t,c),append(c,u),f=!0},p(p,d){(!f||d[0]&1)&&a!==(a=new Date(p[0].expires).toLocaleString()+"")&&set_data(u,a)},i(p){f||(transition_in(i.$$.fragment,p),f=!0)},o(p){transition_out(i.$$.fragment,p),f=!1},d(p){p&&detach(t),destroy_component(i)}}}function create_else_block_1$3(o){let t,e,i,r,s,c,a,u,f,p,d;function m($){o[25]($)}let g={};o[1]!==void 0&&(g.breadcrumbs=o[1]),i=new Breadcrumbs({props:g}),binding_callbacks.push(()=>bind(i,"breadcrumbs",m));function h($){o[26]($)}let v={folders:o[3].folders};o[6]!==void 0&&(v.view=o[6]),c=new FoldersGallery({props:v}),binding_callbacks.push(()=>bind(c,"view",h));function w($){o[27]($)}let k={files:o[3].files};return o[6]!==void 0&&(k.view=o[6]),f=new FilesGallery({props:k}),binding_callbacks.push(()=>bind(f,"view",w)),{c(){t=element("div"),e=element("div"),create_component(i.$$.fragment),s=space(),create_component(c.$$.fragment),u=space(),create_component(f.$$.fragment),attr(e,"class","md mt-5"),attr(t,"class","select-none")},m($,T){insert($,t,T),append(t,e),mount_component(i,e,null),append(t,s),mount_component(c,t,null),append(t,u),mount_component(f,t,null),d=!0},p($,T){const P={};!r&&T[0]&2&&(r=!0,P.breadcrumbs=$[1],add_flush_callback(()=>r=!1)),i.$set(P);const E={};T[0]&8&&(E.folders=$[3].folders),!a&&T[0]&64&&(a=!0,E.view=$[6],add_flush_callback(()=>a=!1)),c.$set(E);const x={};T[0]&8&&(x.files=$[3].files),!p&&T[0]&64&&(p=!0,x.view=$[6],add_flush_callback(()=>p=!1)),f.$set(x)},i($){d||(transition_in(i.$$.fragment,$),transition_in(c.$$.fragment,$),transition_in(f.$$.fragment,$),d=!0)},o($){transition_out(i.$$.fragment,$),transition_out(c.$$.fragment,$),transition_out(f.$$.fragment,$),d=!1},d($){$&&detach(t),destroy_component(i),destroy_component(c),destroy_component(f)}}}function create_if_block_4$6(o){let t;return{c(){t=element("div"),t.innerHTML='<span class="loading loading-dots loading-lg"></span>',attr(t,"class","w-full h-96 flex justify-center items-center")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_if_block_3$7(o){let t;return{c(){t=element("div"),t.innerHTML="<span>wrong password</span>",attr(t,"class","alert alert-error mt-4")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_fragment$m(o){let t,e,i,r,s,c,a,u,f,p;const d=[create_if_block$h,create_if_block_1$c,create_if_block_2$a,create_else_block$9],m=[];function g(h,v){var w,k;return h[4].exists?(w=h[0])!=null&&w.url?(k=h[0])!=null&&k.auth?3:2:1:0}return e=g(o),i=m[e]=d[e](o),c=new Icons({props:{icon:"arrow_up",size:"7"}}),{c(){t=element("div"),i.c(),r=space(),s=element("button"),create_component(c.$$.fragment),attr(s,"class",a=`rounded-full w-14 h-14 bg-secondary text-secondary-content opacity-50 fixed right-5 bottom-5 flex items-center justify-center z-20 transform-gpu will-change-transform duration-500 ease-in-out active:scale-110 ${o[7]?"translate-y-0":"translate-y-24"}`),attr(t,"class","h-full overflow-x-hidden touch-pan-y")},m(h,v){insert(h,t,v),m[e].m(t,null),append(t,r),append(t,s),mount_component(c,s,null),u=!0,f||(p=listen(s,"click",scrollToTop$3),f=!0)},p(h,v){let w=e;e=g(h),e===w?m[e].p(h,v):(group_outros(),transition_out(m[w],1,1,()=>{m[w]=null}),check_outros(),i=m[e],i?i.p(h,v):(i=m[e]=d[e](h),i.c()),transition_in(i,1),i.m(t,r)),(!u||v[0]&128&&a!==(a=`rounded-full w-14 h-14 bg-secondary text-secondary-content opacity-50 fixed right-5 bottom-5 flex items-center justify-center z-20 transform-gpu will-change-transform duration-500 ease-in-out active:scale-110 ${h[7]?"translate-y-0":"translate-y-24"}`))&&attr(s,"class",a)},i(h){u||(transition_in(i),transition_in(c.$$.fragment,h),u=!0)},o(h){transition_out(i),transition_out(c.$$.fragment,h),u=!1},d(h){h&&detach(t),m[e].d(),destroy_component(c),f=!1,p()}}}function scrollToTop$3(){window.scrollTo({top:0,behavior:"smooth"})}function instance$n(o,t,e){let i,r,s,c,a,u,{params:f={}}=t;const p=stores.options.listView;component_subscribe(o,p,C=>e(21,c=C));const d=stores.notify;component_subscribe(o,d,C=>e(19,r=C));const m=stores.options.changeView;component_subscribe(o,m,C=>e(29,u=C));const g=stores.options.download;component_subscribe(o,g,C=>e(28,a=C));const h=stores.options.downloadSelect;component_subscribe(o,h,C=>e(20,s=C));const v=stores.selected.files;component_subscribe(o,v,C=>e(18,i=C));let w={},k,$={exists:!1,info:!1,content:!1},T={value:void 0,fail:!1},P=[],E=[],x="list";async function S(){let C=await request(`share/login/${w==null?void 0:w.id}`,"post",{password:T.value});if(!C.ok){C.status==403?e(5,T={value:void 0,fail:!0}):C.status==410&&e(0,w=void 0);return}e(5,T.fail=!1,T),e(0,w.auth=!0,w),await A(!0)}async function M(C){let j=await request(`share/index/${C}`);if(!j.ok){console.log(j.status);return}e(3,k=await j.json())}async function O(C,j){let V=await request(`share/index/${C}/${j}`);if(!V.ok){console.log(V.status);return}e(3,k=await V.json())}async function q(C){let j=await request("folder/info/"+C);if(j.ok)return await j.json().then(V=>V.name)}async function F(C){e(4,$.info=!1,$);let j=await request(`share/info/${C}`);if(!j.ok){console.log(j.status);return}e(0,w={...await j.json(),auth:!0}),e(4,$.info=!0,$),console.log(w)}async function A(C){if((w==null?void 0:w.url)!=f.url||C){e(4,$={}),e(0,w={}),e(3,k={}),e(0,w.url=f.url,w);let j=await request(`shares/find/${w.url}`);if(e(4,$.exists=!0,$),j.ok?e(0,w={...await j.json(),url:f.url}):e(0,w={}),!(w!=null&&w.auth))return;await F(w==null?void 0:w.id)}if(e(4,$.content=!1,$),f.path){if(e(17,P=urlDecode(f.path)),!P){goToPage$1(`share/${f.url}`,!0);return}e(1,E=await Promise.all(P.map(async j=>await q(j)))),await O(w==null?void 0:w.id,P[P.length-1])}else e(17,P=[]),e(1,E=[]),await M(w==null?void 0:w.id);set_store_value(m,u=!0,u),k.files.length<1?(set_store_value(g,a=!1,a),set_store_value(h,s=!1,s)):set_store_value(g,a=!0,a),e(4,$.content=!0,$)}let Z=!1;window.addEventListener("scroll",C=>{e(7,Z=window.scrollY>100)});function I(C){C.keyCode==13&&(C.preventDefault(),S())}let D;function X(){T.value=this.value,e(5,T)}const N=()=>{T.value&&T.value!=""&&S()};function W(C){D=C,e(2,D)}function R(C){E=C,e(1,E)}function U(C){x=C,e(6,x),e(21,c)}function z(C){x=C,e(6,x),e(21,c)}return o.$$set=C=>{"params"in C&&e(16,f=C.params)},o.$$.update=()=>{o.$$.dirty[0]&65536&&A(),o.$$.dirty[0]&2097152&&e(6,x=c?"list":"grid"),o.$$.dirty[0]&1048576&&(s||set_store_value(v,i=[],i)),o.$$.dirty[0]&983047&&(()=>{if((r==null?void 0:r.kind)=="breadcrumb"){let C=r.index;set_store_value(d,r={},r),C==-1?goToPage$1("share/"+(f==null?void 0:f.url)):goToPage$1(`share/${f==null?void 0:f.url}/${urlEncode(P.slice(0,C+1))}`)}else if((r==null?void 0:r.kind)=="folder"){let C=r.element.id;set_store_value(d,r={},r),goToPage$1(`share/${f==null?void 0:f.url}/${urlEncode([...P,C])}`)}else if((r==null?void 0:r.action)=="download"){let C=r==null?void 0:r.kind;set_store_value(d,r={},r),C=="all"?P.length<1?D({type:"share",share:w.id,name:w.name}):D({type:"folder",folder:P[P.length-1],name:E[E.length-1]}):C=="selected"&&D({type:"files",files:i,name:w.name})}})()},[w,E,D,k,$,T,x,Z,p,d,m,g,h,v,S,I,f,P,i,r,s,c,X,N,W,R,U,z]}class Share extends SvelteComponent{constructor(t){super(),init(this,t,instance$n,create_fragment$m,safe_not_equal,{params:16},null,[-1,-1])}}function get_each_context$7(o,t,e){const i=o.slice();return i[26]=t[e],i[27]=t,i[28]=e,i}function create_else_block$8(o){let t,e,i,r=o[3].name+"",s,c,a,u,f,p,d,m,g,h,v,w,k,$,T,P,E,x,S,M,O,q,F,A,Z,I,D,X,N,W,R,U,z,C,j,V,H,G,ee,re,ae,oe,le,fe;P=new Icons({props:{icon:"world"}});let me=o[0].public.active&&create_if_block_4$5(o),de=o[4].length>0&&create_if_block_2$9(o);I=new Icons({props:{icon:"calendar"}});let ue=o[0].expires.active&&create_if_block_1$b(o);return j=new Icons({props:{icon:"share"}}),re=new Icons({props:{icon:"x"}}),{c(){t=element("h3"),t.textContent="share",e=space(),i=element("h3"),s=text(r),c=space(),a=element("label"),a.textContent="Name",u=space(),f=element("input"),d=space(),m=element("label"),m.textContent="Description",g=space(),h=element("textarea"),v=space(),w=element("div"),k=space(),$=element("div"),T=element("div"),create_component(P.$$.fragment),E=element("span"),E.textContent="public",S=space(),M=element("input"),O=space(),me&&me.c(),q=space(),de&&de.c(),F=space(),A=element("div"),Z=element("div"),create_component(I.$$.fragment),D=element("span"),D.textContent="expire date",N=space(),W=element("input"),R=space(),ue&&ue.c(),U=space(),z=element("div"),C=element("button"),create_component(j.$$.fragment),V=text(`
                    share`),G=space(),ee=element("button"),create_component(re.$$.fragment),ae=text(`
                    cancel`),attr(t,"class","font-bold text-md text-center mb-3"),attr(i,"class","text-md font-mono text-center mb-3"),attr(a,"class","font-medium block mb-1 mt-3"),attr(f,"placeholder",p=o[3].name),attr(f,"type","text"),attr(f,"autocomplete","off"),attr(f,"class","input w-full input-bordered"),attr(m,"class","font-medium block mb-1 mt-3"),attr(h,"class","textarea w-full textarea-bordered max-h-96"),attr(h,"placeholder","share description"),attr(w,"class","divider"),attr(E,"class","ml-2"),attr(T,"class",x="flex items-center "+(o[0].public.active?"":"opacity-50")),attr(M,"type","checkbox"),attr(M,"class","toggle"),attr($,"class","w-full flex justify-between mt-3"),attr(D,"class","ml-2"),attr(Z,"class",X="flex items-center "+(o[0].expires.active?"":"opacity-50")),attr(W,"type","checkbox"),attr(W,"class","toggle"),attr(A,"class","w-full flex justify-between mt-3"),attr(C,"class","btn btn-neutral"),C.disabled=H=!o[0].withUsers&&!o[0].public.active||o[0].public.active&&(!o[0].public.url.check||o[0].public.protected.active&&(!o[0].public.protected.password||o[0].public.protected.password==""))||o[0].withUsers&&o[4].filter(func$1).length<1,attr(ee,"class","btn"),attr(z,"class","flex justify-between items-center mt-8")},m(te,J){insert(te,t,J),insert(te,e,J),insert(te,i,J),append(i,s),insert(te,c,J),insert(te,a,J),insert(te,u,J),insert(te,f,J),set_input_value(f,o[0].name.value),insert(te,d,J),insert(te,m,J),insert(te,g,J),insert(te,h,J),set_input_value(h,o[0].description),insert(te,v,J),insert(te,w,J),insert(te,k,J),insert(te,$,J),append($,T),mount_component(P,T,null),append(T,E),append($,S),append($,M),M.checked=o[0].public.active,insert(te,O,J),me&&me.m(te,J),insert(te,q,J),de&&de.m(te,J),insert(te,F,J),insert(te,A,J),append(A,Z),mount_component(I,Z,null),append(Z,D),append(A,N),append(A,W),W.checked=o[0].expires.active,insert(te,R,J),ue&&ue.m(te,J),insert(te,U,J),insert(te,z,J),append(z,C),mount_component(j,C,null),append(C,V),append(z,G),append(z,ee),mount_component(re,ee,null),append(ee,ae),oe=!0,le||(fe=[listen(f,"input",o[11]),listen(h,"input",o[12]),listen(M,"change",o[13]),listen(W,"change",o[20]),listen(C,"click",o[6]),listen(ee,"click",o[9])],le=!0)},p(te,J){(!oe||J&8)&&r!==(r=te[3].name+"")&&set_data(s,r),(!oe||J&8&&p!==(p=te[3].name))&&attr(f,"placeholder",p),J&1&&f.value!==te[0].name.value&&set_input_value(f,te[0].name.value),J&1&&set_input_value(h,te[0].description),(!oe||J&1&&x!==(x="flex items-center "+(te[0].public.active?"":"opacity-50")))&&attr(T,"class",x),J&1&&(M.checked=te[0].public.active),te[0].public.active?me?(me.p(te,J),J&1&&transition_in(me,1)):(me=create_if_block_4$5(te),me.c(),transition_in(me,1),me.m(q.parentNode,q)):me&&(group_outros(),transition_out(me,1,1,()=>{me=null}),check_outros()),te[4].length>0?de?(de.p(te,J),J&16&&transition_in(de,1)):(de=create_if_block_2$9(te),de.c(),transition_in(de,1),de.m(F.parentNode,F)):de&&(group_outros(),transition_out(de,1,1,()=>{de=null}),check_outros()),(!oe||J&1&&X!==(X="flex items-center "+(te[0].expires.active?"":"opacity-50")))&&attr(Z,"class",X),J&1&&(W.checked=te[0].expires.active),te[0].expires.active?ue?ue.p(te,J):(ue=create_if_block_1$b(te),ue.c(),ue.m(U.parentNode,U)):ue&&(ue.d(1),ue=null),(!oe||J&17&&H!==(H=!te[0].withUsers&&!te[0].public.active||te[0].public.active&&(!te[0].public.url.check||te[0].public.protected.active&&(!te[0].public.protected.password||te[0].public.protected.password==""))||te[0].withUsers&&te[4].filter(func$1).length<1))&&(C.disabled=H)},i(te){oe||(transition_in(P.$$.fragment,te),transition_in(me),transition_in(de),transition_in(I.$$.fragment,te),transition_in(j.$$.fragment,te),transition_in(re.$$.fragment,te),oe=!0)},o(te){transition_out(P.$$.fragment,te),transition_out(me),transition_out(de),transition_out(I.$$.fragment,te),transition_out(j.$$.fragment,te),transition_out(re.$$.fragment,te),oe=!1},d(te){te&&detach(t),te&&detach(e),te&&detach(i),te&&detach(c),te&&detach(a),te&&detach(u),te&&detach(f),te&&detach(d),te&&detach(m),te&&detach(g),te&&detach(h),te&&detach(v),te&&detach(w),te&&detach(k),te&&detach($),destroy_component(P),te&&detach(O),me&&me.d(te),te&&detach(q),de&&de.d(te),te&&detach(F),te&&detach(A),destroy_component(I),te&&detach(R),ue&&ue.d(te),te&&detach(U),te&&detach(z),destroy_component(j),destroy_component(re),le=!1,run_all(fe)}}}function create_if_block$g(o){let t;return{c(){t=element("div"),t.innerHTML='<span class="loading loading-dots loading-lg"></span>',attr(t,"class","w-full h-32 flex justify-center items-center")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_if_block_4$5(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v,w,k,$,T,P,E,x,S,M,O,q;u=new Icons({props:{icon:"reload"}}),d=new Icons({props:{icon:"check"}}),k=new Icons({props:{icon:"key"}});let F=o[0].public.protected.active&&create_if_block_5$5(o);return{c(){t=element("label"),t.textContent="short URL",e=space(),i=element("div"),r=element("input"),c=space(),a=element("button"),create_component(u.$$.fragment),f=space(),p=element("button"),create_component(d.$$.fragment),h=space(),v=element("div"),w=element("div"),create_component(k.$$.fragment),$=element("span"),$.textContent="protected",P=space(),E=element("input"),x=space(),F&&F.c(),S=empty(),attr(t,"class","font-medium block mb-1 mt-3"),attr(r,"placeholder",s=o[0].public.url.placeholder),attr(r,"type","text"),attr(r,"autocomplete","off"),attr(r,"class","input w-full input-bordered font-mono"),attr(a,"class","btn btn-square ml-1"),attr(p,"class",m="btn btn-square ml-1 "+(o[0].public.url.check?"btn-neutral":"")),p.disabled=g=o[0].public.url.check,attr(i,"class","flex"),attr($,"class","ml-2"),attr(w,"class",T="flex items-center "+(o[0].public.protected.active?"":"opacity-50")),attr(E,"type","checkbox"),attr(E,"class","toggle"),attr(v,"class","w-full flex justify-between mt-3")},m(A,Z){insert(A,t,Z),insert(A,e,Z),insert(A,i,Z),append(i,r),set_input_value(r,o[0].public.url.value),append(i,c),append(i,a),mount_component(u,a,null),append(i,f),append(i,p),mount_component(d,p,null),insert(A,h,Z),insert(A,v,Z),append(v,w),mount_component(k,w,null),append(w,$),append(v,P),append(v,E),E.checked=o[0].public.protected.active,insert(A,x,Z),F&&F.m(A,Z),insert(A,S,Z),M=!0,O||(q=[listen(r,"keydown",o[14]),listen(r,"input",o[15]),listen(a,"click",o[7]),listen(p,"click",o[8]),listen(E,"change",o[16])],O=!0)},p(A,Z){(!M||Z&1&&s!==(s=A[0].public.url.placeholder))&&attr(r,"placeholder",s),Z&1&&r.value!==A[0].public.url.value&&set_input_value(r,A[0].public.url.value),(!M||Z&1&&m!==(m="btn btn-square ml-1 "+(A[0].public.url.check?"btn-neutral":"")))&&attr(p,"class",m),(!M||Z&1&&g!==(g=A[0].public.url.check))&&(p.disabled=g),(!M||Z&1&&T!==(T="flex items-center "+(A[0].public.protected.active?"":"opacity-50")))&&attr(w,"class",T),Z&1&&(E.checked=A[0].public.protected.active),A[0].public.protected.active?F?F.p(A,Z):(F=create_if_block_5$5(A),F.c(),F.m(S.parentNode,S)):F&&(F.d(1),F=null)},i(A){M||(transition_in(u.$$.fragment,A),transition_in(d.$$.fragment,A),transition_in(k.$$.fragment,A),M=!0)},o(A){transition_out(u.$$.fragment,A),transition_out(d.$$.fragment,A),transition_out(k.$$.fragment,A),M=!1},d(A){A&&detach(t),A&&detach(e),A&&detach(i),destroy_component(u),destroy_component(d),A&&detach(h),A&&detach(v),destroy_component(k),A&&detach(x),F&&F.d(A),A&&detach(S),O=!1,run_all(q)}}}function create_if_block_5$5(o){let t,e,i,r,s;return{c(){t=element("label"),t.textContent="Password",e=space(),i=element("input"),attr(t,"class","font-medium block mb-1 mt-3"),attr(i,"placeholder","password"),attr(i,"type","text"),attr(i,"autocomplete","off"),attr(i,"class","input w-full input-bordered font-mono")},m(c,a){insert(c,t,a),insert(c,e,a),insert(c,i,a),set_input_value(i,o[0].public.protected.password),r||(s=listen(i,"input",o[17]),r=!0)},p(c,a){a&1&&i.value!==c[0].public.protected.password&&set_input_value(i,c[0].public.protected.password)},d(c){c&&detach(t),c&&detach(e),c&&detach(i),r=!1,s()}}}function create_if_block_2$9(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v;s=new Icons({props:{icon:"users"}});let w=o[0].withUsers&&create_if_block_3$6(o);return{c(){t=element("div"),e=space(),i=element("div"),r=element("div"),create_component(s.$$.fragment),c=element("span"),c.textContent="with users",u=space(),f=element("input"),p=space(),w&&w.c(),d=space(),m=element("div"),attr(t,"class","divider"),attr(c,"class","ml-2"),attr(r,"class",a="flex items-center "+(o[0].withUsers?"":"opacity-50")),attr(f,"type","checkbox"),attr(f,"class","toggle"),attr(i,"class","w-full flex justify-between mt-3"),attr(m,"class","divider")},m(k,$){insert(k,t,$),insert(k,e,$),insert(k,i,$),append(i,r),mount_component(s,r,null),append(r,c),append(i,u),append(i,f),f.checked=o[0].withUsers,insert(k,p,$),w&&w.m(k,$),insert(k,d,$),insert(k,m,$),g=!0,h||(v=listen(f,"change",o[18]),h=!0)},p(k,$){(!g||$&1&&a!==(a="flex items-center "+(k[0].withUsers?"":"opacity-50")))&&attr(r,"class",a),$&1&&(f.checked=k[0].withUsers),k[0].withUsers?w?w.p(k,$):(w=create_if_block_3$6(k),w.c(),w.m(d.parentNode,d)):w&&(w.d(1),w=null)},i(k){g||(transition_in(s.$$.fragment,k),g=!0)},o(k){transition_out(s.$$.fragment,k),g=!1},d(k){k&&detach(t),k&&detach(e),k&&detach(i),destroy_component(s),k&&detach(p),w&&w.d(k),k&&detach(d),k&&detach(m),h=!1,v()}}}function create_if_block_3$6(o){let t,e=o[4],i=[];for(let r=0;r<e.length;r+=1)i[r]=create_each_block$7(get_each_context$7(o,e,r));return{c(){t=element("table");for(let r=0;r<i.length;r+=1)i[r].c();attr(t,"class","table mt-3")},m(r,s){insert(r,t,s);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(t,null)},p(r,s){if(s&16){e=r[4];let c;for(c=0;c<e.length;c+=1){const a=get_each_context$7(r,e,c);i[c]?i[c].p(a,s):(i[c]=create_each_block$7(a),i[c].c(),i[c].m(t,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=e.length}},d(r){r&&detach(t),destroy_each(i,r)}}}function create_each_block$7(o){let t,e,i=o[26].name+"",r,s,c,a=o[26].full_name+"",u,f,p,d,m;function g(){return o[19](o[26],o[27],o[28])}return{c(){var h;t=element("tr"),e=element("td"),r=text(i),s=space(),c=element("td"),u=text(a),f=space(),attr(t,"class",p="transition-all ease-in-out cursor-pointer "+((h=o[26])!=null&&h.selected?"bg-accent text-accent-content":"md:hover:bg-base-200"))},m(h,v){insert(h,t,v),append(t,e),append(e,r),append(t,s),append(t,c),append(c,u),append(t,f),d||(m=listen(t,"click",g),d=!0)},p(h,v){var w;o=h,v&16&&i!==(i=o[26].name+"")&&set_data(r,i),v&16&&a!==(a=o[26].full_name+"")&&set_data(u,a),v&16&&p!==(p="transition-all ease-in-out cursor-pointer "+((w=o[26])!=null&&w.selected?"bg-accent text-accent-content":"md:hover:bg-base-200"))&&attr(t,"class",p)},d(h){h&&detach(t),d=!1,m()}}}function create_if_block_1$b(o){let t,e,i;return{c(){t=element("input"),attr(t,"class","input w-full mt-3 input-bordered"),attr(t,"type","datetime-local"),attr(t,"min",timePickPresets(8).min)},m(r,s){insert(r,t,s),set_input_value(t,o[0].expires.value),e||(i=listen(t,"input",o[21]),e=!0)},p(r,s){s&1&&set_input_value(t,r[0].expires.value)},d(r){r&&detach(t),e=!1,i()}}}function create_fragment$l(o){let t,e,i,r,s;const c=[create_if_block$g,create_else_block$8],a=[];function u(f,p){return f[2]?1:0}return i=u(o),r=a[i]=c[i](o),{c(){t=element("dialog"),e=element("div"),r.c(),attr(e,"class","modal-box"),attr(t,"class","modal")},m(f,p){insert(f,t,p),append(t,e),a[i].m(e,null),o[22](t),s=!0},p(f,[p]){let d=i;i=u(f),i===d?a[i].p(f,p):(group_outros(),transition_out(a[d],1,1,()=>{a[d]=null}),check_outros(),r=a[i],r?r.p(f,p):(r=a[i]=c[i](f),r.c()),transition_in(r,1),r.m(e,null))},i(f){s||(transition_in(r),s=!0)},o(f){transition_out(r),s=!1},d(f){f&&detach(t),a[i].d(),o[22](null)}}}const func$1=o=>o==null?void 0:o.selected;function instance$m(o,t,e){let i;const r=stores.notify;component_subscribe(o,r,Z=>e(23,i=Z));let s,c=!1,a,u=[],f={name:{value:void 0,placeholder:void 0},description:void 0,expires:{active:void 0,value:void 0},public:{active:void 0,url:{value:void 0,placeholder:void 0,check:void 0},protected:{active:void 0,password:void 0}},withUsers:void 0};const p=async Z=>{v();let I=await request(`folder/info/${Z}`);if(!I.ok||(e(3,a=await I.json()),I=await request("users"),!I.ok)||(e(4,u=await I.json()),I=await request("user"),!I.ok))return;let D=await I.json().then(X=>X==null?void 0:X.id);e(4,u=u.filter(X=>X.id!=D)),await g(),d(),e(2,c=!0),s.showModal()};function d(){!f.name.value||f.name.value==""?e(0,f.name.placeholder=a==null?void 0:a.name,f):e(0,f.name.placeholder=f.name.value,f),(!f.public.url.value||f.public.url.value=="")&&e(0,f.public.url.placeholder=encodeURIComponent(f.public.url.value),f)}async function m(){(await request("share","post",{name:!f.name.value||f.name.value==""?f.name.placeholder:f.name.value,description:f.description,folder_id:a.id,...f.expires.active&&{expires:new Date(f.expires.value).getTime()},...f.public.active&&{url:f.public.url.value},...f.public.protected&&{password:f.public.protected.password},...f.withUsers&&{users:u.filter(I=>I.selected).map(I=>I.id)}})).ok&&(set_store_value(r,i={action:"added",kind:"share"},i),s.close())}async function g(){let Z=await request("shares/randomurl");Z.ok&&(e(0,f.public.url.value=await Z.text(),f),e(0,f.public.url.check=!0,f))}async function h(){let Z=!f.public.url.value||f.public.url.value==""?f.public.url.placeholder:encodeURIComponent(f.public.url.value),I=-1,D=!1;for(;!D;)D=(await request(`shares/checkurl/${Z+(I>0?"-"+I:"")}`)).ok,I+=1;e(0,f.public.url.value=Z+(I>0?"-"+I:""),f),e(0,f.public.url.check=!0,f)}function v(){e(2,c=!1),e(0,f={name:{value:void 0,placeholder:void 0},description:void 0,expires:{active:void 0,value:timePickPresets(8).preset},public:{active:void 0,url:{value:void 0,placeholder:void 0,check:void 0},protected:{active:void 0,password:void 0}},withUsers:void 0})}function w(){s.close()}function k(){f.name.value=this.value,e(0,f)}function $(){f.description=this.value,e(0,f)}function T(){f.public.active=this.checked,e(0,f)}const P=()=>e(0,f.public.url.check=!1,f);function E(){f.public.url.value=this.value,e(0,f)}function x(){f.public.protected.active=this.checked,e(0,f)}function S(){f.public.protected.password=this.value,e(0,f)}function M(){f.withUsers=this.checked,e(0,f)}const O=(Z,I,D)=>{Z!=null&&Z.selected?e(4,I[D].selected=!1,u):e(4,I[D].selected=!0,u),e(4,u=u.map(X=>X.id==Z.id?Z:X))};function q(){f.expires.active=this.checked,e(0,f)}function F(){f.expires.value=this.value,e(0,f)}function A(Z){binding_callbacks[Z?"unshift":"push"](()=>{s=Z,e(1,s)})}return o.$$.update=()=>{o.$$.dirty&1&&(f.name.value,d())},[f,s,c,a,u,r,m,g,h,w,p,k,$,T,P,E,x,S,M,O,q,F,A]}class AddShare extends SvelteComponent{constructor(t){super(),init(this,t,instance$m,create_fragment$l,safe_not_equal,{open:10})}get open(){return this.$$.ctx[10]}}function create_else_block$7(o){let t,e,i,r,s,c,a,u,f,p,d,m;function g(P){o[22](P)}let h={};o[1]!==void 0&&(h.breadcrumbs=o[1]),e=new Breadcrumbs({props:h}),binding_callbacks.push(()=>bind(e,"breadcrumbs",g));function v(P){o[23](P)}function w(P){o[24](P)}let k={};o[7]!==void 0&&(k.view=o[7]),o[6]!==void 0&&(k.folders=o[6]),s=new FoldersGallery({props:k}),binding_callbacks.push(()=>bind(s,"view",v)),binding_callbacks.push(()=>bind(s,"folders",w));function $(P){o[25](P)}let T={files:o[0]};return o[7]!==void 0&&(T.view=o[7]),p=new FilesGallery({props:T}),binding_callbacks.push(()=>bind(p,"view",$)),{c(){t=element("div"),create_component(e.$$.fragment),r=space(),create_component(s.$$.fragment),f=space(),create_component(p.$$.fragment),attr(t,"class",u=o[4]?"opacity-50 pointer-events-none":"")},m(P,E){insert(P,t,E),mount_component(e,t,null),append(t,r),mount_component(s,t,null),insert(P,f,E),mount_component(p,P,E),m=!0},p(P,E){const x={};!i&&E[0]&2&&(i=!0,x.breadcrumbs=P[1],add_flush_callback(()=>i=!1)),e.$set(x);const S={};!c&&E[0]&128&&(c=!0,S.view=P[7],add_flush_callback(()=>c=!1)),!a&&E[0]&64&&(a=!0,S.folders=P[6],add_flush_callback(()=>a=!1)),s.$set(S),(!m||E[0]&16&&u!==(u=P[4]?"opacity-50 pointer-events-none":""))&&attr(t,"class",u);const M={};E[0]&1&&(M.files=P[0]),!d&&E[0]&128&&(d=!0,M.view=P[7],add_flush_callback(()=>d=!1)),p.$set(M)},i(P){m||(transition_in(e.$$.fragment,P),transition_in(s.$$.fragment,P),transition_in(p.$$.fragment,P),m=!0)},o(P){transition_out(e.$$.fragment,P),transition_out(s.$$.fragment,P),transition_out(p.$$.fragment,P),m=!1},d(P){P&&detach(t),destroy_component(e),destroy_component(s),P&&detach(f),destroy_component(p,P)}}}function create_if_block$f(o){let t;return{c(){t=element("div"),t.innerHTML='<span class="loading loading-dots loading-lg"></span>',attr(t,"class","w-full h-96 flex justify-center items-center")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_fragment$k(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v,w;const k=[create_if_block$f,create_else_block$7],$=[];function T(M,O){return M[5]?1:0}e=T(o),i=$[e]=k[e](o),c=new Icons({props:{icon:"arrow_up",size:"7"}});function P(M){o[26](M)}let E={};o[2]!==void 0&&(E.open=o[2]),f=new AddShare({props:E}),binding_callbacks.push(()=>bind(f,"open",P));function x(M){o[27](M)}let S={};return o[3]!==void 0&&(S.open=o[3]),m=new Download({props:S}),binding_callbacks.push(()=>bind(m,"open",x)),{c(){t=element("div"),i.c(),r=space(),s=element("button"),create_component(c.$$.fragment),u=space(),create_component(f.$$.fragment),d=space(),create_component(m.$$.fragment),attr(s,"class",a=`rounded-full w-14 h-14 bg-secondary text-secondary-content opacity-50 fixed right-5 bottom-5 flex items-center justify-center z-20 transform-gpu will-change-transform duration-500 ease-in-out active:scale-110 ${o[8]?"translate-y-0":"translate-y-24"}`),attr(t,"class","select-none h-full touch-pan-y")},m(M,O){insert(M,t,O),$[e].m(t,null),append(t,r),append(t,s),mount_component(c,s,null),insert(M,u,O),mount_component(f,M,O),insert(M,d,O),mount_component(m,M,O),h=!0,v||(w=listen(s,"click",scrollToTop$2),v=!0)},p(M,O){let q=e;e=T(M),e===q?$[e].p(M,O):(group_outros(),transition_out($[q],1,1,()=>{$[q]=null}),check_outros(),i=$[e],i?i.p(M,O):(i=$[e]=k[e](M),i.c()),transition_in(i,1),i.m(t,r)),(!h||O[0]&256&&a!==(a=`rounded-full w-14 h-14 bg-secondary text-secondary-content opacity-50 fixed right-5 bottom-5 flex items-center justify-center z-20 transform-gpu will-change-transform duration-500 ease-in-out active:scale-110 ${M[8]?"translate-y-0":"translate-y-24"}`))&&attr(s,"class",a);const F={};!p&&O[0]&4&&(p=!0,F.open=M[2],add_flush_callback(()=>p=!1)),f.$set(F);const A={};!g&&O[0]&8&&(g=!0,A.open=M[3],add_flush_callback(()=>g=!1)),m.$set(A)},i(M){h||(transition_in(i),transition_in(c.$$.fragment,M),transition_in(f.$$.fragment,M),transition_in(m.$$.fragment,M),h=!0)},o(M){transition_out(i),transition_out(c.$$.fragment,M),transition_out(f.$$.fragment,M),transition_out(m.$$.fragment,M),h=!1},d(M){M&&detach(t),$[e].d(),destroy_component(c),M&&detach(u),destroy_component(f,M),M&&detach(d),destroy_component(m,M),v=!1,w()}}}function scrollToTop$2(){window.scrollTo({top:0,behavior:"smooth"})}function instance$l(o,t,e){let i,r,s,c,a,u,f,p,{params:d={}}=t;const m=stores.options.listView;component_subscribe(o,m,j=>e(19,i=j));const g=stores.notify;component_subscribe(o,g,j=>e(21,a=j));const h=stores.options.download;component_subscribe(o,h,j=>e(30,f=j));const v=stores.options.share;component_subscribe(o,v,j=>e(31,p=j));const w=stores.selected.files;component_subscribe(o,w,j=>e(28,r=j));const k=stores.options.downloadSelect;component_subscribe(o,k,j=>e(4,s=j));const $=stores.selected.files;component_subscribe(o,$,j=>e(20,c=j));const T=stores.options.changeView;component_subscribe(o,T,j=>e(29,u=j));let P=!1,E=[],x=[],S="grid",M=[],O=[];async function q(){e(6,E=[]),e(0,x=[]);let j=await request("basedirs");if(!j.ok){goToPage$1("login",!0);return}for(let V of await j.json()){let H=await request("folder/index/"+V.folder_id);if(!H.ok){goToPage$1("login",!0);return}let G=await H.json();e(6,E=[...E,...G.folders]),e(0,x=[...x,...G.files])}}async function F(j){let V=await request("folder/index/"+j);if(!V.ok){goToPage$1("login",!0);return}let H=await V.json();e(6,E=H.folders),e(0,x=H.files)}async function A(j){let V=await request("folder/info/"+j);if(!V.ok){goToPage$1("login",!0);return}return await V.json().then(H=>H.name)}async function Z(){if(e(5,P=!1),set_store_value(k,s=!1,s),d.path){if(e(18,M=urlDecode(d.path)),!M){goToPage$1("folders",!0);return}e(1,O=await Promise.all(M.map(async j=>await A(j)))),await F(M[M.length-1]),set_store_value(v,p=!0,p)}else e(18,M=[]),e(1,O=[]),await q(),set_store_value(v,p=!1,p);x.length>0?set_store_value(h,f=!0,f):set_store_value(h,f=!1,f),set_store_value(T,u=!0,u),e(5,P=!0)}let I,D,X=!1;window.addEventListener("scroll",j=>{e(8,X=window.scrollY>100)});function N(j){O=j,e(1,O)}function W(j){S=j,e(7,S),e(19,i)}function R(j){E=j,e(6,E)}function U(j){S=j,e(7,S),e(19,i)}function z(j){I=j,e(2,I)}function C(j){D=j,e(3,D)}return o.$$set=j=>{"params"in j&&e(17,d=j.params)},o.$$.update=()=>{o.$$.dirty[0]&3407887&&(async()=>{if((a==null?void 0:a.kind)=="folder"){let j=a.element;set_store_value(g,a={},a);let V=[...M,j.id];goToPage$1("folders/"+urlEncode(V))}else if((a==null?void 0:a.kind)=="breadcrumb"){let j=a.index;set_store_value(g,a={},a),j==-1?goToPage$1("folders"):goToPage$1("folders/"+urlEncode(M.slice(0,j+1)))}else if((a==null?void 0:a.action)=="addShare")set_store_value(g,a={},a),I(M[M.length-1]);else if((a==null?void 0:a.action)=="download"){if((a==null?void 0:a.kind)=="all")set_store_value(g,a={},a),M.length<1?D({type:"files",files:x.map(j=>j.id),name:"name",basedirs:!0}):D({type:"folder",folder:M[M.length-1],name:O[O.length-1]});else if((a==null?void 0:a.kind)=="selected"){set_store_value(g,a={},a);let j=O[O.length-1];D({type:"files",files:c,name:j})}}})(),o.$$.dirty[0]&16&&(s||set_store_value(w,r=[],r)),o.$$.dirty[0]&131072&&Z(),o.$$.dirty[0]&524288&&e(7,S=i?"list":"grid")},[x,O,I,D,s,P,E,S,X,m,g,h,v,w,k,$,T,d,M,i,c,a,N,W,R,U,z,C]}class Folders extends SvelteComponent{constructor(t){super(),init(this,t,instance$l,create_fragment$k,safe_not_equal,{params:17},null,[-1,-1])}}function instance$k(o){async function t(){if(await request("basedirs").then(async i=>i.ok?await i.json().then(r=>r.length>0):!1)){goToPage$1("folders",!0);return}goToPage$1("shared",!0)}return t(),[]}class Init extends SvelteComponent{constructor(t){super(),init(this,t,instance$k,null,safe_not_equal,{})}}function create_fragment$j(o){var P;let t,e,i,r=((P=o[0])==null?void 0:P.name)+"",s,c,a,u,f,p,d,m,g,h,v,w,k,$,T;return d=new Icons({props:{icon:"trash"}}),v=new Icons({props:{icon:"x"}}),{c(){t=element("dialog"),e=element("div"),i=element("h3"),s=text(r),c=space(),a=element("h3"),a.textContent="will be deleted from the database.",u=space(),f=element("div"),p=element("button"),create_component(d.$$.fragment),m=text(`
                confirm`),g=space(),h=element("button"),create_component(v.$$.fragment),w=text(`
                abort`),attr(i,"class","text-md font-mono text-center mt-2"),attr(a,"class","font-bold text-lg text-center mb-7 mt-2"),attr(p,"class","btn btn-error"),attr(h,"class","btn"),attr(f,"class","flex justify-between items-center mt-3"),attr(e,"class","modal-box"),attr(t,"class","modal")},m(E,x){insert(E,t,x),append(t,e),append(e,i),append(i,s),append(e,c),append(e,a),append(e,u),append(e,f),append(f,p),mount_component(d,p,null),append(p,m),append(f,g),append(f,h),mount_component(v,h,null),append(h,w),o[6](t),k=!0,$||(T=[listen(p,"click",o[3]),listen(h,"click",o[4])],$=!0)},p(E,[x]){var S;(!k||x&1)&&r!==(r=((S=E[0])==null?void 0:S.name)+"")&&set_data(s,r)},i(E){k||(transition_in(d.$$.fragment,E),transition_in(v.$$.fragment,E),k=!0)},o(E){transition_out(d.$$.fragment,E),transition_out(v.$$.fragment,E),k=!1},d(E){E&&detach(t),destroy_component(d),destroy_component(v),o[6](null),$=!1,run_all(T)}}}function instance$j(o,t,e){let i;const r=stores.notify;component_subscribe(o,r,d=>e(7,i=d));let s,c;const a=d=>{e(0,s=d),console.log(d),c.showModal()};async function u(){(await request(`share/${s.id}`,"delete")).ok&&(set_store_value(r,i={action:"deleted",kind:"share"},i),c.close())}function f(){c.close()}function p(d){binding_callbacks[d?"unshift":"push"](()=>{c=d,e(1,c)})}return[s,c,r,u,f,a,p]}class ConfirmShareDelete extends SvelteComponent{constructor(t){super(),init(this,t,instance$j,create_fragment$j,safe_not_equal,{open:5})}get open(){return this.$$.ctx[5]}}function get_each_context$6(o,t,e){const i=o.slice();return i[30]=t[e],i[31]=t,i[32]=e,i}function create_else_block$6(o){let t,e,i,r=o[4].name+"",s,c,a,u,f,p,d,m,g,h,v,w,k,$,T,P,E,x,S,M,O,q,F,A,Z,I,D,X,N,W,R,U,z,C,j,V,H,G,ee,re,ae,oe,le,fe,me,de,ue,te,J;P=new Icons({props:{icon:"world"}});let Q=o[0].public.active&&create_if_block_4$4(o),he=o[3].length>0&&create_if_block_2$8(o);I=new Icons({props:{icon:"calendar"}});let _e=o[0].expires.active&&create_if_block_1$a(o);return j=new Icons({props:{icon:"save"}}),re=new Icons({props:{icon:"trash"}}),me=new Icons({props:{icon:"x"}}),{c(){t=element("h3"),t.textContent="share",e=space(),i=element("h3"),s=text(r),c=space(),a=element("label"),a.textContent="Name",u=space(),f=element("input"),d=space(),m=element("label"),m.textContent="Description",g=space(),h=element("textarea"),v=space(),w=element("div"),k=space(),$=element("div"),T=element("div"),create_component(P.$$.fragment),E=element("span"),E.textContent="public",S=space(),M=element("input"),O=space(),Q&&Q.c(),q=space(),he&&he.c(),F=space(),A=element("div"),Z=element("div"),create_component(I.$$.fragment),D=element("span"),D.textContent="expire date",N=space(),W=element("input"),R=space(),_e&&_e.c(),U=space(),z=element("div"),C=element("button"),create_component(j.$$.fragment),V=text(`
                    save`),G=space(),ee=element("button"),create_component(re.$$.fragment),ae=space(),oe=element("span"),oe.textContent="delete",le=space(),fe=element("button"),create_component(me.$$.fragment),de=text(`
                    cancel`),attr(t,"class","font-bold text-md text-center mb-3"),attr(i,"class","text-md font-mono text-center mb-3"),attr(a,"class","font-medium block mb-1 mt-3"),attr(f,"placeholder",p=o[4].name),attr(f,"type","text"),attr(f,"autocomplete","off"),attr(f,"class","input w-full input-bordered"),attr(m,"class","font-medium block mb-1 mt-3"),attr(h,"class","textarea w-full textarea-bordered max-h-96"),attr(h,"placeholder","share description"),attr(w,"class","divider"),attr(E,"class","ml-2"),attr(T,"class",x="flex items-center "+(o[0].public.active?"":"opacity-50")),attr(M,"type","checkbox"),attr(M,"class","toggle"),attr($,"class","w-full flex justify-between mt-3"),attr(D,"class","ml-2"),attr(Z,"class",X="flex items-center "+(o[0].expires.active?"":"opacity-50")),attr(W,"type","checkbox"),attr(W,"class","toggle"),attr(A,"class","w-full flex justify-between mt-3"),attr(C,"class","btn btn-neutral"),C.disabled=H=!o[0].withUsers&&!o[0].public.active||o[0].public.active&&(!o[0].public.url.check||o[0].public.protected.active&&(!o[0].public.protected.password||o[0].public.protected.password=="")&&o[0].public.protected.placeholder!="keep existing")||o[0].withUsers&&o[3].filter(func).length<1,attr(oe,"class","hidden md:inline"),attr(ee,"class","btn btn-error"),attr(fe,"class","btn"),attr(z,"class","flex justify-between items-center mt-8")},m(ne,ie){insert(ne,t,ie),insert(ne,e,ie),insert(ne,i,ie),append(i,s),insert(ne,c,ie),insert(ne,a,ie),insert(ne,u,ie),insert(ne,f,ie),set_input_value(f,o[0].name.value),insert(ne,d,ie),insert(ne,m,ie),insert(ne,g,ie),insert(ne,h,ie),set_input_value(h,o[0].description),insert(ne,v,ie),insert(ne,w,ie),insert(ne,k,ie),insert(ne,$,ie),append($,T),mount_component(P,T,null),append(T,E),append($,S),append($,M),M.checked=o[0].public.active,insert(ne,O,ie),Q&&Q.m(ne,ie),insert(ne,q,ie),he&&he.m(ne,ie),insert(ne,F,ie),insert(ne,A,ie),append(A,Z),mount_component(I,Z,null),append(Z,D),append(A,N),append(A,W),W.checked=o[0].expires.active,insert(ne,R,ie),_e&&_e.m(ne,ie),insert(ne,U,ie),insert(ne,z,ie),append(z,C),mount_component(j,C,null),append(C,V),append(z,G),append(z,ee),mount_component(re,ee,null),append(ee,ae),append(ee,oe),append(z,le),append(z,fe),mount_component(me,fe,null),append(fe,de),ue=!0,te||(J=[listen(f,"input",o[13]),listen(h,"input",o[14]),listen(M,"change",o[15]),listen(W,"change",o[22]),listen(C,"click",o[8]),listen(ee,"click",o[24]),listen(fe,"click",o[11])],te=!0)},p(ne,ie){(!ue||ie[0]&16)&&r!==(r=ne[4].name+"")&&set_data(s,r),(!ue||ie[0]&16&&p!==(p=ne[4].name))&&attr(f,"placeholder",p),ie[0]&1&&f.value!==ne[0].name.value&&set_input_value(f,ne[0].name.value),ie[0]&1&&set_input_value(h,ne[0].description),(!ue||ie[0]&1&&x!==(x="flex items-center "+(ne[0].public.active?"":"opacity-50")))&&attr(T,"class",x),ie[0]&1&&(M.checked=ne[0].public.active),ne[0].public.active?Q?(Q.p(ne,ie),ie[0]&1&&transition_in(Q,1)):(Q=create_if_block_4$4(ne),Q.c(),transition_in(Q,1),Q.m(q.parentNode,q)):Q&&(group_outros(),transition_out(Q,1,1,()=>{Q=null}),check_outros()),ne[3].length>0?he?(he.p(ne,ie),ie[0]&8&&transition_in(he,1)):(he=create_if_block_2$8(ne),he.c(),transition_in(he,1),he.m(F.parentNode,F)):he&&(group_outros(),transition_out(he,1,1,()=>{he=null}),check_outros()),(!ue||ie[0]&1&&X!==(X="flex items-center "+(ne[0].expires.active?"":"opacity-50")))&&attr(Z,"class",X),ie[0]&1&&(W.checked=ne[0].expires.active),ne[0].expires.active?_e?_e.p(ne,ie):(_e=create_if_block_1$a(ne),_e.c(),_e.m(U.parentNode,U)):_e&&(_e.d(1),_e=null),(!ue||ie[0]&9&&H!==(H=!ne[0].withUsers&&!ne[0].public.active||ne[0].public.active&&(!ne[0].public.url.check||ne[0].public.protected.active&&(!ne[0].public.protected.password||ne[0].public.protected.password=="")&&ne[0].public.protected.placeholder!="keep existing")||ne[0].withUsers&&ne[3].filter(func).length<1))&&(C.disabled=H)},i(ne){ue||(transition_in(P.$$.fragment,ne),transition_in(Q),transition_in(he),transition_in(I.$$.fragment,ne),transition_in(j.$$.fragment,ne),transition_in(re.$$.fragment,ne),transition_in(me.$$.fragment,ne),ue=!0)},o(ne){transition_out(P.$$.fragment,ne),transition_out(Q),transition_out(he),transition_out(I.$$.fragment,ne),transition_out(j.$$.fragment,ne),transition_out(re.$$.fragment,ne),transition_out(me.$$.fragment,ne),ue=!1},d(ne){ne&&detach(t),ne&&detach(e),ne&&detach(i),ne&&detach(c),ne&&detach(a),ne&&detach(u),ne&&detach(f),ne&&detach(d),ne&&detach(m),ne&&detach(g),ne&&detach(h),ne&&detach(v),ne&&detach(w),ne&&detach(k),ne&&detach($),destroy_component(P),ne&&detach(O),Q&&Q.d(ne),ne&&detach(q),he&&he.d(ne),ne&&detach(F),ne&&detach(A),destroy_component(I),ne&&detach(R),_e&&_e.d(ne),ne&&detach(U),ne&&detach(z),destroy_component(j),destroy_component(re),destroy_component(me),te=!1,run_all(J)}}}function create_if_block$e(o){let t;return{c(){t=element("div"),t.innerHTML='<span class="loading loading-dots loading-lg"></span>',attr(t,"class","w-full h-32 flex justify-center items-center")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_if_block_4$4(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v,w,k,$,T,P,E,x,S,M,O,q;u=new Icons({props:{icon:"reload"}}),d=new Icons({props:{icon:"check"}}),k=new Icons({props:{icon:"key"}});let F=o[0].public.protected.active&&create_if_block_5$4(o);return{c(){t=element("label"),t.textContent="short URL",e=space(),i=element("div"),r=element("input"),c=space(),a=element("button"),create_component(u.$$.fragment),f=space(),p=element("button"),create_component(d.$$.fragment),h=space(),v=element("div"),w=element("div"),create_component(k.$$.fragment),$=element("span"),$.textContent="protected",P=space(),E=element("input"),x=space(),F&&F.c(),S=empty(),attr(t,"class","font-medium block mb-1 mt-3"),attr(r,"placeholder",s=o[0].public.url.placeholder),attr(r,"type","text"),attr(r,"autocomplete","off"),attr(r,"class","input w-full input-bordered font-mono"),attr(a,"class","btn btn-square ml-1"),attr(p,"class",m="btn btn-square ml-1 "+(o[0].public.url.check?"btn-neutral":"")),p.disabled=g=o[0].public.url.check,attr(i,"class","flex"),attr($,"class","ml-2"),attr(w,"class",T="flex items-center "+(o[0].public.protected.active?"":"opacity-50")),attr(E,"type","checkbox"),attr(E,"class","toggle"),attr(v,"class","w-full flex justify-between mt-3")},m(A,Z){insert(A,t,Z),insert(A,e,Z),insert(A,i,Z),append(i,r),set_input_value(r,o[0].public.url.value),append(i,c),append(i,a),mount_component(u,a,null),append(i,f),append(i,p),mount_component(d,p,null),insert(A,h,Z),insert(A,v,Z),append(v,w),mount_component(k,w,null),append(w,$),append(v,P),append(v,E),E.checked=o[0].public.protected.active,insert(A,x,Z),F&&F.m(A,Z),insert(A,S,Z),M=!0,O||(q=[listen(r,"keydown",o[16]),listen(r,"input",o[17]),listen(a,"click",o[9]),listen(p,"click",o[10]),listen(E,"change",o[18])],O=!0)},p(A,Z){(!M||Z[0]&1&&s!==(s=A[0].public.url.placeholder))&&attr(r,"placeholder",s),Z[0]&1&&r.value!==A[0].public.url.value&&set_input_value(r,A[0].public.url.value),(!M||Z[0]&1&&m!==(m="btn btn-square ml-1 "+(A[0].public.url.check?"btn-neutral":"")))&&attr(p,"class",m),(!M||Z[0]&1&&g!==(g=A[0].public.url.check))&&(p.disabled=g),(!M||Z[0]&1&&T!==(T="flex items-center "+(A[0].public.protected.active?"":"opacity-50")))&&attr(w,"class",T),Z[0]&1&&(E.checked=A[0].public.protected.active),A[0].public.protected.active?F?F.p(A,Z):(F=create_if_block_5$4(A),F.c(),F.m(S.parentNode,S)):F&&(F.d(1),F=null)},i(A){M||(transition_in(u.$$.fragment,A),transition_in(d.$$.fragment,A),transition_in(k.$$.fragment,A),M=!0)},o(A){transition_out(u.$$.fragment,A),transition_out(d.$$.fragment,A),transition_out(k.$$.fragment,A),M=!1},d(A){A&&detach(t),A&&detach(e),A&&detach(i),destroy_component(u),destroy_component(d),A&&detach(h),A&&detach(v),destroy_component(k),A&&detach(x),F&&F.d(A),A&&detach(S),O=!1,run_all(q)}}}function create_if_block_5$4(o){let t,e,i,r,s,c;return{c(){t=element("label"),t.textContent="Password",e=space(),i=element("input"),attr(t,"class","font-medium block mb-1 mt-3"),attr(i,"placeholder",r=o[0].public.protected.placeholder),attr(i,"type","text"),attr(i,"autocomplete","off"),attr(i,"class","input w-full input-bordered font-mono")},m(a,u){insert(a,t,u),insert(a,e,u),insert(a,i,u),set_input_value(i,o[0].public.protected.password),s||(c=listen(i,"input",o[19]),s=!0)},p(a,u){u[0]&1&&r!==(r=a[0].public.protected.placeholder)&&attr(i,"placeholder",r),u[0]&1&&i.value!==a[0].public.protected.password&&set_input_value(i,a[0].public.protected.password)},d(a){a&&detach(t),a&&detach(e),a&&detach(i),s=!1,c()}}}function create_if_block_2$8(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v;s=new Icons({props:{icon:"users"}});let w=o[0].withUsers&&create_if_block_3$5(o);return{c(){t=element("div"),e=space(),i=element("div"),r=element("div"),create_component(s.$$.fragment),c=element("span"),c.textContent="with users",u=space(),f=element("input"),p=space(),w&&w.c(),d=space(),m=element("div"),attr(t,"class","divider"),attr(c,"class","ml-2"),attr(r,"class",a="flex items-center "+(o[0].withUsers?"":"opacity-50")),attr(f,"type","checkbox"),attr(f,"class","toggle"),attr(i,"class","w-full flex justify-between mt-3"),attr(m,"class","divider")},m(k,$){insert(k,t,$),insert(k,e,$),insert(k,i,$),append(i,r),mount_component(s,r,null),append(r,c),append(i,u),append(i,f),f.checked=o[0].withUsers,insert(k,p,$),w&&w.m(k,$),insert(k,d,$),insert(k,m,$),g=!0,h||(v=listen(f,"change",o[20]),h=!0)},p(k,$){(!g||$[0]&1&&a!==(a="flex items-center "+(k[0].withUsers?"":"opacity-50")))&&attr(r,"class",a),$[0]&1&&(f.checked=k[0].withUsers),k[0].withUsers?w?w.p(k,$):(w=create_if_block_3$5(k),w.c(),w.m(d.parentNode,d)):w&&(w.d(1),w=null)},i(k){g||(transition_in(s.$$.fragment,k),g=!0)},o(k){transition_out(s.$$.fragment,k),g=!1},d(k){k&&detach(t),k&&detach(e),k&&detach(i),destroy_component(s),k&&detach(p),w&&w.d(k),k&&detach(d),k&&detach(m),h=!1,v()}}}function create_if_block_3$5(o){let t,e=o[3],i=[];for(let r=0;r<e.length;r+=1)i[r]=create_each_block$6(get_each_context$6(o,e,r));return{c(){t=element("table");for(let r=0;r<i.length;r+=1)i[r].c();attr(t,"class","table mt-3")},m(r,s){insert(r,t,s);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(t,null)},p(r,s){if(s[0]&8){e=r[3];let c;for(c=0;c<e.length;c+=1){const a=get_each_context$6(r,e,c);i[c]?i[c].p(a,s):(i[c]=create_each_block$6(a),i[c].c(),i[c].m(t,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=e.length}},d(r){r&&detach(t),destroy_each(i,r)}}}function create_each_block$6(o){let t,e,i=o[30].name+"",r,s,c,a=o[30].full_name+"",u,f,p,d,m;function g(){return o[21](o[30],o[31],o[32])}return{c(){var h;t=element("tr"),e=element("td"),r=text(i),s=space(),c=element("td"),u=text(a),f=space(),attr(t,"class",p="transition-all ease-in-out cursor-pointer "+((h=o[30])!=null&&h.selected?"bg-accent text-accent-content":"md:hover:bg-base-200"))},m(h,v){insert(h,t,v),append(t,e),append(e,r),append(t,s),append(t,c),append(c,u),append(t,f),d||(m=listen(t,"click",g),d=!0)},p(h,v){var w;o=h,v[0]&8&&i!==(i=o[30].name+"")&&set_data(r,i),v[0]&8&&a!==(a=o[30].full_name+"")&&set_data(u,a),v[0]&8&&p!==(p="transition-all ease-in-out cursor-pointer "+((w=o[30])!=null&&w.selected?"bg-accent text-accent-content":"md:hover:bg-base-200"))&&attr(t,"class",p)},d(h){h&&detach(t),d=!1,m()}}}function create_if_block_1$a(o){let t,e,i;return{c(){t=element("input"),attr(t,"class","input w-full mt-3 input-bordered"),attr(t,"type","datetime-local"),attr(t,"min",timePickPresets(8).min)},m(r,s){insert(r,t,s),set_input_value(t,o[0].expires.value),e||(i=listen(t,"input",o[23]),e=!0)},p(r,s){s[0]&1&&set_input_value(t,r[0].expires.value)},d(r){r&&detach(t),e=!1,i()}}}function create_fragment$i(o){let t,e,i,r,s,c,a,u;const f=[create_if_block$e,create_else_block$6],p=[];function d(h,v){return h[2]?1:0}i=d(o),r=p[i]=f[i](o);function m(h){o[26](h)}let g={};return o[6]!==void 0&&(g.open=o[6]),c=new ConfirmShareDelete({props:g}),binding_callbacks.push(()=>bind(c,"open",m)),{c(){t=element("dialog"),e=element("div"),r.c(),s=space(),create_component(c.$$.fragment),attr(e,"class","modal-box"),attr(t,"class","modal")},m(h,v){insert(h,t,v),append(t,e),p[i].m(e,null),o[25](t),insert(h,s,v),mount_component(c,h,v),u=!0},p(h,v){let w=i;i=d(h),i===w?p[i].p(h,v):(group_outros(),transition_out(p[w],1,1,()=>{p[w]=null}),check_outros(),r=p[i],r?r.p(h,v):(r=p[i]=f[i](h),r.c()),transition_in(r,1),r.m(e,null));const k={};!a&&v[0]&64&&(a=!0,k.open=h[6],add_flush_callback(()=>a=!1)),c.$set(k)},i(h){u||(transition_in(r),transition_in(c.$$.fragment,h),u=!0)},o(h){transition_out(r),transition_out(c.$$.fragment,h),u=!1},d(h){h&&detach(t),p[i].d(),o[25](null),h&&detach(s),destroy_component(c,h)}}}const func=o=>o==null?void 0:o.selected;function instance$i(o,t,e){let i;const r=stores.notify;component_subscribe(o,r,N=>e(27,i=N));let s,c=!1,a=[],u,f,p={name:{value:void 0,placeholder:void 0},description:void 0,expires:{active:!1,value:timePickPresets(8).preset},public:{active:void 0,url:{value:void 0,placeholder:void 0,check:void 0},protected:{active:void 0,password:void 0,placeholder:void 0}},thumbnail:void 0,withUsers:void 0};const d=async N=>{w();let W=await request(`share/info/${N}`);if(!W.ok)return;let R=await W.json();if(e(5,f=R.id),e(0,p.name.value=R.name,p),e(0,p.description=R.description,p),R.expires&&(e(0,p.expires.active=!0,p),e(0,p.expires.value=timeToShortLocaleISO(R.expires),p)),e(0,p.thumbnail=R.thumbnail,p),R.url&&(e(0,p.public.active=!0,p),e(0,p.public.url.value=R.url,p),e(0,p.public.url.check=!0,p)),R.pw&&(e(0,p.public.protected.active=!0,p),e(0,p.public.protected.placeholder="keep existing",p)),W=await request("users"),!W.ok){console.log(W.status);return}if(e(3,a=await W.json()),W=await request("user"),!W.ok){console.log(W.status);return}let U=await W.json().then(z=>z==null?void 0:z.id);if(e(3,a=a.filter(z=>z.id!=U)),e(3,a=a.map(z=>(R.users.includes(z.id)&&(z.selected=!0),z))),a.filter(z=>z.selected).length>0&&e(0,p.withUsers=!0,p),W=await request(`folder/info/${R.folder_id}`),!W.ok){console.log(W.status);return}e(4,u=await W.json()),m(),e(2,c=!0),s.showModal()};function m(){!p.name.value||p.name.value==""?e(0,p.name.placeholder=u==null?void 0:u.name,p):e(0,p.name.placeholder=p.name.value,p)}async function g(){(await request(`share/${f}`,"put",{name:!p.name.value||p.name.value==""?p.name.placeholder:p.name.value,description:p.description,folder_id:u.id,...p.thumbnail&&{thumbnail:p.thumbnail},...p.expires.active&&{expires:new Date(p.expires.value).getTime()},...p.public.active&&{url:p.public.url.value},...p.public.protected.active?{password:p.public.protected.password}:{removepassword:!0},...p.withUsers&&{users:a.filter(W=>W.selected).map(W=>W.id)}})).ok&&(set_store_value(r,i={action:"updated",kind:"share",id:f},i),s.close())}async function h(){let N=await request("shares/randomurl");N.ok&&(e(0,p.public.url.value=await N.text(),p),e(0,p.public.url.check=!0,p))}async function v(){let N=!p.public.url.value||p.public.url.value==""?p.public.url.placeholder:encodeURIComponent(p.public.url.value),W=-1,R=!1;for(;!R;)R=(await request(`shares/checkurl/${N+(W>0?"-"+W:"")}`)).ok,W+=1;e(0,p.public.url.value=N+(W>0?"-"+W:""),p),e(0,p.public.url.check=!0,p)}function w(){e(2,c=!1),e(0,p={name:{value:void 0,placeholder:void 0},description:void 0,expires:{active:!1,value:timePickPresets(8).preset},public:{active:void 0,url:{value:void 0,placeholder:void 0,check:void 0},protected:{active:void 0,password:void 0,placeholder:void 0}},thumbnail:void 0,withUsers:void 0})}function k(){s.close()}let $;function T(){p.name.value=this.value,e(0,p)}function P(){p.description=this.value,e(0,p)}function E(){p.public.active=this.checked,e(0,p)}const x=()=>e(0,p.public.url.check=!1,p);function S(){p.public.url.value=this.value,e(0,p)}function M(){p.public.protected.active=this.checked,e(0,p)}function O(){p.public.protected.password=this.value,e(0,p)}function q(){p.withUsers=this.checked,e(0,p)}const F=(N,W,R)=>{N!=null&&N.selected?e(3,W[R].selected=!1,a):e(3,W[R].selected=!0,a),e(3,a=a.map(U=>U.id==N.id?N:U))};function A(){p.expires.active=this.checked,e(0,p)}function Z(){p.expires.value=this.value,e(0,p)}const I=()=>$({name:p.name.value,id:f});function D(N){binding_callbacks[N?"unshift":"push"](()=>{s=N,e(1,s)})}function X(N){$=N,e(6,$)}return o.$$.update=()=>{o.$$.dirty[0]&1&&(p.name.value,m())},[p,s,c,a,u,f,$,r,g,h,v,k,d,T,P,E,x,S,M,O,q,F,A,Z,I,D,X]}class EditShare extends SvelteComponent{constructor(t){super(),init(this,t,instance$i,create_fragment$i,safe_not_equal,{open:12},null,[-1,-1])}get open(){return this.$$.ctx[12]}}function get_each_context_1$3(o,t,e){const i=o.slice();return i[15]=t[e],i}function get_each_context$5(o,t,e){const i=o.slice();return i[15]=t[e],i}function create_if_block_7$2(o){let t;return{c(){t=text("S")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_1$9(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v,w,k,$,T,P,E,x,S,M,O,q,F,A,Z,I=[],D=new Map,X,N,W,R=o[2]=="name"&&create_if_block_6$2(o),U=o[2]=="timestamp"&&create_if_block_5$3(o);w=new Icons({props:{icon:"world"}});let z=o[2]=="url"&&create_if_block_4$3(o);E=new Icons({props:{icon:"key"}});let C=o[2]=="pw"&&create_if_block_3$4(o);q=new Icons({props:{icon:"users"}});let j=o[2]=="users"&&create_if_block_2$7(o),V=o[0];const H=G=>G[15];for(let G=0;G<V.length;G+=1){let ee=get_each_context_1$3(o,V,G),re=H(ee);D.set(re,I[G]=create_each_block_1$3(re,ee))}return{c(){t=element("table"),e=element("thead"),i=element("tr"),r=element("th"),s=space(),c=element("th"),a=element("div"),u=text("name "),R&&R.c(),f=space(),p=element("th"),d=element("div"),m=text("last modified "),U&&U.c(),g=space(),h=element("th"),v=element("div"),create_component(w.$$.fragment),k=space(),z&&z.c(),$=space(),T=element("th"),P=element("div"),create_component(E.$$.fragment),x=space(),C&&C.c(),S=space(),M=element("th"),O=element("div"),create_component(q.$$.fragment),F=space(),j&&j.c(),A=space(),Z=element("tbody");for(let G=0;G<I.length;G+=1)I[G].c();attr(a,"class","flex justify-start items-center"),attr(d,"class","flex justify-start items-center"),attr(v,"class","flex justify-start items-center"),attr(h,"class","hidden sm:table-cell"),attr(P,"class","flex justify-start items-center"),attr(T,"class","hidden sm:table-cell"),attr(O,"class","flex justify-start items-center"),attr(M,"class","hidden sm:table-cell"),attr(e,"class","sticky top-14 shadow-sm bg-base-100"),attr(t,"class","table cursor-pointer")},m(G,ee){insert(G,t,ee),append(t,e),append(e,i),append(i,r),append(i,s),append(i,c),append(c,a),append(a,u),R&&R.m(a,null),append(i,f),append(i,p),append(p,d),append(d,m),U&&U.m(d,null),append(i,g),append(i,h),append(h,v),mount_component(w,v,null),append(v,k),z&&z.m(v,null),append(i,$),append(i,T),append(T,P),mount_component(E,P,null),append(P,x),C&&C.m(P,null),append(i,S),append(i,M),append(M,O),mount_component(q,O,null),append(O,F),j&&j.m(O,null),append(t,A),append(t,Z);for(let re=0;re<I.length;re+=1)I[re]&&I[re].m(Z,null);X=!0,N||(W=[listen(c,"click",o[6]),listen(p,"click",o[8]),listen(h,"click",o[10]),listen(T,"click",o[12]),listen(M,"click",o[14])],N=!0)},p(G,ee){G[2]=="name"?R?(R.p(G,ee),ee&4&&transition_in(R,1)):(R=create_if_block_6$2(G),R.c(),transition_in(R,1),R.m(a,null)):R&&(group_outros(),transition_out(R,1,1,()=>{R=null}),check_outros()),G[2]=="timestamp"?U?(U.p(G,ee),ee&4&&transition_in(U,1)):(U=create_if_block_5$3(G),U.c(),transition_in(U,1),U.m(d,null)):U&&(group_outros(),transition_out(U,1,1,()=>{U=null}),check_outros()),G[2]=="url"?z?(z.p(G,ee),ee&4&&transition_in(z,1)):(z=create_if_block_4$3(G),z.c(),transition_in(z,1),z.m(v,null)):z&&(group_outros(),transition_out(z,1,1,()=>{z=null}),check_outros()),G[2]=="pw"?C?(C.p(G,ee),ee&4&&transition_in(C,1)):(C=create_if_block_3$4(G),C.c(),transition_in(C,1),C.m(P,null)):C&&(group_outros(),transition_out(C,1,1,()=>{C=null}),check_outros()),G[2]=="users"?j?(j.p(G,ee),ee&4&&transition_in(j,1)):(j=create_if_block_2$7(G),j.c(),transition_in(j,1),j.m(O,null)):j&&(group_outros(),transition_out(j,1,1,()=>{j=null}),check_outros()),ee&1&&(V=G[0],group_outros(),I=update_keyed_each(I,ee,H,1,G,V,D,Z,outro_and_destroy_block,create_each_block_1$3,null,get_each_context_1$3),check_outros())},i(G){if(!X){transition_in(R),transition_in(U),transition_in(w.$$.fragment,G),transition_in(z),transition_in(E.$$.fragment,G),transition_in(C),transition_in(q.$$.fragment,G),transition_in(j);for(let ee=0;ee<V.length;ee+=1)transition_in(I[ee]);X=!0}},o(G){transition_out(R),transition_out(U),transition_out(w.$$.fragment,G),transition_out(z),transition_out(E.$$.fragment,G),transition_out(C),transition_out(q.$$.fragment,G),transition_out(j);for(let ee=0;ee<I.length;ee+=1)transition_out(I[ee]);X=!1},d(G){G&&detach(t),R&&R.d(),U&&U.d(),destroy_component(w),z&&z.d(),destroy_component(E),C&&C.d(),destroy_component(q),j&&j.d();for(let ee=0;ee<I.length;ee+=1)I[ee].d();N=!1,run_all(W)}}}function create_if_block$d(o){let t,e=[],i=new Map,r,s=o[0];const c=a=>a[15];for(let a=0;a<s.length;a+=1){let u=get_each_context$5(o,s,a),f=c(u);i.set(f,e[a]=create_each_block$5(f,u))}return{c(){t=element("div");for(let a=0;a<e.length;a+=1)e[a].c();attr(t,"class","grid grid-cols-3 md:grid-cols-5 lg:grid-cols-7 xl:grid-cols-9 2xl:grid-cols-11 mb-12 mx-1")},m(a,u){insert(a,t,u);for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(t,null);r=!0},p(a,u){u&1&&(s=a[0],group_outros(),e=update_keyed_each(e,u,c,1,a,s,i,t,outro_and_destroy_block,create_each_block$5,null,get_each_context$5),check_outros())},i(a){if(!r){for(let u=0;u<s.length;u+=1)transition_in(e[u]);r=!0}},o(a){for(let u=0;u<e.length;u+=1)transition_out(e[u]);r=!1},d(a){a&&detach(t);for(let u=0;u<e.length;u+=1)e[u].d()}}}function create_if_block_6$2(o){let t,e,i,r;function s(a){o[5](a)}let c={iconon:"arrow_up",iconoff:"arrow_down",disabled:!0};return o[3]!==void 0&&(c.bind=o[3]),e=new SwapLogo({props:c}),binding_callbacks.push(()=>bind(e,"bind",s)),{c(){t=element("span"),create_component(e.$$.fragment),attr(t,"class","ml-2")},m(a,u){insert(a,t,u),mount_component(e,t,null),r=!0},p(a,u){const f={};!i&&u&8&&(i=!0,f.bind=a[3],add_flush_callback(()=>i=!1)),e.$set(f)},i(a){r||(transition_in(e.$$.fragment,a),r=!0)},o(a){transition_out(e.$$.fragment,a),r=!1},d(a){a&&detach(t),destroy_component(e)}}}function create_if_block_5$3(o){let t,e,i,r;function s(a){o[7](a)}let c={iconon:"arrow_up",iconoff:"arrow_down",disabled:!0};return o[3]!==void 0&&(c.bind=o[3]),e=new SwapLogo({props:c}),binding_callbacks.push(()=>bind(e,"bind",s)),{c(){t=element("span"),create_component(e.$$.fragment),attr(t,"class","ml-2")},m(a,u){insert(a,t,u),mount_component(e,t,null),r=!0},p(a,u){const f={};!i&&u&8&&(i=!0,f.bind=a[3],add_flush_callback(()=>i=!1)),e.$set(f)},i(a){r||(transition_in(e.$$.fragment,a),r=!0)},o(a){transition_out(e.$$.fragment,a),r=!1},d(a){a&&detach(t),destroy_component(e)}}}function create_if_block_4$3(o){let t,e,i,r;function s(a){o[9](a)}let c={iconon:"arrow_up",iconoff:"arrow_down",disabled:!0};return o[3]!==void 0&&(c.bind=o[3]),e=new SwapLogo({props:c}),binding_callbacks.push(()=>bind(e,"bind",s)),{c(){t=element("span"),create_component(e.$$.fragment),attr(t,"class","ml-2")},m(a,u){insert(a,t,u),mount_component(e,t,null),r=!0},p(a,u){const f={};!i&&u&8&&(i=!0,f.bind=a[3],add_flush_callback(()=>i=!1)),e.$set(f)},i(a){r||(transition_in(e.$$.fragment,a),r=!0)},o(a){transition_out(e.$$.fragment,a),r=!1},d(a){a&&detach(t),destroy_component(e)}}}function create_if_block_3$4(o){let t,e,i,r;function s(a){o[11](a)}let c={iconon:"arrow_up",iconoff:"arrow_down",disabled:!0};return o[3]!==void 0&&(c.bind=o[3]),e=new SwapLogo({props:c}),binding_callbacks.push(()=>bind(e,"bind",s)),{c(){t=element("span"),create_component(e.$$.fragment),attr(t,"class","ml-2")},m(a,u){insert(a,t,u),mount_component(e,t,null),r=!0},p(a,u){const f={};!i&&u&8&&(i=!0,f.bind=a[3],add_flush_callback(()=>i=!1)),e.$set(f)},i(a){r||(transition_in(e.$$.fragment,a),r=!0)},o(a){transition_out(e.$$.fragment,a),r=!1},d(a){a&&detach(t),destroy_component(e)}}}function create_if_block_2$7(o){let t,e,i,r;function s(a){o[13](a)}let c={iconon:"arrow_up",iconoff:"arrow_down",disabled:!0};return o[3]!==void 0&&(c.bind=o[3]),e=new SwapLogo({props:c}),binding_callbacks.push(()=>bind(e,"bind",s)),{c(){t=element("span"),create_component(e.$$.fragment),attr(t,"class","ml-2")},m(a,u){insert(a,t,u),mount_component(e,t,null),r=!0},p(a,u){const f={};!i&&u&8&&(i=!0,f.bind=a[3],add_flush_callback(()=>i=!1)),e.$set(f)},i(a){r||(transition_in(e.$$.fragment,a),r=!0)},o(a){transition_out(e.$$.fragment,a),r=!1},d(a){a&&detach(t),destroy_component(e)}}}function create_each_block_1$3(o,t){let e,i,r;return i=new Preview({props:{element:t[15],kind:"share",view:"list",shared:!1}}),{key:o,first:null,c(){e=empty(),create_component(i.$$.fragment),this.first=e},m(s,c){insert(s,e,c),mount_component(i,s,c),r=!0},p(s,c){t=s;const a={};c&1&&(a.element=t[15]),i.$set(a)},i(s){r||(transition_in(i.$$.fragment,s),r=!0)},o(s){transition_out(i.$$.fragment,s),r=!1},d(s){s&&detach(e),destroy_component(i,s)}}}function create_each_block$5(o,t){let e,i,r;return i=new Preview({props:{element:t[15],kind:"share",view:"grid",shared:!1}}),{key:o,first:null,c(){e=empty(),create_component(i.$$.fragment),this.first=e},m(s,c){insert(s,e,c),mount_component(i,s,c),r=!0},p(s,c){t=s;const a={};c&1&&(a.element=t[15]),i.$set(a)},i(s){r||(transition_in(i.$$.fragment,s),r=!0)},o(s){transition_out(i.$$.fragment,s),r=!1},d(s){s&&detach(e),destroy_component(i,s)}}}function create_fragment$h(o){let t,e=o[0].length+"",i,r,s,c,a,u,f,p=o[0].length>1&&create_if_block_7$2();const d=[create_if_block$d,create_if_block_1$9],m=[];function g(h,v){return h[1]=="grid"?0:h[1]=="list"?1:-1}return~(c=g(o))&&(a=m[c]=d[c](o)),{c(){t=element("div"),i=text(e),r=text(" SHARE"),p&&p.c(),s=space(),a&&a.c(),u=empty(),attr(t,"class","divider mx-2")},m(h,v){insert(h,t,v),append(t,i),append(t,r),p&&p.m(t,null),insert(h,s,v),~c&&m[c].m(h,v),insert(h,u,v),f=!0},p(h,[v]){(!f||v&1)&&e!==(e=h[0].length+"")&&set_data(i,e),h[0].length>1?p||(p=create_if_block_7$2(),p.c(),p.m(t,null)):p&&(p.d(1),p=null);let w=c;c=g(h),c===w?~c&&m[c].p(h,v):(a&&(group_outros(),transition_out(m[w],1,1,()=>{m[w]=null}),check_outros()),~c?(a=m[c],a?a.p(h,v):(a=m[c]=d[c](h),a.c()),transition_in(a,1),a.m(u.parentNode,u)):a=null)},i(h){f||(transition_in(a),f=!0)},o(h){transition_out(a),f=!1},d(h){h&&detach(t),p&&p.d(),h&&detach(s),~c&&m[c].d(h),h&&detach(u)}}}function instance$h(o,t,e){let{shares:i}=t,{view:r}=t,s,c=!0;function a($){$==s&&e(3,c=!c),e(2,s=$);let T=i;switch($){case"timestamp":T.sort((P,E)=>compare(P.timestamp,E.timestamp,c));break;case"name":T.sort((P,E)=>compare(P.name,E.name,c));break;case"url":T.sort((P,E)=>compare(P.url,E.url,c));break;case"pw":T.sort((P,E)=>compare(P.pw,E.pw,c));break;case"users":T.sort((P,E)=>compare(P.users.length,E.users.length,c));break}e(0,i=T)}function u($){c=$,e(3,c)}const f=()=>a("name");function p($){c=$,e(3,c)}const d=()=>a("timestamp");function m($){c=$,e(3,c)}const g=()=>a("url");function h($){c=$,e(3,c)}const v=()=>a("pw");function w($){c=$,e(3,c)}const k=()=>a("users");return o.$$set=$=>{"shares"in $&&e(0,i=$.shares),"view"in $&&e(1,r=$.view)},[i,r,s,c,a,u,f,p,d,m,g,h,v,w,k]}class MySharesGallery extends SvelteComponent{constructor(t){super(),init(this,t,instance$h,create_fragment$h,safe_not_equal,{shares:0,view:1})}}function get_each_context$4(o,t,e){const i=o.slice();return i[50]=t[e],i}function create_else_block$5(o){let t,e,i,r;const s=[create_if_block_1$8,create_if_block_2$6],c=[];function a(u,f){return u[5]?0:u[0]&&u[6]?1:-1}return~(t=a(o))&&(e=c[t]=s[t](o)),{c(){e&&e.c(),i=empty()},m(u,f){~t&&c[t].m(u,f),insert(u,i,f),r=!0},p(u,f){let p=t;t=a(u),t===p?~t&&c[t].p(u,f):(e&&(group_outros(),transition_out(c[p],1,1,()=>{c[p]=null}),check_outros()),~t?(e=c[t],e?e.p(u,f):(e=c[t]=s[t](u),e.c()),transition_in(e,1),e.m(i.parentNode,i)):e=null)},i(u){r||(transition_in(e),r=!0)},o(u){transition_out(e),r=!1},d(u){~t&&c[t].d(u),u&&detach(i)}}}function create_if_block$c(o){let t;return{c(){t=element("div"),t.innerHTML='<span class="loading loading-dots loading-lg"></span>',attr(t,"class","w-full h-96 flex justify-center items-center")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_if_block_2$6(o){let t,e,i,r,s,c,a,u,f,p,d,m;const g=[create_if_block_4$2,create_else_block_2$1],h=[];function v(S,M){return S[9].info?1:0}t=v(o),e=h[t]=g[t](o);const w=[create_if_block_3$3,create_else_block_1$2],k=[];function $(S,M){return S[9].content?1:0}r=$(o),s=k[r]=w[r](o);function T(S){o[37](S)}let P={};o[11]!==void 0&&(P.open=o[11]),a=new EditShare({props:P}),binding_callbacks.push(()=>bind(a,"open",T));function E(S){o[38](S)}let x={};return o[2]!==void 0&&(x.open=o[2]),p=new Download({props:x}),binding_callbacks.push(()=>bind(p,"open",E)),{c(){e.c(),i=space(),s.c(),c=space(),create_component(a.$$.fragment),f=space(),create_component(p.$$.fragment)},m(S,M){h[t].m(S,M),insert(S,i,M),k[r].m(S,M),insert(S,c,M),mount_component(a,S,M),insert(S,f,M),mount_component(p,S,M),m=!0},p(S,M){let O=t;t=v(S),t===O?h[t].p(S,M):(group_outros(),transition_out(h[O],1,1,()=>{h[O]=null}),check_outros(),e=h[t],e?e.p(S,M):(e=h[t]=g[t](S),e.c()),transition_in(e,1),e.m(i.parentNode,i));let q=r;r=$(S),r===q?k[r].p(S,M):(group_outros(),transition_out(k[q],1,1,()=>{k[q]=null}),check_outros(),s=k[r],s?s.p(S,M):(s=k[r]=w[r](S),s.c()),transition_in(s,1),s.m(c.parentNode,c));const F={};!u&&M[0]&2048&&(u=!0,F.open=S[11],add_flush_callback(()=>u=!1)),a.$set(F);const A={};!d&&M[0]&4&&(d=!0,A.open=S[2],add_flush_callback(()=>d=!1)),p.$set(A)},i(S){m||(transition_in(e),transition_in(s),transition_in(a.$$.fragment,S),transition_in(p.$$.fragment,S),m=!0)},o(S){transition_out(e),transition_out(s),transition_out(a.$$.fragment,S),transition_out(p.$$.fragment,S),m=!1},d(S){h[t].d(S),S&&detach(i),k[r].d(S),S&&detach(c),destroy_component(a,S),S&&detach(f),destroy_component(p,S)}}}function create_if_block_1$8(o){let t,e,i,r;function s(u){o[29](u)}function c(u){o[30](u)}let a={};return o[8]!==void 0&&(a.view=o[8]),o[5]!==void 0&&(a.shares=o[5]),t=new MySharesGallery({props:a}),binding_callbacks.push(()=>bind(t,"view",s)),binding_callbacks.push(()=>bind(t,"shares",c)),{c(){create_component(t.$$.fragment)},m(u,f){mount_component(t,u,f),r=!0},p(u,f){const p={};!e&&f[0]&256&&(e=!0,p.view=u[8],add_flush_callback(()=>e=!1)),!i&&f[0]&32&&(i=!0,p.shares=u[5],add_flush_callback(()=>i=!1)),t.$set(p)},i(u){r||(transition_in(t.$$.fragment,u),r=!0)},o(u){transition_out(t.$$.fragment,u),r=!1},d(u){destroy_component(t,u)}}}function create_else_block_2$1(o){let t,e,i,r,s,c,a,u=o[0].name+"",f,p,d,m,g,h,v,w,k,$,T,P=new Date(o[0].timestamp).toLocaleString()+"",E,x,S,M,O,q,F,A,Z,I,D,X,N,W,R,U,z,C;s=new Icons({props:{icon:"back",size:"3"}});let j=o[0].description&&create_if_block_10(o);w=new Icons({props:{icon:"edit"}});let V=o[0].expires&&create_if_block_9(o),H=o[0].url&&create_if_block_7$1(o),G=o[7]&&o[7].length>0&&create_if_block_6$1(o);const ee=[create_if_block_5$2,create_else_block_3],re=[];function ae(oe,le){return oe[4]?0:1}return N=ae(o),W=re[N]=ee[N](o),{c(){t=element("div"),e=element("div"),i=element("div"),r=element("button"),create_component(s.$$.fragment),c=space(),a=element("h2"),f=text(u),p=space(),j&&j.c(),d=space(),m=element("div"),g=element("div"),h=element("div"),v=element("h6"),create_component(w.$$.fragment),k=element("span"),k.textContent="last change:",$=space(),T=element("span"),E=text(P),x=space(),V&&V.c(),S=space(),H&&H.c(),M=space(),G&&G.c(),O=space(),q=element("div"),F=element("div"),A=element("input"),Z=space(),I=element("span"),I.textContent="manage excludes",X=space(),W.c(),attr(r,"class","btn btn-circle btn-sm btn-outline mr-5"),attr(a,"class","text-3xl font-bold"),attr(i,"class","flex justify-start items-center"),attr(e,"class","md:mr-5 card shadow-lg p-5 grow basis-1/2"),attr(k,"class","mx-2"),attr(v,"class","text-sm font-light flex"),attr(T,"class","text-sm"),attr(h,"class","flex justify-start items-center mt-5"),attr(g,"class","card shadow-lg p-5 flex-grow"),attr(A,"type","checkbox"),attr(A,"class","toggle mr-2"),attr(F,"class",D="flex justify-left items-center "+(o[4]?"":"opacity-50")),attr(q,"class",R="p-5 mt-2 flex justify-between items-center bg-neutral rounded-lg text-neutral-content shadow-lg "+(o[3]?"opacity-50 pointer-events-none":"")),attr(m,"class","shrink-0 grow md:flex md:flex-col md:justify-between"),attr(t,"class","w-full p-2 md:flex md:justify-center")},m(oe,le){insert(oe,t,le),append(t,e),append(e,i),append(i,r),mount_component(s,r,null),append(i,c),append(i,a),append(a,f),append(e,p),j&&j.m(e,null),append(t,d),append(t,m),append(m,g),append(g,h),append(h,v),mount_component(w,v,null),append(v,k),append(h,$),append(h,T),append(T,E),append(g,x),V&&V.m(g,null),append(g,S),H&&H.m(g,null),append(g,M),G&&G.m(g,null),append(m,O),append(m,q),append(q,F),append(F,A),A.checked=o[4],append(F,Z),append(F,I),append(q,X),re[N].m(q,null),U=!0,z||(C=[listen(r,"click",o[31]),listen(A,"change",o[32])],z=!0)},p(oe,le){(!U||le[0]&1)&&u!==(u=oe[0].name+"")&&set_data(f,u),oe[0].description?j?j.p(oe,le):(j=create_if_block_10(oe),j.c(),j.m(e,null)):j&&(j.d(1),j=null),(!U||le[0]&1)&&P!==(P=new Date(oe[0].timestamp).toLocaleString()+"")&&set_data(E,P),oe[0].expires?V?(V.p(oe,le),le[0]&1&&transition_in(V,1)):(V=create_if_block_9(oe),V.c(),transition_in(V,1),V.m(g,S)):V&&(group_outros(),transition_out(V,1,1,()=>{V=null}),check_outros()),oe[0].url?H?(H.p(oe,le),le[0]&1&&transition_in(H,1)):(H=create_if_block_7$1(oe),H.c(),transition_in(H,1),H.m(g,M)):H&&(group_outros(),transition_out(H,1,1,()=>{H=null}),check_outros()),oe[7]&&oe[7].length>0?G?(G.p(oe,le),le[0]&128&&transition_in(G,1)):(G=create_if_block_6$1(oe),G.c(),transition_in(G,1),G.m(g,null)):G&&(group_outros(),transition_out(G,1,1,()=>{G=null}),check_outros()),le[0]&16&&(A.checked=oe[4]),(!U||le[0]&16&&D!==(D="flex justify-left items-center "+(oe[4]?"":"opacity-50")))&&attr(F,"class",D);let fe=N;N=ae(oe),N===fe?re[N].p(oe,le):(group_outros(),transition_out(re[fe],1,1,()=>{re[fe]=null}),check_outros(),W=re[N],W?W.p(oe,le):(W=re[N]=ee[N](oe),W.c()),transition_in(W,1),W.m(q,null)),(!U||le[0]&8&&R!==(R="p-5 mt-2 flex justify-between items-center bg-neutral rounded-lg text-neutral-content shadow-lg "+(oe[3]?"opacity-50 pointer-events-none":"")))&&attr(q,"class",R)},i(oe){U||(transition_in(s.$$.fragment,oe),transition_in(w.$$.fragment,oe),transition_in(V),transition_in(H),transition_in(G),transition_in(W),U=!0)},o(oe){transition_out(s.$$.fragment,oe),transition_out(w.$$.fragment,oe),transition_out(V),transition_out(H),transition_out(G),transition_out(W),U=!1},d(oe){oe&&detach(t),destroy_component(s),j&&j.d(),destroy_component(w),V&&V.d(),H&&H.d(),G&&G.d(),re[N].d(),z=!1,run_all(C)}}}function create_if_block_4$2(o){let t;return{c(){t=element("div"),t.innerHTML='<span class="loading loading-dots loading-lg"></span>',attr(t,"class","w-full h-96 flex justify-center items-center")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_if_block_10(o){let t,e=o[0].description+"",i;return{c(){t=element("p"),i=text(e),attr(t,"class","my-5")},m(r,s){insert(r,t,s),append(t,i)},p(r,s){s[0]&1&&e!==(e=r[0].description+"")&&set_data(i,e)},d(r){r&&detach(t)}}}function create_if_block_9(o){let t,e,i,r,s,c,a=new Date(o[0].expires).toLocaleString()+"",u,f;return i=new Icons({props:{icon:"clock"}}),{c(){t=element("div"),e=element("h6"),create_component(i.$$.fragment),r=element("span"),r.textContent="expires:",s=space(),c=element("span"),u=text(a),attr(r,"class","mx-2"),attr(e,"class","text-sm font-light flex"),attr(c,"class","text-sm"),attr(t,"class","flex justify-start items-center mt-5")},m(p,d){insert(p,t,d),append(t,e),mount_component(i,e,null),append(e,r),append(t,s),append(t,c),append(c,u),f=!0},p(p,d){(!f||d[0]&1)&&a!==(a=new Date(p[0].expires).toLocaleString()+"")&&set_data(u,a)},i(p){f||(transition_in(i.$$.fragment,p),f=!0)},o(p){transition_out(i.$$.fragment,p),f=!1},d(p){p&&detach(t),destroy_component(i)}}}function create_if_block_7$1(o){let t,e,i,r,s,c,a,u=o[0].url+"",f,p,d;i=new Icons({props:{icon:"world"}});let m=o[0].pw&&create_if_block_8();return{c(){t=element("a"),e=element("h6"),create_component(i.$$.fragment),r=element("span"),r.textContent="public:",s=space(),m&&m.c(),c=space(),a=element("span"),f=text(u),attr(r,"class","mx-2"),attr(e,"class","text-sm font-light flex"),attr(a,"class","text-sm"),attr(t,"class","flex justify-start items-center mt-5"),attr(t,"href",p=window.location.origin+"/#/share/"+o[0].url)},m(g,h){insert(g,t,h),append(t,e),mount_component(i,e,null),append(e,r),append(t,s),m&&m.m(t,null),append(t,c),append(t,a),append(a,f),d=!0},p(g,h){g[0].pw?m?h[0]&1&&transition_in(m,1):(m=create_if_block_8(),m.c(),transition_in(m,1),m.m(t,c)):m&&(group_outros(),transition_out(m,1,1,()=>{m=null}),check_outros()),(!d||h[0]&1)&&u!==(u=g[0].url+"")&&set_data(f,u),(!d||h[0]&1&&p!==(p=window.location.origin+"/#/share/"+g[0].url))&&attr(t,"href",p)},i(g){d||(transition_in(i.$$.fragment,g),transition_in(m),d=!0)},o(g){transition_out(i.$$.fragment,g),transition_out(m),d=!1},d(g){g&&detach(t),destroy_component(i),m&&m.d()}}}function create_if_block_8(o){let t,e,i;return e=new Icons({props:{icon:"key"}}),{c(){t=element("span"),create_component(e.$$.fragment),attr(t,"class","mr-2")},m(r,s){insert(r,t,s),mount_component(e,t,null),i=!0},i(r){i||(transition_in(e.$$.fragment,r),i=!0)},o(r){transition_out(e.$$.fragment,r),i=!1},d(r){r&&detach(t),destroy_component(e)}}}function create_if_block_6$1(o){let t,e,i,r,s,c=[],a=new Map,u;e=new Icons({props:{icon:"users"}});let f=o[7];const p=d=>d[50];for(let d=0;d<f.length;d+=1){let m=get_each_context$4(o,f,d),g=p(m);a.set(g,c[d]=create_each_block$4(g,m))}return{c(){t=element("h6"),create_component(e.$$.fragment),i=element("span"),i.textContent="allowed users:",r=space(),s=element("ul");for(let d=0;d<c.length;d+=1)c[d].c();attr(i,"class","ml-2"),attr(t,"class","text-sm font-light mt-5 flex"),attr(s,"class","text-sm list-disc ml-6 mt-2")},m(d,m){insert(d,t,m),mount_component(e,t,null),append(t,i),insert(d,r,m),insert(d,s,m);for(let g=0;g<c.length;g+=1)c[g]&&c[g].m(s,null);u=!0},p(d,m){m[0]&128&&(f=d[7],c=update_keyed_each(c,m,p,1,d,f,a,s,destroy_block,create_each_block$4,null,get_each_context$4))},i(d){u||(transition_in(e.$$.fragment,d),u=!0)},o(d){transition_out(e.$$.fragment,d),u=!1},d(d){d&&detach(t),destroy_component(e),d&&detach(r),d&&detach(s);for(let m=0;m<c.length;m+=1)c[m].d()}}}function create_each_block$4(o,t){let e,i=t[50].name+"",r,s,c=t[50].full_name&&t[50].full_name?"("+t[50].full_name+")":"",a;return{key:o,first:null,c(){e=element("li"),r=text(i),s=space(),a=text(c),this.first=e},m(u,f){insert(u,e,f),append(e,r),append(e,s),append(e,a)},p(u,f){t=u,f[0]&128&&i!==(i=t[50].name+"")&&set_data(r,i),f[0]&128&&c!==(c=t[50].full_name&&t[50].full_name?"("+t[50].full_name+")":"")&&set_data(a,c)},d(u){u&&detach(e)}}}function create_else_block_3(o){let t,e,i,r,s,c;return e=new Icons({props:{icon:"edit"}}),{c(){t=element("button"),create_component(e.$$.fragment),i=text(`
                            edit`),attr(t,"class","btn ml-2 btn-outline text-neutral-content")},m(a,u){insert(a,t,u),mount_component(e,t,null),append(t,i),r=!0,s||(c=listen(t,"click",o[33]),s=!0)},p:noop,i(a){r||(transition_in(e.$$.fragment,a),r=!0)},o(a){transition_out(e.$$.fragment,a),r=!1},d(a){a&&detach(t),destroy_component(e),s=!1,c()}}}function create_if_block_5$2(o){let t,e,i,r,s,c,a,u,f,p,d,m,g;return i=new Icons({props:{icon:"check"}}),u=new Icons({props:{icon:"x"}}),{c(){t=element("div"),e=element("button"),create_component(i.$$.fragment),r=space(),s=element("span"),s.textContent="apply",c=space(),a=element("button"),create_component(u.$$.fragment),f=space(),p=element("span"),p.textContent="cancel",attr(s,"class","hidden md:inline"),attr(e,"class","btn ml-2 btn-outline text-neutral-content"),attr(p,"class","hidden md:inline"),attr(a,"class","btn ml-2 btn-outline text-neutral-content"),attr(t,"class","flex justify-left items-center")},m(h,v){insert(h,t,v),append(t,e),mount_component(i,e,null),append(e,r),append(e,s),append(t,c),append(t,a),mount_component(u,a,null),append(a,f),append(a,p),d=!0,m||(g=[listen(e,"click",o[22]),listen(a,"click",o[23])],m=!0)},p:noop,i(h){d||(transition_in(i.$$.fragment,h),transition_in(u.$$.fragment,h),d=!0)},o(h){transition_out(i.$$.fragment,h),transition_out(u.$$.fragment,h),d=!1},d(h){h&&detach(t),destroy_component(i),destroy_component(u),m=!1,run_all(g)}}}function create_else_block_1$2(o){let t,e,i,r,s,c,a,u,f,p,d,m;function g(T){o[34](T)}let h={};o[1]!==void 0&&(h.breadcrumbs=o[1]),i=new Breadcrumbs({props:h}),binding_callbacks.push(()=>bind(i,"breadcrumbs",g));function v(T){o[35](T)}let w={folders:o[6].folders};o[8]!==void 0&&(w.view=o[8]),c=new FoldersGallery({props:w}),binding_callbacks.push(()=>bind(c,"view",v));function k(T){o[36](T)}let $={files:o[6].files};return o[8]!==void 0&&($.view=o[8]),p=new FilesGallery({props:$}),binding_callbacks.push(()=>bind(p,"view",k)),{c(){t=element("div"),e=element("div"),create_component(i.$$.fragment),s=space(),create_component(c.$$.fragment),f=space(),create_component(p.$$.fragment),attr(e,"class",u=o[3]?"opacity-50 pointer-events-none":""),attr(t,"class","select-none")},m(T,P){insert(T,t,P),append(t,e),mount_component(i,e,null),append(e,s),mount_component(c,e,null),append(t,f),mount_component(p,t,null),m=!0},p(T,P){const E={};!r&&P[0]&2&&(r=!0,E.breadcrumbs=T[1],add_flush_callback(()=>r=!1)),i.$set(E);const x={};P[0]&64&&(x.folders=T[6].folders),!a&&P[0]&256&&(a=!0,x.view=T[8],add_flush_callback(()=>a=!1)),c.$set(x),(!m||P[0]&8&&u!==(u=T[3]?"opacity-50 pointer-events-none":""))&&attr(e,"class",u);const S={};P[0]&64&&(S.files=T[6].files),!d&&P[0]&256&&(d=!0,S.view=T[8],add_flush_callback(()=>d=!1)),p.$set(S)},i(T){m||(transition_in(i.$$.fragment,T),transition_in(c.$$.fragment,T),transition_in(p.$$.fragment,T),m=!0)},o(T){transition_out(i.$$.fragment,T),transition_out(c.$$.fragment,T),transition_out(p.$$.fragment,T),m=!1},d(T){T&&detach(t),destroy_component(i),destroy_component(c),destroy_component(p)}}}function create_if_block_3$3(o){let t;return{c(){t=element("div"),t.innerHTML='<span class="loading loading-dots loading-lg"></span>',attr(t,"class","w-full h-96 flex justify-center items-center")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_fragment$g(o){let t,e,i,r,s,c,a,u,f,p;const d=[create_if_block$c,create_else_block$5],m=[];function g(h,v){return!h[9].info&&!h[9].content?0:1}return e=g(o),i=m[e]=d[e](o),c=new Icons({props:{icon:"arrow_up",size:"7"}}),{c(){t=element("div"),i.c(),r=space(),s=element("button"),create_component(c.$$.fragment),attr(s,"class",a=`rounded-full w-14 h-14 bg-secondary text-secondary-content opacity-50 fixed right-5 bottom-5 flex items-center justify-center z-20 transform-gpu will-change-transform duration-500 ease-in-out active:scale-110 ${o[10]?"translate-y-0":"translate-y-24"}`),attr(t,"class","h-full overflow-x-hidden touch-pan-y")},m(h,v){insert(h,t,v),m[e].m(t,null),append(t,r),append(t,s),mount_component(c,s,null),u=!0,f||(p=listen(s,"click",scrollToTop$1),f=!0)},p(h,v){let w=e;e=g(h),e===w?m[e].p(h,v):(group_outros(),transition_out(m[w],1,1,()=>{m[w]=null}),check_outros(),i=m[e],i?i.p(h,v):(i=m[e]=d[e](h),i.c()),transition_in(i,1),i.m(t,r)),(!u||v[0]&1024&&a!==(a=`rounded-full w-14 h-14 bg-secondary text-secondary-content opacity-50 fixed right-5 bottom-5 flex items-center justify-center z-20 transform-gpu will-change-transform duration-500 ease-in-out active:scale-110 ${h[10]?"translate-y-0":"translate-y-24"}`))&&attr(s,"class",a)},i(h){u||(transition_in(i),transition_in(c.$$.fragment,h),u=!0)},o(h){transition_out(i),transition_out(c.$$.fragment,h),u=!1},d(h){h&&detach(t),m[e].d(),destroy_component(c),f=!1,p()}}}function scrollToTop$1(){window.scrollTo({top:0,behavior:"smooth"})}function instance$g(o,t,e){let i,r,s,c,a,u,f,p,d,m,{params:g={}}=t;const h=stores.options.listView;component_subscribe(o,h,J=>e(28,s=J));const v=stores.notify;component_subscribe(o,v,J=>e(27,r=J));const w=stores.options.editShare;component_subscribe(o,w,J=>e(42,d=J));const k=stores.options.excluded;component_subscribe(o,k,J=>e(4,a=J));const $=stores.options.download;component_subscribe(o,$,J=>e(41,p=J));const T=stores.options.downloadSelect;component_subscribe(o,T,J=>e(3,c=J));const P=stores.options.share;component_subscribe(o,P,J=>e(43,m=J));const E=stores.selected.files;component_subscribe(o,E,J=>e(26,i=J));const x=stores.selected.folders;component_subscribe(o,x,J=>e(39,u=J));const S=stores.options.changeView;component_subscribe(o,S,J=>e(40,f=J)),set_store_value(k,a=!1,a),set_store_value(P,m=!1,m);let M,O,q,F,A=[],Z=[],I="list",D={info:!1,content:!1};async function X(){let J=await request("shares");if(!J.ok){goToPage$1("login",!0);return}e(5,M=await J.json().then(Q=>Q==null?void 0:Q.my))}async function N(J,Q=!1){let he=await request(`share/index/${J}${Q?"/-/all":""}`);if(!he.ok){goToPage$1("login",!0);return}e(6,q=await he.json())}async function W(J,Q,he=!1){let _e=await request(`share/index/${J}/${Q}${he?"/all":""}`);if(!_e.ok){goToPage$1("login",!0);return}e(6,q=await _e.json())}async function R(J){let Q=await request("folder/info/"+J);if(Q.ok)return await Q.json().then(he=>he.name)}async function U(J){e(9,D.info=!1,D);let Q=await request(`share/info/${J}`);if(!Q.ok){goToPage$1("login",!0);return}e(0,O=await Q.json()),e(7,F=await Promise.all(O.users.map(async he=>{let _e=await request(`user?id=${he}`);if(!_e.ok){console.log(_e.status);return}let ne=await _e.json();return{id:he,name:ne.name,full_name:ne.full_name}}))),e(9,D.info=!0,D)}async function z(){if(e(9,D.content=!1,D),g.share){if(e(5,M=void 0),set_store_value(w,d=!0,d),(g==null?void 0:g.share)!=(O==null?void 0:O.id)&&await U(g.share),g.path){if(e(25,A=urlDecode(g.path)),!A){goToPage$1(`myshares/${g.share}`,!0);return}e(1,Z=await Promise.all(A.map(async J=>await R(J)))),await W(g.share,A[A.length-1],a)}else e(25,A=[]),e(1,Z=[]),await N(g.share,a);if(q.files.length<1?(set_store_value($,p=!1,p),set_store_value(T,c=!1,c)):set_store_value($,p=!0,p),a){set_store_value($,p=!1,p),set_store_value(T,c=!1,c),set_store_value(E,i=[],i);for(let J of q.files)J.excluded&&set_store_value(E,i=[...i,J.id],i);set_store_value(x,u=[],u);for(let J of q.folders)J.excluded&&set_store_value(x,u=[...u,J.id],u)}}else set_store_value(w,d=!1,d),set_store_value($,p=!1,p),set_store_value(T,c=!1,c),e(0,O=void 0),e(6,q=void 0),await X();set_store_value(S,f=!0,f),e(9,D.content=!0,D)}async function C(){(await request(`share/excludes/${O.id}`,"put",{files:i,folders:u})).ok&&j()}function j(){set_store_value(k,a=!1,a),set_store_value(E,i=[],i),set_store_value(x,u=[],u)}let V=!1;window.addEventListener("scroll",J=>{e(10,V=window.scrollY>100)});let H,G;function ee(J){I=J,e(8,I),e(28,s)}function re(J){M=J,e(5,M)}const ae=()=>goToPage$1("myshares");function oe(){a=this.checked,k.set(a)}const le=()=>H(O.id);function fe(J){Z=J,e(1,Z)}function me(J){I=J,e(8,I),e(28,s)}function de(J){I=J,e(8,I),e(28,s)}function ue(J){H=J,e(11,H)}function te(J){G=J,e(2,G)}return o.$$set=J=>{"params"in J&&e(24,g=J.params)},o.$$.update=()=>{o.$$.dirty[0]&16777216&&z(),o.$$.dirty[0]&16&&z(),o.$$.dirty[0]&8&&(c||set_store_value(E,i=[],i)),o.$$.dirty[0]&268435456&&e(8,I=s?"list":"grid"),o.$$.dirty[0]&251658247&&(()=>{if((r==null?void 0:r.action)=="clicked"&&(r==null?void 0:r.kind)=="share"){let J=r==null?void 0:r.element.id;set_store_value(v,r={},r),goToPage$1("myshares/"+J)}else if((r==null?void 0:r.kind)=="share"&&(r==null?void 0:r.action)=="updated"){let J=r.id;set_store_value(v,r={},r),U(J)}else if((r==null?void 0:r.kind)=="share"&&(r==null?void 0:r.action)=="deleted")set_store_value(v,r={},r),goToPage$1("myshares",!0);else if((r==null?void 0:r.kind)=="breadcrumb"){let J=r.index;set_store_value(v,r={},r),J==-1?goToPage$1("myshares/"+(g==null?void 0:g.share)):goToPage$1(`myshares/${g==null?void 0:g.share}/${urlEncode(A.slice(0,J+1))}`)}else if((r==null?void 0:r.kind)=="folder"&&(r==null?void 0:r.action)=="clicked"){let J=r.element.id;set_store_value(v,r={},r),goToPage$1(`myshares/${g==null?void 0:g.share}/${urlEncode([...A,J])}`)}else if((r==null?void 0:r.action)=="download"){let J=r==null?void 0:r.kind;set_store_value(v,r={},r),J=="all"?A.length<1?G({type:"share",share:O.id,name:O.name}):G({type:"folder",folder:A[A.length-1],name:Z[Z.length-1]}):J=="selected"&&G({type:"files",files:i,name:O.name})}})()},[O,Z,G,c,a,M,q,F,I,D,V,H,h,v,w,k,$,T,P,E,x,S,C,j,g,A,i,r,s,ee,re,ae,oe,le,fe,me,de,ue,te]}class MyShares extends SvelteComponent{constructor(t){super(),init(this,t,instance$g,create_fragment$g,safe_not_equal,{params:24},null,[-1,-1])}}function get_each_context_1$2(o,t,e){const i=o.slice();return i[11]=t[e],i}function get_each_context$3(o,t,e){const i=o.slice();return i[11]=t[e],i}function create_if_block_5$1(o){let t;return{c(){t=text("S")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_1$7(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v,w,k,$,T,P=[],E=new Map,x,S,M,O=o[2]=="name"&&create_if_block_4$1(o),q=o[2]=="timestamp"&&create_if_block_3$2(o);w=new Icons({props:{icon:"user"}});let F=o[2]=="user"&&create_if_block_2$5(o),A=o[0];const Z=I=>I[11];for(let I=0;I<A.length;I+=1){let D=get_each_context_1$2(o,A,I),X=Z(D);E.set(X,P[I]=create_each_block_1$2(X,D))}return{c(){t=element("table"),e=element("thead"),i=element("tr"),r=element("th"),s=space(),c=element("th"),a=element("div"),u=text("name "),O&&O.c(),f=space(),p=element("th"),d=element("div"),m=text("last modified "),q&&q.c(),g=space(),h=element("th"),v=element("div"),create_component(w.$$.fragment),k=space(),F&&F.c(),$=space(),T=element("tbody");for(let I=0;I<P.length;I+=1)P[I].c();attr(a,"class","flex justify-start items-center"),attr(d,"class","flex justify-start items-center"),attr(v,"class","flex justify-start items-center"),attr(h,"class","hidden sm:table-cell"),attr(e,"class","shadow-sm bg-base-100"),attr(t,"class","table cursor-pointer")},m(I,D){insert(I,t,D),append(t,e),append(e,i),append(i,r),append(i,s),append(i,c),append(c,a),append(a,u),O&&O.m(a,null),append(i,f),append(i,p),append(p,d),append(d,m),q&&q.m(d,null),append(i,g),append(i,h),append(h,v),mount_component(w,v,null),append(v,k),F&&F.m(v,null),append(t,$),append(t,T);for(let X=0;X<P.length;X+=1)P[X]&&P[X].m(T,null);x=!0,S||(M=[listen(c,"click",o[6]),listen(p,"click",o[8]),listen(h,"click",o[10])],S=!0)},p(I,D){I[2]=="name"?O?(O.p(I,D),D&4&&transition_in(O,1)):(O=create_if_block_4$1(I),O.c(),transition_in(O,1),O.m(a,null)):O&&(group_outros(),transition_out(O,1,1,()=>{O=null}),check_outros()),I[2]=="timestamp"?q?(q.p(I,D),D&4&&transition_in(q,1)):(q=create_if_block_3$2(I),q.c(),transition_in(q,1),q.m(d,null)):q&&(group_outros(),transition_out(q,1,1,()=>{q=null}),check_outros()),I[2]=="user"?F?(F.p(I,D),D&4&&transition_in(F,1)):(F=create_if_block_2$5(I),F.c(),transition_in(F,1),F.m(v,null)):F&&(group_outros(),transition_out(F,1,1,()=>{F=null}),check_outros()),D&1&&(A=I[0],group_outros(),P=update_keyed_each(P,D,Z,1,I,A,E,T,outro_and_destroy_block,create_each_block_1$2,null,get_each_context_1$2),check_outros())},i(I){if(!x){transition_in(O),transition_in(q),transition_in(w.$$.fragment,I),transition_in(F);for(let D=0;D<A.length;D+=1)transition_in(P[D]);x=!0}},o(I){transition_out(O),transition_out(q),transition_out(w.$$.fragment,I),transition_out(F);for(let D=0;D<P.length;D+=1)transition_out(P[D]);x=!1},d(I){I&&detach(t),O&&O.d(),q&&q.d(),destroy_component(w),F&&F.d();for(let D=0;D<P.length;D+=1)P[D].d();S=!1,run_all(M)}}}function create_if_block$b(o){let t,e=[],i=new Map,r,s=o[0];const c=a=>a[11];for(let a=0;a<s.length;a+=1){let u=get_each_context$3(o,s,a),f=c(u);i.set(f,e[a]=create_each_block$3(f,u))}return{c(){t=element("div");for(let a=0;a<e.length;a+=1)e[a].c();attr(t,"class","grid grid-cols-3 md:grid-cols-5 lg:grid-cols-7 xl:grid-cols-9 2xl:grid-cols-11 mb-12 mx-1")},m(a,u){insert(a,t,u);for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(t,null);r=!0},p(a,u){u&1&&(s=a[0],group_outros(),e=update_keyed_each(e,u,c,1,a,s,i,t,outro_and_destroy_block,create_each_block$3,null,get_each_context$3),check_outros())},i(a){if(!r){for(let u=0;u<s.length;u+=1)transition_in(e[u]);r=!0}},o(a){for(let u=0;u<e.length;u+=1)transition_out(e[u]);r=!1},d(a){a&&detach(t);for(let u=0;u<e.length;u+=1)e[u].d()}}}function create_if_block_4$1(o){let t,e,i,r;function s(a){o[5](a)}let c={iconon:"arrow_up",iconoff:"arrow_down",disabled:"true"};return o[3]!==void 0&&(c.bind=o[3]),e=new SwapLogo({props:c}),binding_callbacks.push(()=>bind(e,"bind",s)),{c(){t=element("span"),create_component(e.$$.fragment),attr(t,"class","ml-2")},m(a,u){insert(a,t,u),mount_component(e,t,null),r=!0},p(a,u){const f={};!i&&u&8&&(i=!0,f.bind=a[3],add_flush_callback(()=>i=!1)),e.$set(f)},i(a){r||(transition_in(e.$$.fragment,a),r=!0)},o(a){transition_out(e.$$.fragment,a),r=!1},d(a){a&&detach(t),destroy_component(e)}}}function create_if_block_3$2(o){let t,e,i,r;function s(a){o[7](a)}let c={iconon:"arrow_up",iconoff:"arrow_down",disabled:"true"};return o[3]!==void 0&&(c.bind=o[3]),e=new SwapLogo({props:c}),binding_callbacks.push(()=>bind(e,"bind",s)),{c(){t=element("span"),create_component(e.$$.fragment),attr(t,"class","ml-2")},m(a,u){insert(a,t,u),mount_component(e,t,null),r=!0},p(a,u){const f={};!i&&u&8&&(i=!0,f.bind=a[3],add_flush_callback(()=>i=!1)),e.$set(f)},i(a){r||(transition_in(e.$$.fragment,a),r=!0)},o(a){transition_out(e.$$.fragment,a),r=!1},d(a){a&&detach(t),destroy_component(e)}}}function create_if_block_2$5(o){let t,e,i,r;function s(a){o[9](a)}let c={iconon:"arrow_up",iconoff:"arrow_down",disabled:"true"};return o[3]!==void 0&&(c.bind=o[3]),e=new SwapLogo({props:c}),binding_callbacks.push(()=>bind(e,"bind",s)),{c(){t=element("span"),create_component(e.$$.fragment),attr(t,"class","ml-2")},m(a,u){insert(a,t,u),mount_component(e,t,null),r=!0},p(a,u){const f={};!i&&u&8&&(i=!0,f.bind=a[3],add_flush_callback(()=>i=!1)),e.$set(f)},i(a){r||(transition_in(e.$$.fragment,a),r=!0)},o(a){transition_out(e.$$.fragment,a),r=!1},d(a){a&&detach(t),destroy_component(e)}}}function create_each_block_1$2(o,t){let e,i,r;return i=new Preview({props:{element:t[11],kind:"share",view:"list",shared:"true"}}),{key:o,first:null,c(){e=empty(),create_component(i.$$.fragment),this.first=e},m(s,c){insert(s,e,c),mount_component(i,s,c),r=!0},p(s,c){t=s;const a={};c&1&&(a.element=t[11]),i.$set(a)},i(s){r||(transition_in(i.$$.fragment,s),r=!0)},o(s){transition_out(i.$$.fragment,s),r=!1},d(s){s&&detach(e),destroy_component(i,s)}}}function create_each_block$3(o,t){let e,i,r;return i=new Preview({props:{element:t[11],kind:"share",view:"grid"}}),{key:o,first:null,c(){e=empty(),create_component(i.$$.fragment),this.first=e},m(s,c){insert(s,e,c),mount_component(i,s,c),r=!0},p(s,c){t=s;const a={};c&1&&(a.element=t[11]),i.$set(a)},i(s){r||(transition_in(i.$$.fragment,s),r=!0)},o(s){transition_out(i.$$.fragment,s),r=!1},d(s){s&&detach(e),destroy_component(i,s)}}}function create_fragment$f(o){let t,e=o[0].length+"",i,r,s,c,a,u,f,p=o[0].length>1&&create_if_block_5$1();const d=[create_if_block$b,create_if_block_1$7],m=[];function g(h,v){return h[1]=="grid"?0:h[1]=="list"?1:-1}return~(c=g(o))&&(a=m[c]=d[c](o)),{c(){t=element("div"),i=text(e),r=text(" SHARE"),p&&p.c(),s=space(),a&&a.c(),u=empty(),attr(t,"class","divider mx-2")},m(h,v){insert(h,t,v),append(t,i),append(t,r),p&&p.m(t,null),insert(h,s,v),~c&&m[c].m(h,v),insert(h,u,v),f=!0},p(h,[v]){(!f||v&1)&&e!==(e=h[0].length+"")&&set_data(i,e),h[0].length>1?p||(p=create_if_block_5$1(),p.c(),p.m(t,null)):p&&(p.d(1),p=null);let w=c;c=g(h),c===w?~c&&m[c].p(h,v):(a&&(group_outros(),transition_out(m[w],1,1,()=>{m[w]=null}),check_outros()),~c?(a=m[c],a?a.p(h,v):(a=m[c]=d[c](h),a.c()),transition_in(a,1),a.m(u.parentNode,u)):a=null)},i(h){f||(transition_in(a),f=!0)},o(h){transition_out(a),f=!1},d(h){h&&detach(t),p&&p.d(),h&&detach(s),~c&&m[c].d(h),h&&detach(u)}}}function instance$f(o,t,e){let{shares:i}=t,{view:r}=t,s,c=!0;function a(h){h==s&&e(3,c=!c),e(2,s=h);let v=i;switch(h){case"timestamp":v.sort((w,k)=>compare(w.timestamp,k.timestamp,c));break;case"name":v.sort((w,k)=>compare(w.name,k.name,c));break;case"user":v.sort((w,k)=>compare(w.username,k.username,c));break}e(0,i=v)}function u(h){c=h,e(3,c)}const f=()=>a("name");function p(h){c=h,e(3,c)}const d=()=>a("timestamp");function m(h){c=h,e(3,c)}const g=()=>a("user");return o.$$set=h=>{"shares"in h&&e(0,i=h.shares),"view"in h&&e(1,r=h.view)},[i,r,s,c,a,u,f,p,d,m,g]}class SharedGallery extends SvelteComponent{constructor(t){super(),init(this,t,instance$f,create_fragment$f,safe_not_equal,{shares:0,view:1})}}function create_else_block$4(o){let t,e,i,r;const s=[create_if_block_1$6,create_if_block_2$4,create_if_block_7],c=[];function a(u,f){return u[4]?0:u[0]&&u[5]?1:u[8]?2:-1}return~(t=a(o))&&(e=c[t]=s[t](o)),{c(){e&&e.c(),i=empty()},m(u,f){~t&&c[t].m(u,f),insert(u,i,f),r=!0},p(u,f){let p=t;t=a(u),t===p?~t&&c[t].p(u,f):(e&&(group_outros(),transition_out(c[p],1,1,()=>{c[p]=null}),check_outros()),~t?(e=c[t],e?e.p(u,f):(e=c[t]=s[t](u),e.c()),transition_in(e,1),e.m(i.parentNode,i)):e=null)},i(u){r||(transition_in(e),r=!0)},o(u){transition_out(e),r=!1},d(u){~t&&c[t].d(u),u&&detach(i)}}}function create_if_block$a(o){let t;return{c(){t=element("div"),t.innerHTML='<span class="loading loading-dots loading-lg"></span>',attr(t,"class","w-full h-96 flex justify-center items-center")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_if_block_7(o){let t,e,i,r,s,c;return i=new Icons({props:{icon:"emoji_sad",size:"48"}}),{c(){t=element("div"),e=element("div"),create_component(i.$$.fragment),r=space(),s=element("span"),s.textContent="There are no shares for you.",attr(s,"class","mt-5 font-semibold text-lg"),attr(e,"class","card w-96 -2 h-48 shadow-xl bg-base-100 mt-32 p-5 flex items-center justify-center"),attr(t,"class","w-full flex justify-center")},m(a,u){insert(a,t,u),append(t,e),mount_component(i,e,null),append(e,r),append(e,s),c=!0},p:noop,i(a){c||(transition_in(i.$$.fragment,a),c=!0)},o(a){transition_out(i.$$.fragment,a),c=!1},d(a){a&&detach(t),destroy_component(i)}}}function create_if_block_2$4(o){let t,e,i,r,s,c,a,u,f;const p=[create_if_block_4,create_else_block_2],d=[];function m($,T){return $[7].info?1:0}t=m(o),e=d[t]=p[t](o);const g=[create_if_block_3$1,create_else_block_1$1],h=[];function v($,T){return $[7].content?1:0}r=v(o),s=h[r]=g[r](o);function w($){o[28]($)}let k={};return o[2]!==void 0&&(k.open=o[2]),a=new Download({props:k}),binding_callbacks.push(()=>bind(a,"open",w)),{c(){e.c(),i=space(),s.c(),c=space(),create_component(a.$$.fragment)},m($,T){d[t].m($,T),insert($,i,T),h[r].m($,T),insert($,c,T),mount_component(a,$,T),f=!0},p($,T){let P=t;t=m($),t===P?d[t].p($,T):(group_outros(),transition_out(d[P],1,1,()=>{d[P]=null}),check_outros(),e=d[t],e?e.p($,T):(e=d[t]=p[t]($),e.c()),transition_in(e,1),e.m(i.parentNode,i));let E=r;r=v($),r===E?h[r].p($,T):(group_outros(),transition_out(h[E],1,1,()=>{h[E]=null}),check_outros(),s=h[r],s?s.p($,T):(s=h[r]=g[r]($),s.c()),transition_in(s,1),s.m(c.parentNode,c));const x={};!u&&T[0]&4&&(u=!0,x.open=$[2],add_flush_callback(()=>u=!1)),a.$set(x)},i($){f||(transition_in(e),transition_in(s),transition_in(a.$$.fragment,$),f=!0)},o($){transition_out(e),transition_out(s),transition_out(a.$$.fragment,$),f=!1},d($){d[t].d($),$&&detach(i),h[r].d($),$&&detach(c),destroy_component(a,$)}}}function create_if_block_1$6(o){let t,e,i,r;function s(u){o[22](u)}function c(u){o[23](u)}let a={};return o[6]!==void 0&&(a.view=o[6]),o[4]!==void 0&&(a.shares=o[4]),t=new SharedGallery({props:a}),binding_callbacks.push(()=>bind(t,"view",s)),binding_callbacks.push(()=>bind(t,"shares",c)),{c(){create_component(t.$$.fragment)},m(u,f){mount_component(t,u,f),r=!0},p(u,f){const p={};!e&&f[0]&64&&(e=!0,p.view=u[6],add_flush_callback(()=>e=!1)),!i&&f[0]&16&&(i=!0,p.shares=u[4],add_flush_callback(()=>i=!1)),t.$set(p)},i(u){r||(transition_in(t.$$.fragment,u),r=!0)},o(u){transition_out(t.$$.fragment,u),r=!1},d(u){destroy_component(t,u)}}}function create_else_block_2(o){let t,e,i,r,s,c,a,u=o[0].name+"",f,p,d,m,g,h,v,w,k,$,T,P=o[0].username+"",E,x,S,M,O,q,F,A,Z=new Date(o[0].timestamp).toLocaleString()+"",I,D,X,N,W;s=new Icons({props:{icon:"back",size:"3"}});let R=o[0].description&&create_if_block_6(o);w=new Icons({props:{icon:"share"}}),O=new Icons({props:{icon:"edit"}});let U=o[0].expires&&create_if_block_5(o);return{c(){t=element("div"),e=element("div"),i=element("div"),r=element("button"),create_component(s.$$.fragment),c=space(),a=element("h2"),f=text(u),p=space(),R&&R.c(),d=space(),m=element("div"),g=element("div"),h=element("div"),v=element("h6"),create_component(w.$$.fragment),k=element("span"),k.textContent="shared by:",$=space(),T=element("span"),E=text(P),x=space(),S=element("div"),M=element("h6"),create_component(O.$$.fragment),q=element("span"),q.textContent="last change:",F=space(),A=element("span"),I=text(Z),D=space(),U&&U.c(),attr(r,"class","btn btn-circle btn-sm btn-outline mr-5"),attr(a,"class","text-3xl font-bold"),attr(i,"class","flex justify-start items-center"),attr(e,"class","md:mr-5 card shadow-lg p-5 w-full md:max-w-xl"),attr(k,"class","mx-2"),attr(v,"class","text-sm font-light flex"),attr(T,"class","text-sm"),attr(h,"class","flex justify-start items-center mt-5"),attr(q,"class","mx-2"),attr(M,"class","text-sm font-light flex"),attr(A,"class","text-sm"),attr(S,"class","flex justify-start items-center mt-5"),attr(g,"class","card shadow-lg p-5 flex-grow"),attr(m,"class","shrink-0 md:flex md:flex-col md:justify-between"),attr(t,"class","w-full p-2 md:flex md:justify-center")},m(z,C){insert(z,t,C),append(t,e),append(e,i),append(i,r),mount_component(s,r,null),append(i,c),append(i,a),append(a,f),append(e,p),R&&R.m(e,null),append(t,d),append(t,m),append(m,g),append(g,h),append(h,v),mount_component(w,v,null),append(v,k),append(h,$),append(h,T),append(T,E),append(g,x),append(g,S),append(S,M),mount_component(O,M,null),append(M,q),append(S,F),append(S,A),append(A,I),append(g,D),U&&U.m(g,null),X=!0,N||(W=listen(r,"click",o[24]),N=!0)},p(z,C){(!X||C[0]&1)&&u!==(u=z[0].name+"")&&set_data(f,u),z[0].description?R?R.p(z,C):(R=create_if_block_6(z),R.c(),R.m(e,null)):R&&(R.d(1),R=null),(!X||C[0]&1)&&P!==(P=z[0].username+"")&&set_data(E,P),(!X||C[0]&1)&&Z!==(Z=new Date(z[0].timestamp).toLocaleString()+"")&&set_data(I,Z),z[0].expires?U?(U.p(z,C),C[0]&1&&transition_in(U,1)):(U=create_if_block_5(z),U.c(),transition_in(U,1),U.m(g,null)):U&&(group_outros(),transition_out(U,1,1,()=>{U=null}),check_outros())},i(z){X||(transition_in(s.$$.fragment,z),transition_in(w.$$.fragment,z),transition_in(O.$$.fragment,z),transition_in(U),X=!0)},o(z){transition_out(s.$$.fragment,z),transition_out(w.$$.fragment,z),transition_out(O.$$.fragment,z),transition_out(U),X=!1},d(z){z&&detach(t),destroy_component(s),R&&R.d(),destroy_component(w),destroy_component(O),U&&U.d(),N=!1,W()}}}function create_if_block_4(o){let t;return{c(){t=element("div"),t.innerHTML='<span class="loading loading-dots loading-lg"></span>',attr(t,"class","w-full h-96 flex justify-center items-center")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_if_block_6(o){let t,e=o[0].description+"",i;return{c(){t=element("p"),i=text(e),attr(t,"class","my-5")},m(r,s){insert(r,t,s),append(t,i)},p(r,s){s[0]&1&&e!==(e=r[0].description+"")&&set_data(i,e)},d(r){r&&detach(t)}}}function create_if_block_5(o){let t,e,i,r,s,c,a=new Date(o[0].expires).toLocaleString()+"",u,f;return i=new Icons({props:{icon:"clock"}}),{c(){t=element("div"),e=element("h6"),create_component(i.$$.fragment),r=element("span"),r.textContent="expires:",s=space(),c=element("span"),u=text(a),attr(r,"class","mx-2"),attr(e,"class","text-sm font-light flex"),attr(c,"class","text-sm"),attr(t,"class","flex justify-start items-center mt-5")},m(p,d){insert(p,t,d),append(t,e),mount_component(i,e,null),append(e,r),append(t,s),append(t,c),append(c,u),f=!0},p(p,d){(!f||d[0]&1)&&a!==(a=new Date(p[0].expires).toLocaleString()+"")&&set_data(u,a)},i(p){f||(transition_in(i.$$.fragment,p),f=!0)},o(p){transition_out(i.$$.fragment,p),f=!1},d(p){p&&detach(t),destroy_component(i)}}}function create_else_block_1$1(o){let t,e,i,r,s,c,a,u,f,p,d,m,g;function h(P){o[25](P)}let v={};o[1]!==void 0&&(v.breadcrumbs=o[1]),r=new Breadcrumbs({props:v}),binding_callbacks.push(()=>bind(r,"breadcrumbs",h));function w(P){o[26](P)}let k={folders:o[5].folders};o[6]!==void 0&&(k.view=o[6]),a=new FoldersGallery({props:k}),binding_callbacks.push(()=>bind(a,"view",w));function $(P){o[27](P)}let T={files:o[5].files};return o[6]!==void 0&&(T.view=o[6]),d=new FilesGallery({props:T}),binding_callbacks.push(()=>bind(d,"view",$)),{c(){t=element("div"),e=element("div"),i=element("div"),create_component(r.$$.fragment),c=space(),create_component(a.$$.fragment),p=space(),create_component(d.$$.fragment),attr(i,"class","md mt-5"),attr(e,"class",f=o[3]?"opacity-50 pointer-events-none":""),attr(t,"class","select-none")},m(P,E){insert(P,t,E),append(t,e),append(e,i),mount_component(r,i,null),append(e,c),mount_component(a,e,null),append(t,p),mount_component(d,t,null),g=!0},p(P,E){const x={};!s&&E[0]&2&&(s=!0,x.breadcrumbs=P[1],add_flush_callback(()=>s=!1)),r.$set(x);const S={};E[0]&32&&(S.folders=P[5].folders),!u&&E[0]&64&&(u=!0,S.view=P[6],add_flush_callback(()=>u=!1)),a.$set(S),(!g||E[0]&8&&f!==(f=P[3]?"opacity-50 pointer-events-none":""))&&attr(e,"class",f);const M={};E[0]&32&&(M.files=P[5].files),!m&&E[0]&64&&(m=!0,M.view=P[6],add_flush_callback(()=>m=!1)),d.$set(M)},i(P){g||(transition_in(r.$$.fragment,P),transition_in(a.$$.fragment,P),transition_in(d.$$.fragment,P),g=!0)},o(P){transition_out(r.$$.fragment,P),transition_out(a.$$.fragment,P),transition_out(d.$$.fragment,P),g=!1},d(P){P&&detach(t),destroy_component(r),destroy_component(a),destroy_component(d)}}}function create_if_block_3$1(o){let t;return{c(){t=element("div"),t.innerHTML='<span class="loading loading-dots loading-lg"></span>',attr(t,"class","w-full h-96 flex justify-center items-center")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_fragment$e(o){let t,e,i,r,s,c,a,u,f,p;const d=[create_if_block$a,create_else_block$4],m=[];function g(h,v){return!h[7].info&&!h[7].content?0:1}return e=g(o),i=m[e]=d[e](o),c=new Icons({props:{icon:"arrow_up",size:"7"}}),{c(){t=element("div"),i.c(),r=space(),s=element("button"),create_component(c.$$.fragment),attr(s,"class",a=`rounded-full w-14 h-14 bg-secondary text-secondary-content opacity-50 fixed right-5 bottom-5 flex items-center justify-center z-20 transform-gpu will-change-transform duration-500 ease-in-out active:scale-110 ${o[9]?"translate-y-0":"translate-y-24"}`),attr(t,"class","h-full overflow-x-hidden touch-pan-y")},m(h,v){insert(h,t,v),m[e].m(t,null),append(t,r),append(t,s),mount_component(c,s,null),u=!0,f||(p=listen(s,"click",scrollToTop),f=!0)},p(h,v){let w=e;e=g(h),e===w?m[e].p(h,v):(group_outros(),transition_out(m[w],1,1,()=>{m[w]=null}),check_outros(),i=m[e],i?i.p(h,v):(i=m[e]=d[e](h),i.c()),transition_in(i,1),i.m(t,r)),(!u||v[0]&512&&a!==(a=`rounded-full w-14 h-14 bg-secondary text-secondary-content opacity-50 fixed right-5 bottom-5 flex items-center justify-center z-20 transform-gpu will-change-transform duration-500 ease-in-out active:scale-110 ${h[9]?"translate-y-0":"translate-y-24"}`))&&attr(s,"class",a)},i(h){u||(transition_in(i),transition_in(c.$$.fragment,h),u=!0)},o(h){transition_out(i),transition_out(c.$$.fragment,h),u=!1},d(h){h&&detach(t),m[e].d(),destroy_component(c),f=!1,p()}}}function scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}function instance$e(o,t,e){let i,r,s,c,a,u,f,{params:p={}}=t;const d=stores.options.listView;component_subscribe(o,d,H=>e(21,c=H));const m=stores.notify;component_subscribe(o,m,H=>e(20,r=H));const g=stores.options.download;component_subscribe(o,g,H=>e(30,u=H));const h=stores.options.downloadSelect;component_subscribe(o,h,H=>e(3,s=H));const v=stores.options.share;component_subscribe(o,v,H=>e(31,f=H));const w=stores.selected.files;component_subscribe(o,w,H=>e(19,i=H));const k=stores.options.changeView;component_subscribe(o,k,H=>e(29,a=H)),set_store_value(v,f=!1,f);let $,T,P,E=[],x=[],S="list",M={info:!1,content:!1},O=!1;async function q(){let H=await request("shares");if(!H.ok){goToPage$1("login",!0);return}e(4,$=await H.json().then(G=>G==null?void 0:G.shared)),$.length<1?(e(4,$=void 0),e(8,O=!0)):e(8,O=!1)}async function F(H){let G=await request(`share/index/${H}`);if(!G.ok){goToPage$1("login",!0);return}e(5,P=await G.json())}async function A(H,G){let ee=await request(`share/index/${H}/${G}`);if(!ee.ok){goToPage$1("login",!0);return}e(5,P=await ee.json())}async function Z(H){let G=await request("folder/info/"+H);if(G.ok)return await G.json().then(ee=>ee.name)}async function I(H){e(7,M.info=!1,M);let G=await request(`share/info/${H}`);if(!G.ok){goToPage$1("login",!0);return}e(0,T=await G.json()),e(7,M.info=!0,M)}async function D(){if(e(7,M.content=!1,M),p.share){if(e(4,$=void 0),(p==null?void 0:p.share)!=(T==null?void 0:T.id)&&await I(p.share),p.path){if(e(18,E=urlDecode(p.path)),!E){goToPage$1(`shared/${p.share}`,!0);return}e(1,x=await Promise.all(E.map(async H=>await Z(H)))),await A(p.share,E[E.length-1])}else e(18,E=[]),e(1,x=[]),await F(p.share);P.files.length<1?(set_store_value(g,u=!1,u),set_store_value(h,s=!1,s)):set_store_value(g,u=!0,u)}else e(0,T=void 0),e(5,P=void 0),await q(),set_store_value(g,u=!1,u),set_store_value(h,s=!1,s);$&&$.length>0||T&&(P.files.length>0||P.folders.length>0)?set_store_value(k,a=!0,a):set_store_value(k,a=!1,a),e(7,M.content=!0,M)}let X=!1;window.addEventListener("scroll",H=>{e(9,X=window.scrollY>100)});let N;function W(H){S=H,e(6,S),e(21,c)}function R(H){$=H,e(4,$)}const U=()=>goToPage$1("shared");function z(H){x=H,e(1,x)}function C(H){S=H,e(6,S),e(21,c)}function j(H){S=H,e(6,S),e(21,c)}function V(H){N=H,e(2,N)}return o.$$set=H=>{"params"in H&&e(17,p=H.params)},o.$$.update=()=>{o.$$.dirty[0]&131072&&D(),o.$$.dirty[0]&2097152&&e(6,S=c?"list":"grid"),o.$$.dirty[0]&8&&(s||set_store_value(w,i=[],i)),o.$$.dirty[0]&1966087&&(()=>{if((r==null?void 0:r.action)=="clicked"&&(r==null?void 0:r.kind)=="share"){let H=r==null?void 0:r.element.id;set_store_value(m,r={},r),goToPage$1("shared/"+H)}else if((r==null?void 0:r.kind)=="breadcrumb"){let H=r.index;set_store_value(m,r={},r),H==-1?goToPage$1("shared/"+(p==null?void 0:p.share)):goToPage$1(`shared/${p==null?void 0:p.share}/${urlEncode(E.slice(0,H+1))}`)}else if((r==null?void 0:r.kind)=="folder"){let H=r.element.id;set_store_value(m,r={},r),goToPage$1(`shared/${p==null?void 0:p.share}/${urlEncode([...E,H])}`)}else if((r==null?void 0:r.action)=="download"){let H=r==null?void 0:r.kind;set_store_value(m,r={},r),H=="all"?E.length<1?N({type:"share",share:T.id,name:T.name}):N({type:"folder",folder:E[E.length-1],name:x[x.length-1]}):H=="selected"&&N({type:"files",files:i,name:T.name})}})()},[T,x,N,s,$,P,S,M,O,X,d,m,g,h,v,w,k,p,E,i,r,c,W,R,U,z,C,j,V]}class Shared extends SvelteComponent{constructor(t){super(),init(this,t,instance$e,create_fragment$e,safe_not_equal,{params:17},null,[-1,-1])}}function create_if_block$9(o){let t;return{c(){t=element("div"),t.innerHTML="<span>wrong credentials</span>",attr(t,"class","alert alert-error mt-2")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_fragment$d(o){let t,e,i,r,s,c,a,u,f,p,d,m,g=o[0]&&create_if_block$9();return{c(){t=element("div"),e=element("div"),i=element("h1"),i.textContent="Login",r=space(),s=element("input"),c=space(),a=element("input"),u=space(),g&&g.c(),f=space(),p=element("button"),p.textContent="Login",attr(i,"class","font-medium text-2xl text-center py-6"),attr(s,"type","text"),attr(s,"name","username"),attr(s,"placeholder","username"),attr(s,"autocomplete","off"),s.autofocus=!0,attr(s,"class","input w-full font-mono"),attr(a,"type","password"),attr(a,"placeholder","password"),attr(a,"name","password"),attr(a,"autocomplete","off"),attr(a,"class","input w-full mt-2"),attr(p,"class","btn btn-neutral mt-6 w-full"),attr(e,"class","card w-96 m-5 mt-16 md:mt-32 shadow-xl p-6 bg-base-200"),attr(t,"class","flex w-full justify-center")},m(h,v){insert(h,t,v),append(t,e),append(e,i),append(e,r),append(e,s),set_input_value(s,o[1]),append(e,c),append(e,a),set_input_value(a,o[2]),append(e,u),g&&g.m(e,null),append(e,f),append(e,p),s.focus(),d||(m=[listen(s,"input",o[7]),listen(a,"input",o[8]),listen(p,"click",o[5]),listen(e,"keydown",o[6])],d=!0)},p(h,[v]){v&2&&s.value!==h[1]&&set_input_value(s,h[1]),v&4&&a.value!==h[2]&&set_input_value(a,h[2]),h[0]?g||(g=create_if_block$9(),g.c(),g.m(e,f)):g&&(g.d(1),g=null)},i:noop,o:noop,d(h){h&&detach(t),g&&g.d(),d=!1,run_all(m)}}}function instance$d(o,t,e){let i,r;const s=stores.options.download;component_subscribe(o,s,h=>e(10,r=h)),set_store_value(s,r=!1,r);const c=stores.options.changeView;component_subscribe(o,c,h=>e(9,i=h)),set_store_value(c,i=!1,i);var a=!1;let u="",f="";function p(){request("user/login","post",{name:u,password:f}).then(async h=>{if(!h.ok){e(0,a=!0);return}goToPage$1("",!0),e(0,a=!1)})}function d(h){h.keyCode==13&&p()}function m(){u=this.value,e(1,u)}function g(){f=this.value,e(2,f)}return[a,u,f,s,c,p,d,m,g]}class UserLogin extends SvelteComponent{constructor(t){super(),init(this,t,instance$d,create_fragment$d,safe_not_equal,{})}}function create_else_block_1(o){let t,e,i;return{c(){t=element("input"),t.disabled=o[3],attr(t,"type","text"),attr(t,"autocomplete","off"),attr(t,"class","input w-full input-bordered"),attr(t,"name","field")},m(r,s){insert(r,t,s),set_input_value(t,o[0]),e||(i=listen(t,"input",o[10]),e=!0)},p(r,s){s&8&&(t.disabled=r[3]),s&1&&t.value!==r[0]&&set_input_value(t,r[0])},d(r){r&&detach(t),e=!1,i()}}}function create_if_block_1$5(o){let t,e,i;return{c(){t=element("input"),t.disabled=o[3],attr(t,"type","password"),attr(t,"autocomplete","off"),attr(t,"class","input w-full input-bordered"),attr(t,"name","field")},m(r,s){insert(r,t,s),set_input_value(t,o[0]),e||(i=listen(t,"input",o[9]),e=!0)},p(r,s){s&8&&(t.disabled=r[3]),s&1&&t.value!==r[0]&&set_input_value(t,r[0])},d(r){r&&detach(t),e=!1,i()}}}function create_else_block$3(o){let t,e,i,r,s,c,a,u;return e=new Icons({props:{icon:"check"}}),s=new Icons({props:{icon:"x"}}),{c(){t=element("button"),create_component(e.$$.fragment),i=space(),r=element("button"),create_component(s.$$.fragment),attr(t,"class","btn btn-neutral ml-2"),attr(r,"class","btn ml-2")},m(f,p){insert(f,t,p),mount_component(e,t,null),insert(f,i,p),insert(f,r,p),mount_component(s,r,null),c=!0,a||(u=[listen(t,"click",o[5]),listen(r,"click",o[4])],a=!0)},p:noop,i(f){c||(transition_in(e.$$.fragment,f),transition_in(s.$$.fragment,f),c=!0)},o(f){transition_out(e.$$.fragment,f),transition_out(s.$$.fragment,f),c=!1},d(f){f&&detach(t),destroy_component(e),f&&detach(i),f&&detach(r),destroy_component(s),a=!1,run_all(u)}}}function create_if_block$8(o){let t,e,i,r,s,c;return e=new Icons({props:{icon:"edit"}}),{c(){t=element("button"),create_component(e.$$.fragment),i=text(`
            edit`),attr(t,"class","btn ml-2")},m(a,u){insert(a,t,u),mount_component(e,t,null),append(t,i),r=!0,s||(c=listen(t,"click",o[11]),s=!0)},p:noop,i(a){r||(transition_in(e.$$.fragment,a),r=!0)},o(a){transition_out(e.$$.fragment,a),r=!1},d(a){a&&detach(t),destroy_component(e),s=!1,c()}}}function create_fragment$c(o){let t,e,i,r,s,c,a,u,f,p;function d(k,$){return k[2]=="true"?create_if_block_1$5:create_else_block_1}let m=d(o),g=m(o);const h=[create_if_block$8,create_else_block$3],v=[];function w(k,$){return k[3]?0:1}return c=w(o),a=v[c]=h[c](o),{c(){t=element("label"),e=text(o[1]),i=space(),r=element("div"),g.c(),s=space(),a.c(),attr(t,"class","font-medium block mb-1 ml-1 mt-2"),attr(t,"for","field"),attr(r,"class","flex")},m(k,$){insert(k,t,$),append(t,e),insert(k,i,$),insert(k,r,$),g.m(r,null),append(r,s),v[c].m(r,null),u=!0,f||(p=listen(r,"keydown",o[6]),f=!0)},p(k,[$]){(!u||$&2)&&set_data(e,k[1]),m===(m=d(k))&&g?g.p(k,$):(g.d(1),g=m(k),g&&(g.c(),g.m(r,s)));let T=c;c=w(k),c===T?v[c].p(k,$):(group_outros(),transition_out(v[T],1,1,()=>{v[T]=null}),check_outros(),a=v[c],a?a.p(k,$):(a=v[c]=h[c](k),a.c()),transition_in(a,1),a.m(r,null))},i(k){u||(transition_in(a),u=!0)},o(k){transition_out(a),u=!1},d(k){k&&detach(t),k&&detach(i),k&&detach(r),g.d(),v[c].d(),f=!1,p()}}}function instance$c(o,t,e){let{name:i}=t,{value:r}=t,{apply:s}=t,{update:c}=t,{pw:a="false"}=t;var u="",f=!0;function p(){u=r}function d(){e(3,f=!0),e(0,r=u)}async function m(){e(3,f=!0),u=r,await s(r),c()}function g(k){switch(k.keyCode){case 13:m();break;case 27:d();break}}function h(){r=this.value,e(0,r)}function v(){r=this.value,e(0,r)}const w=()=>{e(3,f=!1)};return o.$$set=k=>{"name"in k&&e(1,i=k.name),"value"in k&&e(0,r=k.value),"apply"in k&&e(7,s=k.apply),"update"in k&&e(8,c=k.update),"pw"in k&&e(2,a=k.pw)},o.$$.update=()=>{o.$$.dirty&1&&r&&p()},[r,i,a,f,d,m,g,s,c,h,v,w]}class EditValue extends SvelteComponent{constructor(t){super(),init(this,t,instance$c,create_fragment$c,safe_not_equal,{name:1,value:0,apply:7,update:8,pw:2})}}function create_if_block$7(o){let t,e,i;return e=new Icons({props:{icon:o[1]}}),{c(){t=element("div"),create_component(e.$$.fragment),attr(t,"class","mr-2")},m(r,s){insert(r,t,s),mount_component(e,t,null),i=!0},p(r,s){const c={};s&2&&(c.icon=r[1]),e.$set(c)},i(r){i||(transition_in(e.$$.fragment,r),i=!0)},o(r){transition_out(e.$$.fragment,r),i=!1},d(r){r&&detach(t),destroy_component(e)}}}function create_fragment$b(o){let t,e,i,r,s,c,a,u=o[1]!=""&&create_if_block$7(o);const f=o[3].default,p=create_slot(f,o,o[2],null);return{c(){t=element("div"),e=element("div"),u&&u.c(),i=space(),r=element("h1"),s=text(o[0]),c=space(),p&&p.c(),attr(r,"class","text-2xl font-bold"),attr(e,"class","text-2xl font-bold text-center w-full mb-5 flex justify-center items-center"),attr(t,"class","card bg-base-100 shadow-xl p-5 mb-12")},m(d,m){insert(d,t,m),append(t,e),u&&u.m(e,null),append(e,i),append(e,r),append(r,s),append(t,c),p&&p.m(t,null),a=!0},p(d,[m]){d[1]!=""?u?(u.p(d,m),m&2&&transition_in(u,1)):(u=create_if_block$7(d),u.c(),transition_in(u,1),u.m(e,i)):u&&(group_outros(),transition_out(u,1,1,()=>{u=null}),check_outros()),(!a||m&1)&&set_data(s,d[0]),p&&p.p&&(!a||m&4)&&update_slot_base(p,f,d,d[2],a?get_slot_changes(f,d[2],m,null):get_all_dirty_from_scope(d[2]),null)},i(d){a||(transition_in(u),transition_in(p,d),a=!0)},o(d){transition_out(u),transition_out(p,d),a=!1},d(d){d&&detach(t),u&&u.d(),p&&p.d(d)}}}function instance$b(o,t,e){let{$$slots:i={},$$scope:r}=t,{name:s}=t,{icon:c=""}=t;return o.$$set=a=>{"name"in a&&e(0,s=a.name),"icon"in a&&e(1,c=a.icon),"$$scope"in a&&e(2,r=a.$$scope)},[s,c,r,i]}class SettingsCard extends SvelteComponent{constructor(t){super(),init(this,t,instance$b,create_fragment$b,safe_not_equal,{name:0,icon:1})}}function create_if_block_2$3(o){let t;return{c(){t=element("div"),t.innerHTML="<span>current password wrong</span>",attr(t,"class","alert alert-error mt-2")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_1$4(o){let t,e,i;return{c(){t=element("input"),attr(t,"type","password"),attr(t,"placeholder","confirm password"),attr(t,"autocomplete","off"),attr(t,"class","input w-full input-bordered mt-2")},m(r,s){insert(r,t,s),set_input_value(t,o[1].confirm),e||(i=listen(t,"input",o[9]),e=!0)},p(r,s){s&2&&t.value!==r[1].confirm&&set_input_value(t,r[1].confirm)},d(r){r&&detach(t),e=!1,i()}}}function create_if_block$6(o){let t;return{c(){t=element("div"),t.innerHTML="<span>entered nothing or not the same</span>",attr(t,"class","alert alert-error mt-2")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_fragment$a(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v,w,k,$,T,P,E,x,S,M,O,q,F,A,Z=o[2].current&&create_if_block_2$3(),I=o[1].new!=""&&create_if_block_1$4(o),D=o[2].new&&create_if_block$6();return P=new Icons({props:{icon:"check"}}),M=new Icons({props:{icon:"x"}}),{c(){t=element("dialog"),e=element("div"),i=element("h3"),i.textContent="change password",r=space(),s=element("label"),s.textContent="current",c=space(),a=element("input"),u=space(),Z&&Z.c(),f=space(),p=element("div"),d=space(),m=element("label"),m.textContent="new",g=space(),h=element("input"),v=space(),I&&I.c(),w=space(),D&&D.c(),k=space(),$=element("div"),T=element("button"),create_component(P.$$.fragment),E=text(`
                confirm`),x=space(),S=element("button"),create_component(M.$$.fragment),O=text(`
                abort`),attr(i,"class","font-bold text-lg text-center mb-5"),attr(s,"class","font-medium block mb-1"),attr(a,"placeholder","enter current password"),attr(a,"type","password"),attr(a,"autocomplete","off"),attr(a,"class","input w-full input-bordered"),attr(p,"class","divider mb-3 mt-5"),attr(m,"class","font-medium block mb-1"),attr(h,"type","password"),attr(h,"placeholder","enter new password"),attr(h,"autocomplete","off"),attr(h,"class","input w-full input-bordered"),attr(T,"class","btn btn-neutral"),attr(S,"class","btn"),attr($,"class","flex justify-between items-center mt-3"),attr(e,"class","modal-box"),attr(t,"class","modal")},m(X,N){insert(X,t,N),append(t,e),append(e,i),append(e,r),append(e,s),append(e,c),append(e,a),set_input_value(a,o[1].current),append(e,u),Z&&Z.m(e,null),append(e,f),append(e,p),append(e,d),append(e,m),append(e,g),append(e,h),set_input_value(h,o[1].new),append(e,v),I&&I.m(e,null),append(e,w),D&&D.m(e,null),append(e,k),append(e,$),append($,T),mount_component(P,T,null),append(T,E),append($,x),append($,S),mount_component(M,S,null),append(S,O),o[10](t),q=!0,F||(A=[listen(a,"input",o[7]),listen(h,"input",o[8]),listen(T,"click",o[3]),listen(S,"click",o[4]),listen(e,"keydown",o[5])],F=!0)},p(X,[N]){N&2&&a.value!==X[1].current&&set_input_value(a,X[1].current),X[2].current?Z||(Z=create_if_block_2$3(),Z.c(),Z.m(e,f)):Z&&(Z.d(1),Z=null),N&2&&h.value!==X[1].new&&set_input_value(h,X[1].new),X[1].new!=""?I?I.p(X,N):(I=create_if_block_1$4(X),I.c(),I.m(e,w)):I&&(I.d(1),I=null),X[2].new?D||(D=create_if_block$6(),D.c(),D.m(e,k)):D&&(D.d(1),D=null)},i(X){q||(transition_in(P.$$.fragment,X),transition_in(M.$$.fragment,X),q=!0)},o(X){transition_out(P.$$.fragment,X),transition_out(M.$$.fragment,X),q=!1},d(X){X&&detach(t),Z&&Z.d(),I&&I.d(),D&&D.d(),destroy_component(P),destroy_component(M),o[10](null),F=!1,run_all(A)}}}function instance$a(o,t,e){var i;const r=()=>i.showModal();async function s(){if(f.new==""){e(2,p.new=!0,p);return}else if(f.new!=f.confirm){e(2,p.new=!0,p),e(1,f.confirm="",f);return}e(2,p.new=!1,p);let v=await request("user","put",{password:f.new,currentPassword:f.current});if(!v.ok){v.status==400&&(e(2,p.current=!0,p),e(1,f.current="",f));return}u(),i.close()}function c(){u(),i.close()}function a(v){v.keyCode==13&&(v.preventDefault(),s())}function u(){e(1,f={current:"",new:"",confirm:""}),e(2,p={current:!1,new:!1})}let f={current:"",new:"",confirm:""},p={current:!1,new:!1};function d(){f.current=this.value,e(1,f)}function m(){f.new=this.value,e(1,f)}function g(){f.confirm=this.value,e(1,f)}function h(v){binding_callbacks[v?"unshift":"push"](()=>{i=v,e(0,i)})}return[i,f,p,s,c,a,r,d,m,g,h]}class ChangePassword extends SvelteComponent{constructor(t){super(),init(this,t,instance$a,create_fragment$a,safe_not_equal,{open:6})}get open(){return this.$$.ctx[6]}}function create_catch_block(o){return{c:noop,m:noop,p:noop,i:noop,o:noop,d:noop}}function create_then_block(o){var d,m;let t,e,i,r,s,c,a,u,f,p;return t=new EditValue({props:{value:(d=o[0])==null?void 0:d.name,name:"username",apply:o[5],update:o[2]}}),i=new EditValue({props:{value:(m=o[0])==null?void 0:m.full_name,name:"full name",apply:o[6],update:o[2]}}),c=new Icons({props:{icon:"key"}}),{c(){create_component(t.$$.fragment),e=space(),create_component(i.$$.fragment),r=space(),s=element("button"),create_component(c.$$.fragment),a=text("change password"),attr(s,"class","btn w-full mt-5")},m(g,h){mount_component(t,g,h),insert(g,e,h),mount_component(i,g,h),insert(g,r,h),insert(g,s,h),mount_component(c,s,null),append(s,a),u=!0,f||(p=listen(s,"click",function(){is_function(o[1])&&o[1].apply(this,arguments)}),f=!0)},p(g,h){var k,$;o=g;const v={};h&1&&(v.value=(k=o[0])==null?void 0:k.name),t.$set(v);const w={};h&1&&(w.value=($=o[0])==null?void 0:$.full_name),i.$set(w)},i(g){u||(transition_in(t.$$.fragment,g),transition_in(i.$$.fragment,g),transition_in(c.$$.fragment,g),u=!0)},o(g){transition_out(t.$$.fragment,g),transition_out(i.$$.fragment,g),transition_out(c.$$.fragment,g),u=!1},d(g){destroy_component(t,g),g&&detach(e),destroy_component(i,g),g&&detach(r),g&&detach(s),destroy_component(c),f=!1,p()}}}function create_pending_block(o){let t;return{c(){t=element("span"),attr(t,"class","loading loading-dots")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_default_slot$1(o){let t,e,i,r,s,c={ctx:o,current:null,token:null,hasCatch:!1,pending:create_pending_block,then:create_then_block,catch:create_catch_block,blocks:[,,,]};handle_promise(t=o[0],c);function a(f){o[7](f)}let u={};return o[1]!==void 0&&(u.open=o[1]),i=new ChangePassword({props:u}),binding_callbacks.push(()=>bind(i,"open",a)),{c(){c.block.c(),e=space(),create_component(i.$$.fragment)},m(f,p){c.block.m(f,c.anchor=p),c.mount=()=>e.parentNode,c.anchor=e,insert(f,e,p),mount_component(i,f,p),s=!0},p(f,p){o=f,c.ctx=o,p&1&&t!==(t=o[0])&&handle_promise(t,c)||update_await_block_branch(c,o,p);const d={};!r&&p&2&&(r=!0,d.open=o[1],add_flush_callback(()=>r=!1)),i.$set(d)},i(f){s||(transition_in(c.block),transition_in(i.$$.fragment,f),s=!0)},o(f){for(let p=0;p<3;p+=1){const d=c.blocks[p];transition_out(d)}transition_out(i.$$.fragment,f),s=!1},d(f){c.block.d(f),c.token=null,c=null,f&&detach(e),destroy_component(i,f)}}}function create_fragment$9(o){let t,e,i,r;return i=new SettingsCard({props:{name:"Personal Info",icon:"user",$$slots:{default:[create_default_slot$1]},$$scope:{ctx:o}}}),{c(){t=element("div"),e=element("div"),create_component(i.$$.fragment),attr(e,"class","w-full max-w-lg"),attr(t,"class","p-5 text-lg w-full flex justify-center")},m(s,c){insert(s,t,c),append(t,e),mount_component(i,e,null),r=!0},p(s,[c]){const a={};c&515&&(a.$$scope={dirty:c,ctx:s}),i.$set(a)},i(s){r||(transition_in(i.$$.fragment,s),r=!0)},o(s){transition_out(i.$$.fragment,s),r=!1},d(s){s&&detach(t),destroy_component(i)}}}function instance$9(o,t,e){let i;onMount(()=>{themeChangeExports.themeChange(!1)});async function r(){let d=await request("user");if(!d.ok){goToPage$1("login",!0);return}e(0,i=await d.json())}const s=async d=>{(await request("user","put",{name:d})).ok&&r()},c=async d=>{(await request("user","put",{full_name:d})).ok&&r()};var a;r();const u=d=>s(d),f=d=>c(d);function p(d){a=d,e(1,a)}return[i,a,r,s,c,u,f,p]}class Settings extends SvelteComponent{constructor(t){super(),init(this,t,instance$9,create_fragment$9,safe_not_equal,{})}}function create_if_block_2$2(o){let t,e,i,r=o[2].name.empty?"empty":"already exists",s;return{c(){t=element("div"),e=element("span"),i=text("username "),s=text(r),attr(t,"class","alert alert-error mt-2")},m(c,a){insert(c,t,a),append(t,e),append(e,i),append(e,s)},p(c,a){a&4&&r!==(r=c[2].name.empty?"empty":"already exists")&&set_data(s,r)},d(c){c&&detach(t)}}}function create_if_block_1$3(o){let t,e,i;return{c(){t=element("input"),attr(t,"type","password"),attr(t,"placeholder","confirm password"),attr(t,"autocomplete","off"),attr(t,"class","input w-full input-bordered mt-2")},m(r,s){insert(r,t,s),set_input_value(t,o[1].pw.confirm),e||(i=listen(t,"input",o[12]),e=!0)},p(r,s){s&2&&t.value!==r[1].pw.confirm&&set_input_value(t,r[1].pw.confirm)},d(r){r&&detach(t),e=!1,i()}}}function create_if_block$5(o){let t;return{c(){t=element("div"),t.innerHTML="<span>entered nothing or not the same</span>",attr(t,"class","alert alert-error mt-2")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_fragment$8(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v,w,k,$,T,P,E,x,S,M,O,q,F,A,Z,I,D,X,N,W,R,U=(o[2].name.empty||o[2].name.exists)&&create_if_block_2$2(o),z=o[1].pw.new!=""&&create_if_block_1$3(o),C=o[2].pw&&create_if_block$5();return F=new Icons({props:{icon:"check"}}),D=new Icons({props:{icon:"x"}}),{c(){t=element("dialog"),e=element("div"),i=element("h3"),i.textContent="add user",r=space(),s=element("label"),s.textContent="username",c=space(),a=element("input"),u=space(),U&&U.c(),f=space(),p=element("label"),p.textContent="full name",d=space(),m=element("input"),g=space(),h=element("label"),v=element("span"),v.textContent="admin",w=space(),k=element("input"),$=space(),T=element("label"),T.textContent="password",P=space(),E=element("input"),x=space(),z&&z.c(),S=space(),C&&C.c(),M=space(),O=element("div"),q=element("button"),create_component(F.$$.fragment),A=text(`
                confirm`),Z=space(),I=element("button"),create_component(D.$$.fragment),X=text(`
                abort`),attr(i,"class","font-bold text-lg text-center mb-5"),attr(s,"class","font-medium block mb-1"),attr(a,"placeholder","enter username"),attr(a,"type","text"),attr(a,"autocomplete","off"),attr(a,"class","input w-full input-bordered"),attr(p,"class","font-medium block mb-1 mt-3"),attr(m,"placeholder","enter full name"),attr(m,"type","text"),attr(m,"autocomplete","off"),attr(m,"class","input w-full input-bordered"),attr(v,"class","label-text text-xl font-medium"),attr(k,"type","checkbox"),attr(k,"class","toggle"),attr(h,"class","label cursor-pointer mt-2"),attr(T,"class","font-medium block mb-1"),attr(E,"type","password"),attr(E,"placeholder","enter new password"),attr(E,"autocomplete","off"),attr(E,"class","input w-full input-bordered"),attr(q,"class","btn btn-neutral"),attr(I,"class","btn"),attr(O,"class","flex justify-between items-center mt-5"),attr(e,"class","modal-box"),attr(t,"class","modal")},m(j,V){insert(j,t,V),append(t,e),append(e,i),append(e,r),append(e,s),append(e,c),append(e,a),set_input_value(a,o[1].name),append(e,u),U&&U.m(e,null),append(e,f),append(e,p),append(e,d),append(e,m),set_input_value(m,o[1].full_name),append(e,g),append(e,h),append(h,v),append(h,w),append(h,k),k.checked=o[1].admin,append(e,$),append(e,T),append(e,P),append(e,E),set_input_value(E,o[1].pw.new),append(e,x),z&&z.m(e,null),append(e,S),C&&C.m(e,null),append(e,M),append(e,O),append(O,q),mount_component(F,q,null),append(q,A),append(O,Z),append(O,I),mount_component(D,I,null),append(I,X),o[13](t),N=!0,W||(R=[listen(a,"input",o[8]),listen(m,"input",o[9]),listen(k,"change",o[10]),listen(E,"input",o[11]),listen(q,"click",o[4]),listen(I,"click",o[5]),listen(e,"keydown",o[6])],W=!0)},p(j,[V]){V&2&&a.value!==j[1].name&&set_input_value(a,j[1].name),j[2].name.empty||j[2].name.exists?U?U.p(j,V):(U=create_if_block_2$2(j),U.c(),U.m(e,f)):U&&(U.d(1),U=null),V&2&&m.value!==j[1].full_name&&set_input_value(m,j[1].full_name),V&2&&(k.checked=j[1].admin),V&2&&E.value!==j[1].pw.new&&set_input_value(E,j[1].pw.new),j[1].pw.new!=""?z?z.p(j,V):(z=create_if_block_1$3(j),z.c(),z.m(e,S)):z&&(z.d(1),z=null),j[2].pw?C||(C=create_if_block$5(),C.c(),C.m(e,M)):C&&(C.d(1),C=null)},i(j){N||(transition_in(F.$$.fragment,j),transition_in(D.$$.fragment,j),N=!0)},o(j){transition_out(F.$$.fragment,j),transition_out(D.$$.fragment,j),N=!1},d(j){j&&detach(t),U&&U.d(),z&&z.d(),C&&C.d(),destroy_component(F),destroy_component(D),o[13](null),W=!1,run_all(R)}}}function instance$8(o,t,e){let i;const r=stores.notify;component_subscribe(o,r,T=>e(14,i=T));let s;const c=()=>s.showModal();let a={name:"",full_name:"",admin:0,pw:{new:"",confirm:""}},u={name:{empty:!1,exists:!1},pw:!1};async function f(){if(a.pw.new==""||a.pw.new!=a.pw.confirm){e(2,u.pw=!0,u),e(1,a.pw.confirm="",a);return}e(2,u.pw=!1,u);let T=await request("user","post",{name:a.name,password:a.pw.new,admin:a.admin,full_name:a.full_name});if(!T.ok){T.status==409&&(e(2,u.name=!0,u),e(1,a.name="",a)),T.status==403&&console.log("forbidden");return}set_store_value(r,i={action:"added",kind:"user"},i),s.close(),m()}function p(){s.close(),m()}function d(T){T.keyCode==13&&(T.preventDefault(),f())}function m(){e(1,a={name:"",full_name:"",admin:0,pw:{new:"",confirm:""}}),e(2,u={name:{empty:!1,exists:!1},pw:!1})}function g(){a.name=this.value,e(1,a)}function h(){a.full_name=this.value,e(1,a)}function v(){a.admin=this.checked,e(1,a)}function w(){a.pw.new=this.value,e(1,a)}function k(){a.pw.confirm=this.value,e(1,a)}function $(T){binding_callbacks[T?"unshift":"push"](()=>{s=T,e(0,s)})}return[s,a,u,r,f,p,d,c,g,h,v,w,k,$]}class AddUser extends SvelteComponent{constructor(t){super(),init(this,t,instance$8,create_fragment$8,safe_not_equal,{open:7})}get open(){return this.$$.ctx[7]}}function create_else_block$2(o){var a;let t,e,i,r=((a=o[1])==null?void 0:a.name)+"",s,c;return{c(){t=element("div"),e=text("user "),i=element("span"),s=text(r),c=text(" will be deleted"),attr(i,"class","font-bold"),attr(t,"class","text-center text-error w-full rounded p-5")},m(u,f){insert(u,t,f),append(t,e),append(t,i),append(i,s),append(t,c)},p(u,f){var p;f&2&&r!==(r=((p=u[1])==null?void 0:p.name)+"")&&set_data(s,r)},i:noop,o:noop,d(u){u&&detach(t)}}}function create_if_block$4(o){var z;let t,e,i=((z=o[1])==null?void 0:z.name)+"",r,s,c,a,u,f,p,d,m,g,h,v,w,k,$,T,P,E,x,S,M,O,q,F,A,Z,I,D,X,N,W=o[4].name&&create_if_block_3(),R=o[2].pw.new!=""&&create_if_block_2$1(o),U=o[4].pw&&create_if_block_1$2();return Z=new Icons({props:{icon:"trash"}}),{c(){var C,j;t=element("h3"),e=text("edit user: "),r=text(i),s=space(),c=element("label"),c.textContent="username",a=space(),u=element("input"),p=space(),W&&W.c(),d=space(),m=element("label"),m.textContent="full name",g=space(),h=element("input"),w=space(),k=element("label"),$=element("span"),$.textContent="admin",T=space(),P=element("input"),E=space(),x=element("label"),x.textContent="password",S=space(),M=element("input"),O=space(),R&&R.c(),q=space(),U&&U.c(),F=space(),A=element("button"),create_component(Z.$$.fragment),I=text(`
                delete user`),attr(t,"class","font-bold text-lg text-center mb-5"),attr(c,"class","font-medium block mb-1"),attr(u,"type","text"),attr(u,"placeholder",f=(C=o[1])==null?void 0:C.name),attr(u,"autocomplete","off"),attr(u,"class","input w-full input-bordered"),attr(m,"class","font-medium block mb-1 mt-3"),attr(h,"placeholder",v=(j=o[1])==null?void 0:j.full_name),attr(h,"type","text"),attr(h,"autocomplete","off"),attr(h,"class","input w-full input-bordered"),attr($,"class","label-text text-xl font-medium"),attr(P,"type","checkbox"),attr(P,"class","toggle"),attr(k,"class","label cursor-pointer mt-3"),attr(x,"class","font-medium block mb-1 mt-3"),attr(M,"type","password"),attr(M,"placeholder","enter new password"),attr(M,"autocomplete","off"),attr(M,"class","input w-full input-bordered"),attr(A,"class","btn btn-error w-full mt-5")},m(C,j){insert(C,t,j),append(t,e),append(t,r),insert(C,s,j),insert(C,c,j),insert(C,a,j),insert(C,u,j),set_input_value(u,o[2].name),insert(C,p,j),W&&W.m(C,j),insert(C,d,j),insert(C,m,j),insert(C,g,j),insert(C,h,j),set_input_value(h,o[2].full_name),insert(C,w,j),insert(C,k,j),append(k,$),append(k,T),append(k,P),P.checked=o[2].admin,insert(C,E,j),insert(C,x,j),insert(C,S,j),insert(C,M,j),set_input_value(M,o[2].pw.new),insert(C,O,j),R&&R.m(C,j),insert(C,q,j),U&&U.m(C,j),insert(C,F,j),insert(C,A,j),mount_component(Z,A,null),append(A,I),D=!0,X||(N=[listen(u,"input",o[10]),listen(h,"input",o[11]),listen(P,"change",o[12]),listen(M,"input",o[13]),listen(A,"click",o[15])],X=!0)},p(C,j){var V,H,G;(!D||j&2)&&i!==(i=((V=C[1])==null?void 0:V.name)+"")&&set_data(r,i),(!D||j&2&&f!==(f=(H=C[1])==null?void 0:H.name))&&attr(u,"placeholder",f),j&4&&u.value!==C[2].name&&set_input_value(u,C[2].name),C[4].name?W||(W=create_if_block_3(),W.c(),W.m(d.parentNode,d)):W&&(W.d(1),W=null),(!D||j&2&&v!==(v=(G=C[1])==null?void 0:G.full_name))&&attr(h,"placeholder",v),j&4&&h.value!==C[2].full_name&&set_input_value(h,C[2].full_name),j&4&&(P.checked=C[2].admin),j&4&&M.value!==C[2].pw.new&&set_input_value(M,C[2].pw.new),C[2].pw.new!=""?R?R.p(C,j):(R=create_if_block_2$1(C),R.c(),R.m(q.parentNode,q)):R&&(R.d(1),R=null),C[4].pw?U||(U=create_if_block_1$2(),U.c(),U.m(F.parentNode,F)):U&&(U.d(1),U=null)},i(C){D||(transition_in(Z.$$.fragment,C),D=!0)},o(C){transition_out(Z.$$.fragment,C),D=!1},d(C){C&&detach(t),C&&detach(s),C&&detach(c),C&&detach(a),C&&detach(u),C&&detach(p),W&&W.d(C),C&&detach(d),C&&detach(m),C&&detach(g),C&&detach(h),C&&detach(w),C&&detach(k),C&&detach(E),C&&detach(x),C&&detach(S),C&&detach(M),C&&detach(O),R&&R.d(C),C&&detach(q),U&&U.d(C),C&&detach(F),C&&detach(A),destroy_component(Z),X=!1,run_all(N)}}}function create_if_block_3(o){let t;return{c(){t=element("div"),t.innerHTML="<span>username already exists</span>",attr(t,"class","alert alert-error mt-2")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_if_block_2$1(o){let t,e,i;return{c(){t=element("input"),attr(t,"type","password"),attr(t,"placeholder","confirm password"),attr(t,"autocomplete","off"),attr(t,"class","input w-full input-bordered mt-2")},m(r,s){insert(r,t,s),set_input_value(t,o[2].pw.confirm),e||(i=listen(t,"input",o[14]),e=!0)},p(r,s){s&4&&t.value!==r[2].pw.confirm&&set_input_value(t,r[2].pw.confirm)},d(r){r&&detach(t),e=!1,i()}}}function create_if_block_1$2(o){let t;return{c(){t=element("div"),t.innerHTML="<span>not the same</span>",attr(t,"class","alert alert-error mt-2")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_fragment$7(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v,w;const k=[create_if_block$4,create_else_block$2],$=[];function T(P,E){return P[3]?1:0}return i=T(o),r=$[i]=k[i](o),u=new Icons({props:{icon:"check"}}),m=new Icons({props:{icon:"x"}}),{c(){t=element("dialog"),e=element("div"),r.c(),s=space(),c=element("div"),a=element("button"),create_component(u.$$.fragment),f=text(`
                confirm`),p=space(),d=element("button"),create_component(m.$$.fragment),g=text(`
                abort`),attr(a,"class","btn btn-neutral"),attr(d,"class","btn"),attr(c,"class","flex justify-between items-center mt-5"),attr(e,"class","modal-box"),attr(t,"class","modal")},m(P,E){insert(P,t,E),append(t,e),$[i].m(e,null),append(e,s),append(e,c),append(c,a),mount_component(u,a,null),append(a,f),append(c,p),append(c,d),mount_component(m,d,null),append(d,g),o[16](t),h=!0,v||(w=[listen(a,"click",o[6]),listen(d,"click",o[7]),listen(e,"keydown",o[8])],v=!0)},p(P,[E]){let x=i;i=T(P),i===x?$[i].p(P,E):(group_outros(),transition_out($[x],1,1,()=>{$[x]=null}),check_outros(),r=$[i],r?r.p(P,E):(r=$[i]=k[i](P),r.c()),transition_in(r,1),r.m(e,s))},i(P){h||(transition_in(r),transition_in(u.$$.fragment,P),transition_in(m.$$.fragment,P),h=!0)},o(P){transition_out(r),transition_out(u.$$.fragment,P),transition_out(m.$$.fragment,P),h=!1},d(P){P&&detach(t),$[i].d(),destroy_component(u),destroy_component(m),o[16](null),v=!1,run_all(w)}}}function instance$7(o,t,e){let i;const r=stores.notify;component_subscribe(o,r,S=>e(17,i=S));let s;const c=async S=>{d(),await m(S),s.showModal(),disableDocScroll()};let a,u={name:"",full_name:"",admin:!1,pw:{new:"",confirm:""}},f=!1,p={name:!1,pw:!1};function d(){e(2,u={name:"",full_name:"",admin:!1,pw:{new:"",confirm:""}}),e(3,f=!1),e(4,p={name:!1,pw:!1})}async function m(S){let M=await request(`user?id=${S}`);if(!M.ok){M.status==400&&goToPage$1("login",!0);return}e(1,a=await M.json()),e(2,u.admin=a.admin,u)}async function g(){if(f){let S=await request(`user?id=${a==null?void 0:a.id}`,"delete");if(!S.ok){S.status==403&&goToPage$1("login",!0);return}set_store_value(r,i={action:"deleted",kind:"user",id:a.id},i)}else{if(u.pw.new!=""&&u.pw.new!=u.pw.confirm){e(4,p.pw=!0,p);return}e(4,p.pw=!1,p);let S=await request(`user?id=${a==null?void 0:a.id}`,"put",{...u.name!=""&&{name:u.name},...u.full_name!=""&&{full_name:u.full_name},...u.pw.new!=""&&{password:u.pw.new},admin:u.admin});if(!S.ok){S.status==409&&e(4,p.name=!0,p);return}set_store_value(r,i={action:"updated",kind:"user",id:a.id},i)}s.close(),enableDocScroll()}function h(){s.close(),enableDocScroll()}function v(S){S.keyCode==13&&(S.preventDefault(),g())}function w(){u.name=this.value,e(2,u)}function k(){u.full_name=this.value,e(2,u)}function $(){u.admin=this.checked,e(2,u)}function T(){u.pw.new=this.value,e(2,u)}function P(){u.pw.confirm=this.value,e(2,u)}const E=()=>{e(3,f=!0)};function x(S){binding_callbacks[S?"unshift":"push"](()=>{s=S,e(0,s)})}return[s,a,u,f,p,r,g,h,v,c,w,k,$,T,P,E,x]}class EditUser extends SvelteComponent{constructor(t){super(),init(this,t,instance$7,create_fragment$7,safe_not_equal,{open:9})}get open(){return this.$$.ctx[9]}}function get_each_context$2(o,t,e){const i=o.slice();return i[10]=t[e],i}function create_if_block$3(o){let t,e,i,r,s;e=new Icons({props:{icon:"edit"}});function c(){return o[6](o[10])}return{c(){t=element("button"),create_component(e.$$.fragment),attr(t,"class","btn btn-neutral")},m(a,u){insert(a,t,u),mount_component(e,t,null),i=!0,r||(s=listen(t,"click",c),r=!0)},p(a,u){o=a},i(a){i||(transition_in(e.$$.fragment,a),i=!0)},o(a){transition_out(e.$$.fragment,a),i=!1},d(a){a&&detach(t),destroy_component(e),r=!1,s()}}}function create_each_block$2(o){var v,w,k,$;let t,e,i=((v=o[10])==null?void 0:v.name)+"",r,s,c,a=((w=o[10])!=null&&w.full_name&&o[10].full_name!=null?o[10].full_name:"")+"",u,f,p,d,m,g,h=((k=o[10])==null?void 0:k.id)!=(($=o[1])==null?void 0:$.id)&&create_if_block$3(o);return{c(){var T,P;t=element("tr"),e=element("td"),r=text(i),s=space(),c=element("td"),u=text(a),f=space(),p=element("td"),h&&h.c(),d=space(),attr(p,"class","text-right"),attr(t,"class",m=((T=o[10])==null?void 0:T.id)==((P=o[1])==null?void 0:P.id)?"bg-base-200":"")},m(T,P){insert(T,t,P),append(t,e),append(e,r),append(t,s),append(t,c),append(c,u),append(t,f),append(t,p),h&&h.m(p,null),append(t,d),g=!0},p(T,P){var E,x,S,M,O,q;(!g||P&1)&&i!==(i=((E=T[10])==null?void 0:E.name)+"")&&set_data(r,i),(!g||P&1)&&a!==(a=((x=T[10])!=null&&x.full_name&&T[10].full_name!=null?T[10].full_name:"")+"")&&set_data(u,a),((S=T[10])==null?void 0:S.id)!=((M=T[1])==null?void 0:M.id)?h?(h.p(T,P),P&3&&transition_in(h,1)):(h=create_if_block$3(T),h.c(),transition_in(h,1),h.m(p,null)):h&&(group_outros(),transition_out(h,1,1,()=>{h=null}),check_outros()),(!g||P&3&&m!==(m=((O=T[10])==null?void 0:O.id)==((q=T[1])==null?void 0:q.id)?"bg-base-200":""))&&attr(t,"class",m)},i(T){g||(transition_in(h),g=!0)},o(T){transition_out(h),g=!1},d(T){T&&detach(t),h&&h.d()}}}function create_fragment$6(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v,w,k,$=o[0],T=[];for(let O=0;O<$.length;O+=1)T[O]=create_each_block$2(get_each_context$2(o,$,O));const P=O=>transition_out(T[O],1,1,()=>{T[O]=null});a=new Icons({props:{icon:"adduser"}});function E(O){o[7](O)}let x={};o[2]!==void 0&&(x.open=o[2]),p=new AddUser({props:x}),binding_callbacks.push(()=>bind(p,"open",E));function S(O){o[8](O)}let M={};return o[3]!==void 0&&(M.open=o[3]),g=new EditUser({props:M}),binding_callbacks.push(()=>bind(g,"open",S)),{c(){t=element("table"),e=element("thead"),e.innerHTML=`<tr><th>username</th> 
            <th>full name</th> 
            <th></th></tr>`,i=space(),r=element("tbody");for(let O=0;O<T.length;O+=1)T[O].c();s=space(),c=element("button"),create_component(a.$$.fragment),u=text(`
    add user`),f=space(),create_component(p.$$.fragment),m=space(),create_component(g.$$.fragment),attr(t,"class","table"),attr(c,"class","btn btn-neutral w-full mt-5")},m(O,q){insert(O,t,q),append(t,e),append(t,i),append(t,r);for(let F=0;F<T.length;F+=1)T[F]&&T[F].m(r,null);insert(O,s,q),insert(O,c,q),mount_component(a,c,null),append(c,u),insert(O,f,q),mount_component(p,O,q),insert(O,m,q),mount_component(g,O,q),v=!0,w||(k=listen(c,"click",function(){is_function(o[2])&&o[2].apply(this,arguments)}),w=!0)},p(O,[q]){if(o=O,q&11){$=o[0];let Z;for(Z=0;Z<$.length;Z+=1){const I=get_each_context$2(o,$,Z);T[Z]?(T[Z].p(I,q),transition_in(T[Z],1)):(T[Z]=create_each_block$2(I),T[Z].c(),transition_in(T[Z],1),T[Z].m(r,null))}for(group_outros(),Z=$.length;Z<T.length;Z+=1)P(Z);check_outros()}const F={};!d&&q&4&&(d=!0,F.open=o[2],add_flush_callback(()=>d=!1)),p.$set(F);const A={};!h&&q&8&&(h=!0,A.open=o[3],add_flush_callback(()=>h=!1)),g.$set(A)},i(O){if(!v){for(let q=0;q<$.length;q+=1)transition_in(T[q]);transition_in(a.$$.fragment,O),transition_in(p.$$.fragment,O),transition_in(g.$$.fragment,O),v=!0}},o(O){T=T.filter(Boolean);for(let q=0;q<T.length;q+=1)transition_out(T[q]);transition_out(a.$$.fragment,O),transition_out(p.$$.fragment,O),transition_out(g.$$.fragment,O),v=!1},d(O){O&&detach(t),destroy_each(T,O),O&&detach(s),O&&detach(c),destroy_component(a),O&&detach(f),destroy_component(p,O),O&&detach(m),destroy_component(g,O),w=!1,k()}}}function instance$6(o,t,e){let i;const r=stores.notify;component_subscribe(o,r,g=>e(5,i=g));let s=[],c;async function a(){let g=await request("users");if(!g.ok){goToPage$1("login",!0);return}if(e(0,s=await g.json()),g=await request("user"),!g.ok){goToPage$1("login",!0);return}e(1,c=await g.json())}a();let u,f;const p=g=>f(g==null?void 0:g.id);function d(g){u=g,e(2,u)}function m(g){f=g,e(3,f)}return o.$$.update=()=>{o.$$.dirty&32&&(i==null?void 0:i.kind)=="user"&&a()},[s,c,u,f,r,i,p,d,m]}class ManageUsers extends SvelteComponent{constructor(t){super(),init(this,t,instance$6,create_fragment$6,safe_not_equal,{})}}function get_each_context$1(o,t,e){const i=o.slice();return i[21]=t[e],i}function get_each_context_1$1(o,t,e){const i=o.slice();return i[24]=t[e],i[26]=e,i}function create_else_block$1(o){let t,e,i,r=o[0].length>0&&create_if_block_2(o),s=o[3],c=[];for(let u=0;u<s.length;u+=1)c[u]=create_each_block_1$1(get_each_context_1$1(o,s,u));const a=u=>transition_out(c[u],1,1,()=>{c[u]=null});return{c(){r&&r.c(),t=space();for(let u=0;u<c.length;u+=1)c[u].c();e=empty()},m(u,f){r&&r.m(u,f),insert(u,t,f);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(u,f);insert(u,e,f),i=!0},p(u,f){if(u[0].length>0?r?(r.p(u,f),f&1&&transition_in(r,1)):(r=create_if_block_2(u),r.c(),transition_in(r,1),r.m(t.parentNode,t)):r&&(group_outros(),transition_out(r,1,1,()=>{r=null}),check_outros()),f&2056){s=u[3];let p;for(p=0;p<s.length;p+=1){const d=get_each_context_1$1(u,s,p);c[p]?(c[p].p(d,f),transition_in(c[p],1)):(c[p]=create_each_block_1$1(d),c[p].c(),transition_in(c[p],1),c[p].m(e.parentNode,e))}for(group_outros(),p=s.length;p<c.length;p+=1)a(p);check_outros()}},i(u){if(!i){transition_in(r);for(let f=0;f<s.length;f+=1)transition_in(c[f]);i=!0}},o(u){transition_out(r),c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)transition_out(c[f]);i=!1},d(u){r&&r.d(u),u&&detach(t),destroy_each(c,u),u&&detach(e)}}}function create_if_block_1$1(o){let t;return{c(){t=element("div"),t.innerHTML='<span class="loading loading-dots loading-lg"></span>',attr(t,"class","w-full h-32 flex justify-center items-center")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_if_block_2(o){let t,e,i,r,s,c,a;return e=new Icons({props:{icon:"back"}}),{c(){t=element("div"),create_component(e.$$.fragment),i=space(),r=element("span"),r.textContent="..",attr(r,"class","ml-2"),attr(t,"class","h-12 w-full my-2 flex justify-left items-center pl-4")},m(u,f){insert(u,t,f),mount_component(e,t,null),append(t,i),append(t,r),s=!0,c||(a=listen(t,"click",o[12]),c=!0)},p:noop,i(u){s||(transition_in(e.$$.fragment,u),s=!0)},o(u){transition_out(e.$$.fragment,u),s=!1},d(u){u&&detach(t),destroy_component(e),c=!1,a()}}}function create_each_block_1$1(o){let t,e,i,r,s,c,a=o[24]+"",u,f,p,d,m;r=new Icons({props:{icon:"folder"}});function g(){return o[16](o[24])}return{c(){t=element("hr"),e=space(),i=element("div"),create_component(r.$$.fragment),s=space(),c=element("span"),u=text(a),f=space(),attr(t,"class","h-px bg-base-300 border-0"),attr(c,"class","ml-2"),attr(i,"class","h-12 w-full my-2 flex justify-left items-center pl-4")},m(h,v){insert(h,t,v),insert(h,e,v),insert(h,i,v),mount_component(r,i,null),append(i,s),append(i,c),append(c,u),append(i,f),p=!0,d||(m=listen(i,"click",g),d=!0)},p(h,v){o=h,(!p||v&8)&&a!==(a=o[24]+"")&&set_data(u,a)},i(h){p||(transition_in(r.$$.fragment,h),p=!0)},o(h){transition_out(r.$$.fragment,h),p=!1},d(h){h&&detach(t),h&&detach(e),h&&detach(i),destroy_component(r),d=!1,m()}}}function create_each_block$1(o){let t,e=o[21].name+"",i,r=o[21].full_name&&o[21].full_name.length>0?" ("+o[21].full_name+")":"",s,c;return{c(){t=element("option"),i=text(e),s=text(r),t.__value=c=o[21].id,t.value=t.__value},m(a,u){insert(a,t,u),append(t,i),append(t,s)},p(a,u){u&16&&e!==(e=a[21].name+"")&&set_data(i,e),u&16&&r!==(r=a[21].full_name&&a[21].full_name.length>0?" ("+a[21].full_name+")":"")&&set_data(s,r),u&16&&c!==(c=a[21].id)&&(t.__value=c,t.value=t.__value)},d(a){a&&detach(t)}}}function create_if_block$2(o){let t;return{c(){t=element("div"),t.innerHTML="<span>select user!</span>",attr(t,"class","alert alert-error mt-2")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_fragment$5(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v,w,k,$,T,P,E,x,S,M,O,q;function F(R){o[15](R)}let A={};o[0]!==void 0&&(A.breadcrumbs=o[0]),s=new Breadcrumbs({props:A}),binding_callbacks.push(()=>bind(s,"breadcrumbs",F));const Z=[create_if_block_1$1,create_else_block$1],I=[];function D(R,U){return R[2]?0:1}f=D(o),p=I[f]=Z[f](o);let X=o[4],N=[];for(let R=0;R<X.length;R+=1)N[R]=create_each_block$1(get_each_context$1(o,X,R));let W=o[6]&&create_if_block$2();return $=new Icons({props:{icon:"check"}}),x=new Icons({props:{icon:"x"}}),{c(){t=element("dialog"),e=element("div"),i=element("h3"),i.textContent="add base directory",r=space(),create_component(s.$$.fragment),a=space(),u=element("div"),p.c(),d=space(),m=element("select"),g=element("option"),g.textContent="select user";for(let R=0;R<N.length;R+=1)N[R].c();h=space(),W&&W.c(),v=space(),w=element("div"),k=element("button"),create_component($.$$.fragment),T=text(`
                confirm`),P=space(),E=element("button"),create_component(x.$$.fragment),S=text(`
                abort`),attr(i,"class","font-bold text-lg text-center mb-5"),attr(u,"class","w-full max-h-96 overflow-y-auto border border-base-300 rounded-lg mt-2 cursor-pointer"),g.disabled=!0,g.selected=!0,g.__value="select user",g.value=g.__value,attr(m,"class","select select-bordered w-full mt-2"),o[5]===void 0&&add_render_callback(()=>o[17].call(m)),attr(k,"class","btn btn-neutral"),attr(E,"class","btn"),attr(w,"class","flex justify-between items-center mt-2"),attr(e,"class","modal-box"),attr(t,"class","modal")},m(R,U){insert(R,t,U),append(t,e),append(e,i),append(e,r),mount_component(s,e,null),append(e,a),append(e,u),I[f].m(u,null),append(e,d),append(e,m),append(m,g);for(let z=0;z<N.length;z+=1)N[z]&&N[z].m(m,null);select_option(m,o[5],!0),append(e,h),W&&W.m(e,null),append(e,v),append(e,w),append(w,k),mount_component($,k,null),append(k,T),append(w,P),append(w,E),mount_component(x,E,null),append(E,S),o[18](t),M=!0,O||(q=[listen(m,"change",o[17]),listen(k,"click",o[8]),listen(E,"click",o[9]),listen(e,"keydown",o[10])],O=!0)},p(R,[U]){const z={};!c&&U&1&&(c=!0,z.breadcrumbs=R[0],add_flush_callback(()=>c=!1)),s.$set(z);let C=f;if(f=D(R),f===C?I[f].p(R,U):(group_outros(),transition_out(I[C],1,1,()=>{I[C]=null}),check_outros(),p=I[f],p?p.p(R,U):(p=I[f]=Z[f](R),p.c()),transition_in(p,1),p.m(u,null)),U&16){X=R[4];let j;for(j=0;j<X.length;j+=1){const V=get_each_context$1(R,X,j);N[j]?N[j].p(V,U):(N[j]=create_each_block$1(V),N[j].c(),N[j].m(m,null))}for(;j<N.length;j+=1)N[j].d(1);N.length=X.length}U&48&&select_option(m,R[5]),R[6]?W||(W=create_if_block$2(),W.c(),W.m(e,v)):W&&(W.d(1),W=null)},i(R){M||(transition_in(s.$$.fragment,R),transition_in(p),transition_in($.$$.fragment,R),transition_in(x.$$.fragment,R),M=!0)},o(R){transition_out(s.$$.fragment,R),transition_out(p),transition_out($.$$.fragment,R),transition_out(x.$$.fragment,R),M=!1},d(R){R&&detach(t),destroy_component(s),I[f].d(),destroy_each(N,R),W&&W.d(),destroy_component($),destroy_component(x),o[18](null),O=!1,run_all(q)}}}function instance$5(o,t,e){let i;const r=stores.notify;component_subscribe(o,r,M=>e(14,i=M));let s;const c=()=>{T(),s.showModal(),w()};let a=!0,u=[],f=[],p=[],d="select user",m=!1;async function g(){if(d=="select user"){e(6,m=!0);return}e(6,m=!1),(await request("basedir","post",{user_id:d,path:u})).ok&&(set_store_value(r,i={action:"added",kind:"basedir"},i),s.close())}function h(){s.close()}function v(M){M.keyCode==13&&(M.preventDefault(),g())}async function w(){if(e(2,a=!0),p.length<1){let O=await request("users");if(!O.ok){goToPage("login",!0);return}e(4,p=await O.json())}let M=await request(`filesystem/subfolders/${urlEncode(u)}`);M.ok&&(e(3,f=await M.json()),e(2,a=!1))}async function k(M){e(0,u=[...u,M]),await w()}async function $(){e(0,u=u.slice(0,u.length-1)),await w()}function T(){e(0,u=[]),e(3,f=[]),e(2,a=!0),e(4,p=[]),e(5,d="select user"),e(6,m=!1)}function P(M){u=M,e(0,u),e(14,i)}const E=M=>k(M);function x(){d=select_value(this),e(5,d),e(4,p)}function S(M){binding_callbacks[M?"unshift":"push"](()=>{s=M,e(1,s)})}return o.$$.update=()=>{o.$$.dirty&16385&&(async()=>(i==null?void 0:i.kind)=="breadcrumb"&&(e(0,u=u.slice(0,i.index+1)),set_store_value(r,i={},i),await w()))()},[u,s,a,f,p,d,m,r,g,h,v,k,$,c,i,P,E,x,S]}class AddBasedir extends SvelteComponent{constructor(t){super(),init(this,t,instance$5,create_fragment$5,safe_not_equal,{open:13})}get open(){return this.$$.ctx[13]}}function create_fragment$4(o){var P;let t,e,i,r=((P=o[0])==null?void 0:P.path)+"",s,c,a,u,f,p,d,m,g,h,v,w,k,$,T;return d=new Icons({props:{icon:"trash"}}),v=new Icons({props:{icon:"x"}}),{c(){t=element("dialog"),e=element("div"),i=element("h3"),s=text(r),c=space(),a=element("h3"),a.textContent="will be deleted from the database.",u=space(),f=element("div"),p=element("button"),create_component(d.$$.fragment),m=text(`
                confirm`),g=space(),h=element("button"),create_component(v.$$.fragment),w=text(`
                abort`),attr(i,"class","text-md font-mono text-center mt-2"),attr(a,"class","font-bold text-lg text-center mb-7 mt-2"),attr(p,"class","btn btn-error"),attr(h,"class","btn"),attr(f,"class","flex justify-between items-center mt-3"),attr(e,"class","modal-box"),attr(t,"class","modal")},m(E,x){insert(E,t,x),append(t,e),append(e,i),append(i,s),append(e,c),append(e,a),append(e,u),append(e,f),append(f,p),mount_component(d,p,null),append(p,m),append(f,g),append(f,h),mount_component(v,h,null),append(h,w),o[6](t),k=!0,$||(T=[listen(p,"click",o[3]),listen(h,"click",o[4])],$=!0)},p(E,[x]){var S;(!k||x&1)&&r!==(r=((S=E[0])==null?void 0:S.path)+"")&&set_data(s,r)},i(E){k||(transition_in(d.$$.fragment,E),transition_in(v.$$.fragment,E),k=!0)},o(E){transition_out(d.$$.fragment,E),transition_out(v.$$.fragment,E),k=!1},d(E){E&&detach(t),destroy_component(d),destroy_component(v),o[6](null),$=!1,run_all(T)}}}function instance$4(o,t,e){let i;const r=stores.notify;component_subscribe(o,r,d=>e(7,i=d));let s,c;const a=d=>{e(0,s=d),c.showModal()};async function u(){let d=await request(`basedir/${s==null?void 0:s.id}`,"delete");if(!d.ok){console.log(d.status);return}set_store_value(r,i={action:"deleted",kind:"basedir"},i),c.close()}function f(){c.close()}function p(d){binding_callbacks[d?"unshift":"push"](()=>{c=d,e(1,c)})}return[s,c,r,u,f,a,p]}class ConfirmBasedirDelete extends SvelteComponent{constructor(t){super(),init(this,t,instance$4,create_fragment$4,safe_not_equal,{open:5})}get open(){return this.$$.ctx[5]}}function get_each_context(o,t,e){const i=o.slice();return i[10]=t[e],i}function get_each_context_1(o,t,e){const i=o.slice();return i[13]=t[e],i}function create_else_block(o){let t=[],e=new Map,i,r,s,c,a,u,f,p,d,m,g,h,v,w=o[0];const k=x=>x[10];for(let x=0;x<w.length;x+=1){let S=get_each_context(o,w,x),M=k(S);e.set(M,t[x]=create_each_block(M,S))}s=new Icons({props:{icon:"addfolder"}});function $(x){o[7](x)}let T={};o[2]!==void 0&&(T.open=o[2]),u=new AddBasedir({props:T}),binding_callbacks.push(()=>bind(u,"open",$));function P(x){o[8](x)}let E={};return o[3]!==void 0&&(E.open=o[3]),d=new ConfirmBasedirDelete({props:E}),binding_callbacks.push(()=>bind(d,"open",P)),{c(){for(let x=0;x<t.length;x+=1)t[x].c();i=space(),r=element("button"),create_component(s.$$.fragment),c=text(`
    add base directory`),a=space(),create_component(u.$$.fragment),p=space(),create_component(d.$$.fragment),attr(r,"class","btn btn-neutral w-full mt-5")},m(x,S){for(let M=0;M<t.length;M+=1)t[M]&&t[M].m(x,S);insert(x,i,S),insert(x,r,S),mount_component(s,r,null),append(r,c),insert(x,a,S),mount_component(u,x,S),insert(x,p,S),mount_component(d,x,S),g=!0,h||(v=listen(r,"click",function(){is_function(o[2])&&o[2].apply(this,arguments)}),h=!0)},p(x,S){o=x,S&9&&(w=o[0],group_outros(),t=update_keyed_each(t,S,k,1,o,w,e,i.parentNode,outro_and_destroy_block,create_each_block,i,get_each_context),check_outros());const M={};!f&&S&4&&(f=!0,M.open=o[2],add_flush_callback(()=>f=!1)),u.$set(M);const O={};!m&&S&8&&(m=!0,O.open=o[3],add_flush_callback(()=>m=!1)),d.$set(O)},i(x){if(!g){for(let S=0;S<w.length;S+=1)transition_in(t[S]);transition_in(s.$$.fragment,x),transition_in(u.$$.fragment,x),transition_in(d.$$.fragment,x),g=!0}},o(x){for(let S=0;S<t.length;S+=1)transition_out(t[S]);transition_out(s.$$.fragment,x),transition_out(u.$$.fragment,x),transition_out(d.$$.fragment,x),g=!1},d(x){for(let S=0;S<t.length;S+=1)t[S].d(x);x&&detach(i),x&&detach(r),destroy_component(s),x&&detach(a),destroy_component(u,x),x&&detach(p),destroy_component(d,x),h=!1,v()}}}function create_if_block$1(o){let t;return{c(){t=element("div"),t.innerHTML='<span class="loading loading-dots loading-lg"></span>',attr(t,"class","w-full h-96 flex justify-center items-center")},m(e,i){insert(e,t,i)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}function create_each_block_1(o,t){let e,i,r=t[13].path+"",s,c,a,u,f,p,d,m;f=new Icons({props:{icon:"trash"}});function g(){return t[6](t[13])}return{key:o,first:null,c(){e=element("tr"),i=element("td"),s=text(r),c=space(),a=element("td"),u=element("button"),create_component(f.$$.fragment),attr(i,"class","break-all font-mono"),attr(u,"class","btn btn-error"),attr(a,"class","text-right"),this.first=e},m(h,v){insert(h,e,v),append(e,i),append(i,s),append(e,c),append(e,a),append(a,u),mount_component(f,u,null),p=!0,d||(m=listen(u,"click",g),d=!0)},p(h,v){t=h,(!p||v&1)&&r!==(r=t[13].path+"")&&set_data(s,r)},i(h){p||(transition_in(f.$$.fragment,h),p=!0)},o(h){transition_out(f.$$.fragment,h),p=!1},d(h){h&&detach(e),destroy_component(f),d=!1,m()}}}function create_each_block(o,t){let e,i=t[10].name+"",r,s=t[10].full_name&&t[10].full_name.length>0?" ("+t[10].full_name+")":"",c,a,u,f,p,d,m=[],g=new Map,h,v=t[10].dirs;const w=k=>k[13];for(let k=0;k<v.length;k+=1){let $=get_each_context_1(t,v,k),T=w($);g.set(T,m[k]=create_each_block_1(T,$))}return{key:o,first:null,c(){e=element("h3"),r=text(i),c=text(s),a=space(),u=element("table"),f=element("thead"),f.innerHTML="<tr><th>path</th><th></th></tr>",p=space(),d=element("tbody");for(let k=0;k<m.length;k+=1)m[k].c();attr(e,"class","text-lg text-center font-semibold"),attr(u,"class","table mb-5"),this.first=e},m(k,$){insert(k,e,$),append(e,r),append(e,c),insert(k,a,$),insert(k,u,$),append(u,f),append(u,p),append(u,d);for(let T=0;T<m.length;T+=1)m[T]&&m[T].m(d,null);h=!0},p(k,$){t=k,(!h||$&1)&&i!==(i=t[10].name+"")&&set_data(r,i),(!h||$&1)&&s!==(s=t[10].full_name&&t[10].full_name.length>0?" ("+t[10].full_name+")":"")&&set_data(c,s),$&9&&(v=t[10].dirs,group_outros(),m=update_keyed_each(m,$,w,1,t,v,g,d,outro_and_destroy_block,create_each_block_1,null,get_each_context_1),check_outros())},i(k){if(!h){for(let $=0;$<v.length;$+=1)transition_in(m[$]);h=!0}},o(k){for(let $=0;$<m.length;$+=1)transition_out(m[$]);h=!1},d(k){k&&detach(e),k&&detach(a),k&&detach(u);for(let $=0;$<m.length;$+=1)m[$].d()}}}function create_fragment$3(o){let t,e,i,r;const s=[create_if_block$1,create_else_block],c=[];function a(u,f){return u[1]?1:0}return t=a(o),e=c[t]=s[t](o),{c(){e.c(),i=empty()},m(u,f){c[t].m(u,f),insert(u,i,f),r=!0},p(u,[f]){let p=t;t=a(u),t===p?c[t].p(u,f):(group_outros(),transition_out(c[p],1,1,()=>{c[p]=null}),check_outros(),e=c[t],e?e.p(u,f):(e=c[t]=s[t](u),e.c()),transition_in(e,1),e.m(i.parentNode,i))},i(u){r||(transition_in(e),r=!0)},o(u){transition_out(e),r=!1},d(u){c[t].d(u),u&&detach(i)}}}function instance$3(o,t,e){let i;const r=stores.notify;component_subscribe(o,r,g=>e(5,i=g));let s=[],c=!1;async function a(){e(1,c=!1);let g=await request("basedirs/all");if(!g.ok){goToPage$1("login",!0);return}let h=await g.json();if(e(0,s=[]),g=await request("users"),!g.ok){goToPage$1("login",!0);return}for(let v of await g.json()){let w=h.filter(k=>k.user_id==v.id);w.length>0&&e(0,s=[...s,{name:v.name,full_name:v.full_name,dirs:w}])}e(1,c=!0)}a();let u,f;const p=g=>f(g);function d(g){u=g,e(2,u)}function m(g){f=g,e(3,f)}return o.$$.update=()=>{o.$$.dirty&32&&((i==null?void 0:i.kind)=="user"||(i==null?void 0:i.kind)=="basedir")&&a()},[s,c,u,f,r,i,p,d,m]}class ManageBasedirs extends SvelteComponent{constructor(t){super(),init(this,t,instance$3,create_fragment$3,safe_not_equal,{})}}function create_fragment$2(o){let t,e,i,r,s,c,a,u,f,p,d,m,g,h,v;return a=new Icons({props:{icon:"trash"}}),d=new Icons({props:{icon:"x"}}),{c(){t=element("dialog"),e=element("div"),i=element("h3"),i.textContent="all preview files will be purged.",r=space(),s=element("div"),c=element("button"),create_component(a.$$.fragment),u=text(`
                confirm`),f=space(),p=element("button"),create_component(d.$$.fragment),m=text(`
                abort`),attr(i,"class","font-bold text-lg text-center mb-7 mt-2"),attr(c,"class","btn btn-error"),attr(p,"class","btn"),attr(s,"class","flex justify-between items-center mt-3"),attr(e,"class","modal-box"),attr(t,"class","modal")},m(w,k){insert(w,t,k),append(t,e),append(e,i),append(e,r),append(e,s),append(s,c),mount_component(a,c,null),append(c,u),append(s,f),append(s,p),mount_component(d,p,null),append(p,m),o[5](t),g=!0,h||(v=[listen(c,"click",o[2]),listen(p,"click",o[3])],h=!0)},p:noop,i(w){g||(transition_in(a.$$.fragment,w),transition_in(d.$$.fragment,w),g=!0)},o(w){transition_out(a.$$.fragment,w),transition_out(d.$$.fragment,w),g=!1},d(w){w&&detach(t),destroy_component(a),destroy_component(d),o[5](null),h=!1,run_all(v)}}}function instance$2(o,t,e){let i;const r=stores.notify;component_subscribe(o,r,p=>e(6,i=p));let s;const c=()=>{s.showModal()};async function a(){let p=await request("admin/clearcache");if(!p.ok){console.log(p.status);return}set_store_value(r,i={action:"cleared",kind:"cache"},i),s.close()}function u(){s.close()}function f(p){binding_callbacks[p?"unshift":"push"](()=>{s=p,e(0,s)})}return[s,r,a,u,c,f]}class ConfirmCacheClear extends SvelteComponent{constructor(t){super(),init(this,t,instance$2,create_fragment$2,safe_not_equal,{open:4})}get open(){return this.$$.ctx[4]}}function create_default_slot_3(o){let t,e;return t=new ManageUsers({}),{c(){create_component(t.$$.fragment)},m(i,r){mount_component(t,i,r),e=!0},i(i){e||(transition_in(t.$$.fragment,i),e=!0)},o(i){transition_out(t.$$.fragment,i),e=!1},d(i){destroy_component(t,i)}}}function create_default_slot_2(o){let t,e;return t=new ManageBasedirs({}),{c(){create_component(t.$$.fragment)},m(i,r){mount_component(t,i,r),e=!0},i(i){e||(transition_in(t.$$.fragment,i),e=!0)},o(i){transition_out(t.$$.fragment,i),e=!1},d(i){destroy_component(t,i)}}}function create_if_block(o){let t,e,i,r;return t=new SettingsCard({props:{name:"stats",icon:"database",$$slots:{default:[create_default_slot_1]},$$scope:{ctx:o}}}),i=new SettingsCard({props:{name:"cache",icon:"database",$$slots:{default:[create_default_slot]},$$scope:{ctx:o}}}),{c(){create_component(t.$$.fragment),e=space(),create_component(i.$$.fragment)},m(s,c){mount_component(t,s,c),insert(s,e,c),mount_component(i,s,c),r=!0},p(s,c){const a={};c&65539&&(a.$$scope={dirty:c,ctx:s}),t.$set(a);const u={};c&65541&&(u.$$scope={dirty:c,ctx:s}),i.$set(u)},i(s){r||(transition_in(t.$$.fragment,s),transition_in(i.$$.fragment,s),r=!0)},o(s){transition_out(t.$$.fragment,s),transition_out(i.$$.fragment,s),r=!1},d(s){destroy_component(t,s),s&&detach(e),destroy_component(i,s)}}}function create_if_block_1(o){let t;return{c(){t=element("span"),attr(t,"class","loading loading-spinner loading-sm")},m(e,i){insert(e,t,i)},d(e){e&&detach(t)}}}function create_default_slot_1(o){let t,e,i,r,s,c,a,u,f,p,d=o[0].db.images+"",m,g,h,v,w,k,$,T,P,E,x=o[0].db.videos+"",S,M,O,q,F,A,Z,I,D,X,N=o[0].db.folders+"",W,R,U,z,C,j,V,H,G,ee,re=o[9]()+"",ae,oe,le,fe,me,de,ue,te,J,Q,he=o[0].db.shares+"",_e,ne,ie,ye,Oe,Le,ve,Se,pe,ze,je=o[0].db.different_cameras+"",Ge,He,Ie,tt,Ue,Fe,rt,nt;c=new Icons({props:{icon:"album"}}),k=new Icons({props:{icon:"video"}}),A=new Icons({props:{icon:"folder"}}),j=new Icons({props:{icon:"save"}}),de=new Icons({props:{icon:"share"}}),Le=new Icons({props:{icon:"camera"}});let Ze=!o[1]&&create_if_block_1();return{c(){t=element("table"),e=element("tbody"),i=element("tr"),r=element("th"),s=element("div"),create_component(c.$$.fragment),a=space(),u=element("span"),u.textContent="images",f=space(),p=element("td"),m=text(d),g=space(),h=element("tr"),v=element("th"),w=element("div"),create_component(k.$$.fragment),$=space(),T=element("span"),T.textContent="videos",P=space(),E=element("td"),S=text(x),M=space(),O=element("tr"),q=element("th"),F=element("div"),create_component(A.$$.fragment),Z=space(),I=element("span"),I.textContent="folders",D=space(),X=element("td"),W=text(N),R=space(),U=element("tr"),z=element("th"),C=element("div"),create_component(j.$$.fragment),V=space(),H=element("span"),H.textContent="cumulated size",G=space(),ee=element("td"),ae=text(re),oe=space(),le=element("tr"),fe=element("th"),me=element("div"),create_component(de.$$.fragment),ue=space(),te=element("span"),te.textContent="shares",J=space(),Q=element("td"),_e=text(he),ne=space(),ie=element("tr"),ye=element("th"),Oe=element("div"),create_component(Le.$$.fragment),ve=space(),Se=element("span"),Se.textContent="different cameras",pe=space(),ze=element("td"),Ge=text(je),He=space(),Ie=element("button"),Ze&&Ze.c(),tt=text(`
                index all basedirs`),attr(u,"class","ml-2"),attr(s,"class","flex items-center justify-start"),attr(p,"class","text-right font-semibold font-mono"),attr(T,"class","ml-2"),attr(w,"class","flex items-center justify-start"),attr(E,"class","text-right font-semibold font-mono"),attr(I,"class","ml-2"),attr(F,"class","flex items-center justify-start"),attr(X,"class","text-right font-semibold font-mono"),attr(H,"class","ml-2"),attr(C,"class","flex items-center justify-start"),attr(ee,"class","text-right font-semibold font-mono"),attr(te,"class","ml-2"),attr(me,"class","flex items-center justify-start"),attr(Q,"class","text-right font-semibold font-mono"),attr(Se,"class","ml-2"),attr(Oe,"class","flex items-center justify-start"),attr(ze,"class","text-right font-semibold font-mono"),attr(t,"class","table table-zebra"),attr(Ie,"class","btn btn-neutral w-full mt-5"),Ie.disabled=Ue=!o[1]},m(Pe,De){insert(Pe,t,De),append(t,e),append(e,i),append(i,r),append(r,s),mount_component(c,s,null),append(s,a),append(s,u),append(i,f),append(i,p),append(p,m),append(e,g),append(e,h),append(h,v),append(v,w),mount_component(k,w,null),append(w,$),append(w,T),append(h,P),append(h,E),append(E,S),append(e,M),append(e,O),append(O,q),append(q,F),mount_component(A,F,null),append(F,Z),append(F,I),append(O,D),append(O,X),append(X,W),append(e,R),append(e,U),append(U,z),append(z,C),mount_component(j,C,null),append(C,V),append(C,H),append(U,G),append(U,ee),append(ee,ae),append(e,oe),append(e,le),append(le,fe),append(fe,me),mount_component(de,me,null),append(me,ue),append(me,te),append(le,J),append(le,Q),append(Q,_e),append(e,ne),append(e,ie),append(ie,ye),append(ye,Oe),mount_component(Le,Oe,null),append(Oe,ve),append(Oe,Se),append(ie,pe),append(ie,ze),append(ze,Ge),insert(Pe,He,De),insert(Pe,Ie,De),Ze&&Ze.m(Ie,null),append(Ie,tt),Fe=!0,rt||(nt=listen(Ie,"click",o[7]),rt=!0)},p(Pe,De){(!Fe||De&1)&&d!==(d=Pe[0].db.images+"")&&set_data(m,d),(!Fe||De&1)&&x!==(x=Pe[0].db.videos+"")&&set_data(S,x),(!Fe||De&1)&&N!==(N=Pe[0].db.folders+"")&&set_data(W,N),(!Fe||De&1)&&re!==(re=Pe[9]()+"")&&set_data(ae,re),(!Fe||De&1)&&he!==(he=Pe[0].db.shares+"")&&set_data(_e,he),(!Fe||De&1)&&je!==(je=Pe[0].db.different_cameras+"")&&set_data(Ge,je),Pe[1]?Ze&&(Ze.d(1),Ze=null):Ze||(Ze=create_if_block_1(),Ze.c(),Ze.m(Ie,tt)),(!Fe||De&2&&Ue!==(Ue=!Pe[1]))&&(Ie.disabled=Ue)},i(Pe){Fe||(transition_in(c.$$.fragment,Pe),transition_in(k.$$.fragment,Pe),transition_in(A.$$.fragment,Pe),transition_in(j.$$.fragment,Pe),transition_in(de.$$.fragment,Pe),transition_in(Le.$$.fragment,Pe),Fe=!0)},o(Pe){transition_out(c.$$.fragment,Pe),transition_out(k.$$.fragment,Pe),transition_out(A.$$.fragment,Pe),transition_out(j.$$.fragment,Pe),transition_out(de.$$.fragment,Pe),transition_out(Le.$$.fragment,Pe),Fe=!1},d(Pe){Pe&&detach(t),destroy_component(c),destroy_component(k),destroy_component(A),destroy_component(j),destroy_component(de),destroy_component(Le),Pe&&detach(He),Pe&&detach(Ie),Ze&&Ze.d(),rt=!1,nt()}}}function create_default_slot(o){let t,e,i,r,s,c,a,u,f,p,d=o[0].cache.count+"",m,g,h,v,w,k,$,T,P,E,x=o[10]()+"",S,M,O,q,F,A;return c=new Icons({props:{icon:"album"}}),k=new Icons({props:{icon:"save"}}),{c(){t=element("table"),e=element("tbody"),i=element("tr"),r=element("th"),s=element("div"),create_component(c.$$.fragment),a=space(),u=element("span"),u.textContent="elements",f=space(),p=element("td"),m=text(d),g=space(),h=element("tr"),v=element("th"),w=element("div"),create_component(k.$$.fragment),$=space(),T=element("span"),T.textContent="size",P=space(),E=element("td"),S=text(x),M=space(),O=element("button"),O.textContent="clear cache",attr(u,"class","ml-2"),attr(s,"class","flex items-center justify-start"),attr(p,"class","text-right font-semibold font-mono"),attr(T,"class","ml-2"),attr(w,"class","flex items-center justify-start"),attr(E,"class","text-right font-semibold font-mono"),attr(t,"class","table table-zebra"),attr(O,"class","btn btn-error w-full mt-5")},m(Z,I){insert(Z,t,I),append(t,e),append(e,i),append(i,r),append(r,s),mount_component(c,s,null),append(s,a),append(s,u),append(i,f),append(i,p),append(p,m),append(e,g),append(e,h),append(h,v),append(v,w),mount_component(k,w,null),append(w,$),append(w,T),append(h,P),append(h,E),append(E,S),insert(Z,M,I),insert(Z,O,I),q=!0,F||(A=listen(O,"click",function(){is_function(o[2])&&o[2].apply(this,arguments)}),F=!0)},p(Z,I){o=Z,(!q||I&1)&&d!==(d=o[0].cache.count+"")&&set_data(m,d),(!q||I&1)&&x!==(x=o[10]()+"")&&set_data(S,x)},i(Z){q||(transition_in(c.$$.fragment,Z),transition_in(k.$$.fragment,Z),q=!0)},o(Z){transition_out(c.$$.fragment,Z),transition_out(k.$$.fragment,Z),q=!1},d(Z){Z&&detach(t),destroy_component(c),destroy_component(k),Z&&detach(M),Z&&detach(O),F=!1,A()}}}function create_fragment$1(o){let t,e,i,r,s,c,a,u,f,p;i=new SettingsCard({props:{name:"users",icon:"users",$$slots:{default:[create_default_slot_3]},$$scope:{ctx:o}}}),s=new SettingsCard({props:{name:"base directories",icon:"folder",$$slots:{default:[create_default_slot_2]},$$scope:{ctx:o}}});let d=o[0]&&create_if_block(o);function m(h){o[11](h)}let g={};return o[2]!==void 0&&(g.open=o[2]),u=new ConfirmCacheClear({props:g}),binding_callbacks.push(()=>bind(u,"open",m)),{c(){t=element("div"),e=element("div"),create_component(i.$$.fragment),r=space(),create_component(s.$$.fragment),c=space(),d&&d.c(),a=space(),create_component(u.$$.fragment),attr(e,"class","w-full max-w-lg"),attr(t,"class","p-5 text-lg w-full flex justify-center")},m(h,v){insert(h,t,v),append(t,e),mount_component(i,e,null),append(e,r),mount_component(s,e,null),append(e,c),d&&d.m(e,null),insert(h,a,v),mount_component(u,h,v),p=!0},p(h,[v]){const w={};v&65536&&(w.$$scope={dirty:v,ctx:h}),i.$set(w);const k={};v&65536&&(k.$$scope={dirty:v,ctx:h}),s.$set(k),h[0]?d?(d.p(h,v),v&1&&transition_in(d,1)):(d=create_if_block(h),d.c(),transition_in(d,1),d.m(e,null)):d&&(group_outros(),transition_out(d,1,1,()=>{d=null}),check_outros());const $={};!f&&v&4&&(f=!0,$.open=h[2],add_flush_callback(()=>f=!1)),u.$set($)},i(h){p||(transition_in(i.$$.fragment,h),transition_in(s.$$.fragment,h),transition_in(d),transition_in(u.$$.fragment,h),p=!0)},o(h){transition_out(i.$$.fragment,h),transition_out(s.$$.fragment,h),transition_out(d),transition_out(u.$$.fragment,h),p=!1},d(h){h&&detach(t),destroy_component(i),destroy_component(s),d&&d.d(),h&&detach(a),destroy_component(u,h)}}}function instance$1(o,t,e){let i,r,s,c;const a=stores.notify;component_subscribe(o,a,T=>e(8,i=T));const u=stores.options.changeView;component_subscribe(o,u,T=>e(14,c=T));const f=stores.options.share;component_subscribe(o,f,T=>e(13,s=T));const p=stores.options.download;component_subscribe(o,p,T=>e(12,r=T));let d;async function m(){let T=await request("admin/stats");if(!T.ok){console.log(T.status);return}e(0,d=await T.json())}let g=!0;async function h(){e(1,g=!1),request("basedirs/index/all").then(T=>{if(T.ok)e(1,g=!0);else return;m()})}m(),set_store_value(u,c=!1,c),set_store_value(f,s=!1,s),set_store_value(p,r=!1,r);let v;const w=()=>{let T=d.db.cumulated_size/1024/1024;return"~"+(T>1024?Math.round(T/1024*100)/100+" GB":Math.round(T*100)/100+" MB")},k=()=>{let T=d.cache.size/1024/1024;return"~"+(T>1024?Math.round(T/1024*100)/100+" GB":Math.round(T*100)/100+" MB")};function $(T){v=T,e(2,v)}return o.$$.update=()=>{o.$$.dirty&256&&((i==null?void 0:i.kind)=="basedir"||(i==null?void 0:i.kind)=="user"||(i==null?void 0:i.kind)=="cache")&&m()},[d,g,v,a,u,f,p,h,i,w,k,$]}class Admin extends SvelteComponent{constructor(t){super(),init(this,t,instance$1,create_fragment$1,safe_not_equal,{})}}function create_fragment(o){let t,e,i,r,s,c,a;return r=new Navbar({}),c=new Router({props:{routes:o[0]}}),{c(){t=element("main"),e=element("div"),i=element("div"),create_component(r.$$.fragment),s=space(),create_component(c.$$.fragment),attr(i,"class","max-w-[120rem] w-full relative"),attr(e,"class","w-full flex justify-center overflow-x-clip")},m(u,f){insert(u,t,f),append(t,e),append(e,i),mount_component(r,i,null),append(i,s),mount_component(c,i,null),a=!0},p:noop,i(u){a||(transition_in(r.$$.fragment,u),transition_in(c.$$.fragment,u),a=!0)},o(u){transition_out(r.$$.fragment,u),transition_out(c.$$.fragment,u),a=!1},d(u){u&&detach(t),destroy_component(r),destroy_component(c)}}}function instance(o){return[{"/":Init,"/folders/:path?":Folders,"/myshares/:share?/:path?":MyShares,"/shared/:share?/:path?":Shared,"/settings":Settings,"/admin":Admin,"/login":UserLogin,"/share/:url?/:path?":Share,"*":NotFound}]}class App extends SvelteComponent{constructor(t){super(),init(this,t,instance,create_fragment,safe_not_equal,{})}}new App({target:document.getElementById("app")});
